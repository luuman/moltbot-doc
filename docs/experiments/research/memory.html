<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-experiments/research/memory" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Workspace Memory v2 (offline): research notes | Moltbot Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luuman.github.io/moltbot-doc/docs/experiments/research/memory"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Workspace Memory v2 (offline): research notes | Moltbot Docs"><meta data-rh="true" name="description" content="Target: Clawd-style workspace (agents.defaults.workspace, default ~/clawd) where “memory” is stored as one Markdown file per day (memory/YYYY-MM-DD.md) plus a small set of stable files (e.g. memory.md, SOUL.md)."><meta data-rh="true" property="og:description" content="Target: Clawd-style workspace (agents.defaults.workspace, default ~/clawd) where “memory” is stored as one Markdown file per day (memory/YYYY-MM-DD.md) plus a small set of stable files (e.g. memory.md, SOUL.md)."><link data-rh="true" rel="icon" href="/moltbot-doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luuman.github.io/moltbot-doc/docs/experiments/research/memory"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/experiments/research/memory" hreflang="zh"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/experiments/research/memory" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/moltbot-doc/blog/rss.xml" title="Moltbot Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/moltbot-doc/blog/atom.xml" title="Moltbot Docs Atom Feed"><link rel="stylesheet" href="/moltbot-doc/assets/css/styles.484b4c98.css">
<script src="/moltbot-doc/assets/js/runtime~main.6cf495cf.js" defer="defer"></script>
<script src="/moltbot-doc/assets/js/main.f9205183.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbar_MONK" role="navigation" aria-label="Main"><div class="navbarInner_ASTH"><div class="navbarLeft_pUmY"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="brand_SXL9" href="/moltbot-doc/"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="6" fill="var(--ifm-color-primary)"></rect><path d="M7 8.5h10M7 12h7M7 15.5h10" stroke="white" stroke-width="1.8" stroke-linecap="round"></path></svg><span class="brandTitle_XbyU">Moltbot</span></a><div class="dropdown_GrgZ"><button class="dropdownToggle_Nf_z">全部站点<svg class="dropdownArrow_Eka8" viewBox="0 0 12 12" fill="none"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><ul class="dropdownMenu_zsxH"><li><a href="https://luuman.github.io/docs-workspace/docs" class="dropdownMenuItem_VBaP">Workspace</a></li><li><a href="https://luuman.github.io/claude-doc/docs" class="dropdownMenuItem_VBaP">Claude</a></li><li><a href="https://luuman.github.io/electron-doc/docs" class="dropdownMenuItem_VBaP">Electron</a></li><li><a href="https://luuman.github.io/tauri-doc/docs" class="dropdownMenuItem_VBaP">Tauri</a></li><li><a href="https://luuman.github.io/matrx-doc/docs" class="dropdownMenuItem_VBaP">Matrx</a></li><li><a href="https://luuman.github.io/brainboard-doc/docs" class="dropdownMenuItem_VBaP">Brainboard</a></li><li><a href="https://luuman.github.io/synology-doc/docs" class="dropdownMenuItem_VBaP">Synology</a></li><li><a href="https://luuman.github.io/codex-doc/docs" class="dropdownMenuItem_VBaP">Codex</a></li><li><a href="https://luuman.github.io/ai-doc/docs" class="dropdownMenuItem_VBaP">AI</a></li></ul></div></div><div class="navbarCenter_Zdr3"><div class="root_OF3s"><span class="icon_UcOK" aria-hidden="true"><svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></span><div class="slot__FGx"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div class="navbarRight_q16u"><a class="navLink_RnnM" href="/moltbot-doc/docs">Docs</a><a class="navLink_RnnM" href="/moltbot-doc/blog">Blog</a><button class="themeToggle_zD_x" aria-label="Switch to light theme" title="Light"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Workspace Memory v2 (offline): research notes</h1></header>
<p>Target: Clawd-style workspace (<code>agents.defaults.workspace</code>, default <code>~/clawd</code>) where “memory” is stored as one Markdown file per day (<code>memory/YYYY-MM-DD.md</code>) plus a small set of stable files (e.g. <code>memory.md</code>, <code>SOUL.md</code>).</p>
<p>This doc proposes an <strong>offline-first</strong> memory architecture that keeps Markdown as the canonical, reviewable source of truth, but adds <strong>structured recall</strong> (search, entity summaries, confidence updates) via a derived index.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-change">Why change?<a href="#why-change" class="hash-link" aria-label="Why change?的直接链接" title="Why change?的直接链接" translate="no">​</a></h2>
<p>The current setup (one file per day) is excellent for:</p>
<ul>
<li class="">“append-only” journaling</li>
<li class="">human editing</li>
<li class="">git-backed durability + auditability</li>
<li class="">low-friction capture (“just write it down”)</li>
</ul>
<p>It’s weak for:</p>
<ul>
<li class="">high-recall retrieval (“what did we decide about X?”, “last time we tried Y?”)</li>
<li class="">entity-centric answers (“tell me about Alice / The Castle / warelay”) without rereading many files</li>
<li class="">opinion/preference stability (and evidence when it changes)</li>
<li class="">time constraints (“what was true during Nov 2025?”) and conflict resolution</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="design-goals">Design goals<a href="#design-goals" class="hash-link" aria-label="Design goals的直接链接" title="Design goals的直接链接" translate="no">​</a></h2>
<ul>
<li class=""><strong>Offline</strong>: works without network; can run on laptop/Castle; no cloud dependency.</li>
<li class=""><strong>Explainable</strong>: retrieved items should be attributable (file + location) and separable from inference.</li>
<li class=""><strong>Low ceremony</strong>: daily logging stays Markdown, no heavy schema work.</li>
<li class=""><strong>Incremental</strong>: v1 is useful with FTS only; semantic/vector and graphs are optional upgrades.</li>
<li class=""><strong>Agent-friendly</strong>: makes “recall within token budgets” easy (return small bundles of facts).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="north-star-model-hindsight--letta">North star model (Hindsight × Letta)<a href="#north-star-model-hindsight--letta" class="hash-link" aria-label="North star model (Hindsight × Letta)的直接链接" title="North star model (Hindsight × Letta)的直接链接" translate="no">​</a></h2>
<p>Two pieces to blend:</p>
<ol>
<li class=""><strong>Letta/MemGPT-style control loop</strong></li>
</ol>
<ul>
<li class="">keep a small “core” always in context (persona + key user facts)</li>
<li class="">everything else is out-of-context and retrieved via tools</li>
<li class="">memory writes are explicit tool calls (append/replace/insert), persisted, then re-injected next turn</li>
</ul>
<ol start="2">
<li class=""><strong>Hindsight-style memory substrate</strong></li>
</ol>
<ul>
<li class="">separate what’s observed vs what’s believed vs what’s summarized</li>
<li class="">support retain/recall/reflect</li>
<li class="">confidence-bearing opinions that can evolve with evidence</li>
<li class="">entity-aware retrieval + temporal queries (even without full knowledge graphs)</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="proposed-architecture-markdown-source-of-truth--derived-index">Proposed architecture (Markdown source-of-truth + derived index)<a href="#proposed-architecture-markdown-source-of-truth--derived-index" class="hash-link" aria-label="Proposed architecture (Markdown source-of-truth + derived index)的直接链接" title="Proposed architecture (Markdown source-of-truth + derived index)的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="canonical-store-git-friendly">Canonical store (git-friendly)<a href="#canonical-store-git-friendly" class="hash-link" aria-label="Canonical store (git-friendly)的直接链接" title="Canonical store (git-friendly)的直接链接" translate="no">​</a></h3>
<p>Keep <code>~/clawd</code> as canonical human-readable memory.</p>
<p>Suggested workspace layout:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">~/clawd/</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  memory.md                    # small: durable facts + preferences (core-ish)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  memory/</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    YYYY-MM-DD.md              # daily log (append; narrative)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  bank/                        # “typed” memory pages (stable, reviewable)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    world.md                   # objective facts about the world</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    experience.md              # what the agent did (first-person)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    opinions.md                # subjective prefs/judgments + confidence + evidence pointers</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    entities/</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      Peter.md</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      The-Castle.md</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      warelay.md</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      ...</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class=""><strong>Daily log stays daily log</strong>. No need to turn it into JSON.</li>
<li class="">The <code>bank/</code> files are <strong>curated</strong>, produced by reflection jobs, and can still be edited by hand.</li>
<li class=""><code>memory.md</code> remains “small + core-ish”: the things you want Clawd to see every session.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="derived-store-machine-recall">Derived store (machine recall)<a href="#derived-store-machine-recall" class="hash-link" aria-label="Derived store (machine recall)的直接链接" title="Derived store (machine recall)的直接链接" translate="no">​</a></h3>
<p>Add a derived index under the workspace (not necessarily git tracked):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">~/clawd/.memory/index.sqlite</span><br></span></code></pre></div></div>
<p>Back it with:</p>
<ul>
<li class="">SQLite schema for facts + entity links + opinion metadata</li>
<li class="">SQLite <strong>FTS5</strong> for lexical recall (fast, tiny, offline)</li>
<li class="">optional embeddings table for semantic recall (still offline)</li>
</ul>
<p>The index is always <strong>rebuildable from Markdown</strong>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="retain--recall--reflect-operational-loop">Retain / Recall / Reflect (operational loop)<a href="#retain--recall--reflect-operational-loop" class="hash-link" aria-label="Retain / Recall / Reflect (operational loop)的直接链接" title="Retain / Recall / Reflect (operational loop)的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="retain-normalize-daily-logs-into-facts">Retain: normalize daily logs into “facts”<a href="#retain-normalize-daily-logs-into-facts" class="hash-link" aria-label="Retain: normalize daily logs into “facts”的直接链接" title="Retain: normalize daily logs into “facts”的直接链接" translate="no">​</a></h3>
<p>Hindsight’s key insight that matters here: store <strong>narrative, self-contained facts</strong>, not tiny snippets.</p>
<p>Practical rule for <code>memory/YYYY-MM-DD.md</code>:</p>
<ul>
<li class="">at end of day (or during), add a <code>## Retain</code> section with 2–5 bullets that are:
<ul>
<li class="">narrative (cross-turn context preserved)</li>
<li class="">self-contained (standalone makes sense later)</li>
<li class="">tagged with type + entity mentions</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">## Retain</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- W @Peter: Currently in Marrakech (Nov 27–Dec 1, 2025) for Andy’s birthday.</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- B @warelay: I fixed the Baileys WS crash by wrapping connection.update handlers in try/catch (see memory/2025-11-27.md).</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">- O(c=0.95) @Peter: Prefers concise replies (&amp;lt;1500 chars) on WhatsApp; long content goes into files.</span><br></span></code></pre></div></div>
<p>Minimal parsing:</p>
<ul>
<li class="">Type prefix: <code>W</code> (world), <code>B</code> (experience/biographical), <code>O</code> (opinion), <code>S</code> (observation/summary; usually generated)</li>
<li class="">Entities: <code>@Peter</code>, <code>@warelay</code>, etc (slugs map to <code>bank/entities/*.md</code>)</li>
<li class="">Opinion confidence: <code>O(c=0.0..1.0)</code> optional</li>
</ul>
<p>If you don’t want authors to think about it: the reflect job can infer these bullets from the rest of the log, but having an explicit <code>## Retain</code> section is the easiest “quality lever”.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="recall-queries-over-the-derived-index">Recall: queries over the derived index<a href="#recall-queries-over-the-derived-index" class="hash-link" aria-label="Recall: queries over the derived index的直接链接" title="Recall: queries over the derived index的直接链接" translate="no">​</a></h3>
<p>Recall should support:</p>
<ul>
<li class=""><strong>lexical</strong>: “find exact terms / names / commands” (FTS5)</li>
<li class=""><strong>entity</strong>: “tell me about X” (entity pages + entity-linked facts)</li>
<li class=""><strong>temporal</strong>: “what happened around Nov 27” / “since last week”</li>
<li class=""><strong>opinion</strong>: “what does Peter prefer?” (with confidence + evidence)</li>
</ul>
<p>Return format should be agent-friendly and cite sources:</p>
<ul>
<li class=""><code>kind</code> (<code>world|experience|opinion|observation</code>)</li>
<li class=""><code>timestamp</code> (source day, or extracted time range if present)</li>
<li class=""><code>entities</code> (<code>[&quot;Peter&quot;,&quot;warelay&quot;]</code>)</li>
<li class=""><code>content</code> (the narrative fact)</li>
<li class=""><code>source</code> (<code>memory/2025-11-27.md#L12</code> etc)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="reflect-produce-stable-pages--update-beliefs">Reflect: produce stable pages + update beliefs<a href="#reflect-produce-stable-pages--update-beliefs" class="hash-link" aria-label="Reflect: produce stable pages + update beliefs的直接链接" title="Reflect: produce stable pages + update beliefs的直接链接" translate="no">​</a></h3>
<p>Reflection is a scheduled job (daily or heartbeat <code>ultrathink</code>) that:</p>
<ul>
<li class="">updates <code>bank/entities/*.md</code> from recent facts (entity summaries)</li>
<li class="">updates <code>bank/opinions.md</code> confidence based on reinforcement/contradiction</li>
<li class="">optionally proposes edits to <code>memory.md</code> (“core-ish” durable facts)</li>
</ul>
<p>Opinion evolution (simple, explainable):</p>
<ul>
<li class="">each opinion has:
<ul>
<li class="">statement</li>
<li class="">confidence <code>c ∈ [0,1]</code></li>
<li class="">last_updated</li>
<li class="">evidence links (supporting + contradicting fact IDs)</li>
</ul>
</li>
<li class="">when new facts arrive:
<ul>
<li class="">find candidate opinions by entity overlap + similarity (FTS first, embeddings later)</li>
<li class="">update confidence by small deltas; big jumps require strong contradiction + repeated evidence</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cli-integration-standalone-vs-deep-integration">CLI integration: standalone vs deep integration<a href="#cli-integration-standalone-vs-deep-integration" class="hash-link" aria-label="CLI integration: standalone vs deep integration的直接链接" title="CLI integration: standalone vs deep integration的直接链接" translate="no">​</a></h2>
<p>Recommendation: <strong>deep integration in Moltbot</strong>, but keep a separable core library.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-integrate-into-moltbot">Why integrate into Moltbot?<a href="#why-integrate-into-moltbot" class="hash-link" aria-label="Why integrate into Moltbot?的直接链接" title="Why integrate into Moltbot?的直接链接" translate="no">​</a></h3>
<ul>
<li class="">Moltbot already knows:
<ul>
<li class="">the workspace path (<code>agents.defaults.workspace</code>)</li>
<li class="">the session model + heartbeats</li>
<li class="">logging + troubleshooting patterns</li>
</ul>
</li>
<li class="">You want the agent itself to call the tools:
<ul>
<li class=""><code>moltbot memory recall &quot;…&quot; --k 25 --since 30d</code></li>
<li class=""><code>moltbot memory reflect --since 7d</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-still-split-a-library">Why still split a library?<a href="#why-still-split-a-library" class="hash-link" aria-label="Why still split a library?的直接链接" title="Why still split a library?的直接链接" translate="no">​</a></h3>
<ul>
<li class="">keep memory logic testable without gateway/runtime</li>
<li class="">reuse from other contexts (local scripts, future desktop app, etc.)</li>
</ul>
<p>Shape:
The memory tooling is intended to be a small CLI + library layer, but this is exploratory only.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="s-collide--suco-when-to-use-it-research">“S-Collide” / SuCo: when to use it (research)<a href="#s-collide--suco-when-to-use-it-research" class="hash-link" aria-label="“S-Collide” / SuCo: when to use it (research)的直接链接" title="“S-Collide” / SuCo: when to use it (research)的直接链接" translate="no">​</a></h2>
<p>If “S-Collide” refers to <strong>SuCo (Subspace Collision)</strong>: it’s an ANN retrieval approach that targets strong recall/latency tradeoffs by using learned/structured collisions in subspaces (paper: arXiv 2411.14754, 2024).</p>
<p>Pragmatic take for <code>~/clawd</code>:</p>
<ul>
<li class=""><strong>don’t start</strong> with SuCo.</li>
<li class="">start with SQLite FTS + (optional) simple embeddings; you’ll get most UX wins immediately.</li>
<li class="">consider SuCo/HNSW/ScaNN-class solutions only once:
<ul>
<li class="">corpus is big (tens/hundreds of thousands of chunks)</li>
<li class="">brute-force embedding search becomes too slow</li>
<li class="">recall quality is meaningfully bottlenecked by lexical search</li>
</ul>
</li>
</ul>
<p>Offline-friendly alternatives (in increasing complexity):</p>
<ul>
<li class="">SQLite FTS5 + metadata filters (zero ML)</li>
<li class="">Embeddings + brute force (works surprisingly far if chunk count is low)</li>
<li class="">HNSW index (common, robust; needs a library binding)</li>
<li class="">SuCo (research-grade; attractive if there’s a solid implementation you can embed)</li>
</ul>
<p>Open question:</p>
<ul>
<li class="">what’s the <strong>best</strong> offline embedding model for “personal assistant memory” on your machines (laptop + desktop)?
<ul>
<li class="">if you already have Ollama: embed with a local model; otherwise ship a small embedding model in the toolchain.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="smallest-useful-pilot">Smallest useful pilot<a href="#smallest-useful-pilot" class="hash-link" aria-label="Smallest useful pilot的直接链接" title="Smallest useful pilot的直接链接" translate="no">​</a></h2>
<p>If you want a minimal, still-useful version:</p>
<ul>
<li class="">Add <code>bank/</code> entity pages and a <code>## Retain</code> section in daily logs.</li>
<li class="">Use SQLite FTS for recall with citations (path + line numbers).</li>
<li class="">Add embeddings only if recall quality or scale demands it.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="references">References<a href="#references" class="hash-link" aria-label="References的直接链接" title="References的直接链接" translate="no">​</a></h2>
<ul>
<li class="">Letta / MemGPT concepts: “core memory blocks” + “archival memory” + tool-driven self-editing memory.</li>
<li class="">Hindsight Technical Report: “retain / recall / reflect”, four-network memory, narrative fact extraction, opinion confidence evolution.</li>
<li class="">SuCo: arXiv 2411.14754 (2024): “Subspace Collision” approximate nearest neighbor retrieval.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"></nav></div></div><div class="col col--3"><div class="tocWrapper_xKoj"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-change" class="table-of-contents__link toc-highlight">Why change?</a></li><li><a href="#design-goals" class="table-of-contents__link toc-highlight">Design goals</a></li><li><a href="#north-star-model-hindsight--letta" class="table-of-contents__link toc-highlight">North star model (Hindsight × Letta)</a></li><li><a href="#proposed-architecture-markdown-source-of-truth--derived-index" class="table-of-contents__link toc-highlight">Proposed architecture (Markdown source-of-truth + derived index)</a><ul><li><a href="#canonical-store-git-friendly" class="table-of-contents__link toc-highlight">Canonical store (git-friendly)</a></li><li><a href="#derived-store-machine-recall" class="table-of-contents__link toc-highlight">Derived store (machine recall)</a></li></ul></li><li><a href="#retain--recall--reflect-operational-loop" class="table-of-contents__link toc-highlight">Retain / Recall / Reflect (operational loop)</a><ul><li><a href="#retain-normalize-daily-logs-into-facts" class="table-of-contents__link toc-highlight">Retain: normalize daily logs into “facts”</a></li><li><a href="#recall-queries-over-the-derived-index" class="table-of-contents__link toc-highlight">Recall: queries over the derived index</a></li><li><a href="#reflect-produce-stable-pages--update-beliefs" class="table-of-contents__link toc-highlight">Reflect: produce stable pages + update beliefs</a></li></ul></li><li><a href="#cli-integration-standalone-vs-deep-integration" class="table-of-contents__link toc-highlight">CLI integration: standalone vs deep integration</a><ul><li><a href="#why-integrate-into-moltbot" class="table-of-contents__link toc-highlight">Why integrate into Moltbot?</a></li><li><a href="#why-still-split-a-library" class="table-of-contents__link toc-highlight">Why still split a library?</a></li></ul></li><li><a href="#s-collide--suco-when-to-use-it-research" class="table-of-contents__link toc-highlight">“S-Collide” / SuCo: when to use it (research)</a></li><li><a href="#smallest-useful-pilot" class="table-of-contents__link toc-highlight">Smallest useful pilot</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div><div class="tocFooter_Fu2z"><div class="themeGroup_RzWV" role="group" aria-label="Theme"><button class="themeBtn_tGr6" aria-label="Light theme" title="Light"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button><button class="themeBtn_tGr6 themeBtnActive_A6tm" aria-label="Dark theme" title="Dark"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M11.38 2.019a7.5 7.5 0 1 0 10.6 10.6C21.83 17.963 17.315 22 12.002 22 6.477 22 2 17.523 2 12c0-5.314 4.038-9.827 9.38-10.28z"></path></svg></button></div></div></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Moltbot Docs.</div></div></div></footer></div>
</body>
</html>