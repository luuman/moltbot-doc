<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-concepts/groups" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Groups | Moltbot Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luuman.github.io/moltbot-doc/docs/concepts/groups"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Groups | Moltbot Docs"><meta data-rh="true" name="description" content="Moltbot treats group chats consistently across surfaces: WhatsApp, Telegram, Discord, Slack, Signal, iMessage, Microsoft Teams."><meta data-rh="true" property="og:description" content="Moltbot treats group chats consistently across surfaces: WhatsApp, Telegram, Discord, Slack, Signal, iMessage, Microsoft Teams."><link data-rh="true" rel="icon" href="/moltbot-doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luuman.github.io/moltbot-doc/docs/concepts/groups"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/concepts/groups" hreflang="zh"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/concepts/groups" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/moltbot-doc/blog/rss.xml" title="Moltbot Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/moltbot-doc/blog/atom.xml" title="Moltbot Docs Atom Feed"><link rel="stylesheet" href="/moltbot-doc/assets/css/styles.484b4c98.css">
<script src="/moltbot-doc/assets/js/runtime~main.6cf495cf.js" defer="defer"></script>
<script src="/moltbot-doc/assets/js/main.f9205183.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbar_MONK" role="navigation" aria-label="Main"><div class="navbarInner_ASTH"><div class="navbarLeft_pUmY"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="brand_SXL9" href="/moltbot-doc/"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="6" fill="var(--ifm-color-primary)"></rect><path d="M7 8.5h10M7 12h7M7 15.5h10" stroke="white" stroke-width="1.8" stroke-linecap="round"></path></svg><span class="brandTitle_XbyU">Moltbot</span></a><div class="dropdown_GrgZ"><button class="dropdownToggle_Nf_z">全部站点<svg class="dropdownArrow_Eka8" viewBox="0 0 12 12" fill="none"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><ul class="dropdownMenu_zsxH"><li><a href="https://luuman.github.io/docs-workspace/docs" class="dropdownMenuItem_VBaP">Workspace</a></li><li><a href="https://luuman.github.io/claude-doc/docs" class="dropdownMenuItem_VBaP">Claude</a></li><li><a href="https://luuman.github.io/electron-doc/docs" class="dropdownMenuItem_VBaP">Electron</a></li><li><a href="https://luuman.github.io/tauri-doc/docs" class="dropdownMenuItem_VBaP">Tauri</a></li><li><a href="https://luuman.github.io/matrx-doc/docs" class="dropdownMenuItem_VBaP">Matrx</a></li><li><a href="https://luuman.github.io/brainboard-doc/docs" class="dropdownMenuItem_VBaP">Brainboard</a></li><li><a href="https://luuman.github.io/synology-doc/docs" class="dropdownMenuItem_VBaP">Synology</a></li><li><a href="https://luuman.github.io/codex-doc/docs" class="dropdownMenuItem_VBaP">Codex</a></li><li><a href="https://luuman.github.io/ai-doc/docs" class="dropdownMenuItem_VBaP">AI</a></li></ul></div></div><div class="navbarCenter_Zdr3"><div class="root_OF3s"><span class="icon_UcOK" aria-hidden="true"><svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></span><div class="slot__FGx"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div class="navbarRight_q16u"><a class="navLink_RnnM" href="/moltbot-doc/docs">Docs</a><a class="navLink_RnnM" href="/moltbot-doc/blog">Blog</a><button class="themeToggle_zD_x" aria-label="Switch to light theme" title="Light"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Groups</h1></header>
<p>Moltbot treats group chats consistently across surfaces: WhatsApp, Telegram, Discord, Slack, Signal, iMessage, Microsoft Teams.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="beginner-intro-2-minutes">Beginner intro (2 minutes)<a href="#beginner-intro-2-minutes" class="hash-link" aria-label="Beginner intro (2 minutes)的直接链接" title="Beginner intro (2 minutes)的直接链接" translate="no">​</a></h2>
<p>Moltbot “lives” on your own messaging accounts. There is no separate WhatsApp bot user.
If <strong>you</strong> are in a group, Moltbot can see that group and respond there.</p>
<p>Default behavior:</p>
<ul>
<li class="">Groups are restricted (<code>groupPolicy: &quot;allowlist&quot;</code>).</li>
<li class="">Replies require a mention unless you explicitly disable mention gating.</li>
</ul>
<p>Translation: allowlisted senders can trigger Moltbot by mentioning it.</p>
<blockquote>
<p>TL;DR</p>
<ul>
<li class=""><strong>DM access</strong> is controlled by <code>*.allowFrom</code>.</li>
<li class=""><strong>Group access</strong> is controlled by <code>*.groupPolicy</code> + allowlists (<code>*.groups</code>, <code>*.groupAllowFrom</code>).</li>
<li class=""><strong>Reply triggering</strong> is controlled by mention gating (<code>requireMention</code>, <code>/activation</code>).</li>
</ul>
</blockquote>
<p>Quick flow (what happens to a group message):</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">groupPolicy? disabled -&gt; drop</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">groupPolicy? allowlist -&gt; group allowed? no -&gt; drop</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">requireMention? yes -&gt; mentioned? no -&gt; store for context only</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">otherwise -&gt; reply</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Group message flow" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5NjAiIGhlaWdodD0iMjYwIiB2aWV3Qm94PSIwIDAgOTYwIDI2MCIgcm9sZT0iaW1nIiBhcmlhLWxhYmVsPSJHcm91cCBtZXNzYWdlIGZsb3ciPgogIDxkZWZzPgogICAgPHN0eWxlPgogICAgICAuYm94IHsgZmlsbDogI2Y2ZjVmMzsgc3Ryb2tlOiAjMmIyYjJiOyBzdHJva2Utd2lkdGg6IDI7IH0KICAgICAgLmRyb3AgeyBmaWxsOiAjZmZmMWYxOyBzdHJva2U6ICNhMzM7IHN0cm9rZS13aWR0aDogMjsgfQogICAgICAubm90ZSB7IGZpbGw6ICNmZmZhZjA7IHN0cm9rZTogIzlhN2IwMDsgc3Ryb2tlLXdpZHRoOiAyOyB9CiAgICAgIC50ZXh0IHsgZm9udDogMTRweCAiU0YgUHJvIFRleHQiLCAtYXBwbGUtc3lzdGVtLCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmOyBmaWxsOiAjMWExYTFhOyB9CiAgICAgIC5sYWJlbCB7IGZvbnQ6IDEycHggIlNGIFBybyBUZXh0IiwgLWFwcGxlLXN5c3RlbSwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsgZmlsbDogIzMzMzsgfQogICAgICAuYXJyb3cgeyBzdHJva2U6ICMyYjJiMmI7IHN0cm9rZS13aWR0aDogMjsgZmlsbDogbm9uZTsgbWFya2VyLWVuZDogdXJsKCNhcnJvdyk7IH0KICAgIDwvc3R5bGU+CiAgICA8bWFya2VyIGlkPSJhcnJvdyIgbWFya2VyV2lkdGg9IjEwIiBtYXJrZXJIZWlnaHQ9IjEwIiByZWZYPSI4IiByZWZZPSIzIiBvcmllbnQ9ImF1dG8iPgogICAgICA8cGF0aCBkPSJNMCwwIEw4LDMgTDAsNiBaIiBmaWxsPSIjMmIyYjJiIiAvPgogICAgPC9tYXJrZXI+CiAgPC9kZWZzPgoKICA8cmVjdCBjbGFzcz0iYm94IiB4PSIyMCIgeT0iNDAiIHdpZHRoPSIxNDAiIGhlaWdodD0iNjAiIHJ4PSI4IiAvPgogIDx0ZXh0IGNsYXNzPSJ0ZXh0IiB4PSI5MCIgeT0iNzUiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkdyb3VwIG1lc3NhZ2U8L3RleHQ+CgogIDxyZWN0IGNsYXNzPSJib3giIHg9IjIwMCIgeT0iNDAiIHdpZHRoPSIxNjAiIGhlaWdodD0iNjAiIHJ4PSI4IiAvPgogIDx0ZXh0IGNsYXNzPSJ0ZXh0IiB4PSIyODAiIHk9IjY4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5Hcm91cCBwb2xpY3k8L3RleHQ+CiAgPHRleHQgY2xhc3M9ImxhYmVsIiB4PSIyODAiIHk9Ijg2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5vcGVuIC8gZGlzYWJsZWQgLyBhbGxvd2xpc3Q8L3RleHQ+CgogIDxyZWN0IGNsYXNzPSJib3giIHg9IjQwMCIgeT0iNDAiIHdpZHRoPSIxNTAiIGhlaWdodD0iNjAiIHJ4PSI4IiAvPgogIDx0ZXh0IGNsYXNzPSJ0ZXh0IiB4PSI0NzUiIHk9Ijc1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5BbGxvd2xpc3Q8L3RleHQ+CgogIDxyZWN0IGNsYXNzPSJib3giIHg9IjU4MCIgeT0iNDAiIHdpZHRoPSIxNzAiIGhlaWdodD0iNjAiIHJ4PSI4IiAvPgogIDx0ZXh0IGNsYXNzPSJ0ZXh0IiB4PSI2NjUiIHk9IjY4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5NZW50aW9uIGdhdGluZzwvdGV4dD4KICA8dGV4dCBjbGFzcz0ibGFiZWwiIHg9IjY2NSIgeT0iODYiIHRleHQtYW5jaG9yPSJtaWRkbGUiPnJlcXVpcmVNZW50aW9uPC90ZXh0PgoKICA8cmVjdCBjbGFzcz0iYm94IiB4PSI3ODAiIHk9IjQwIiB3aWR0aD0iMTQwIiBoZWlnaHQ9IjYwIiByeD0iOCIgLz4KICA8dGV4dCBjbGFzcz0idGV4dCIgeD0iODUwIiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+UmVwbHk8L3RleHQ+CgogIDxsaW5lIGNsYXNzPSJhcnJvdyIgeDE9IjE2MCIgeTE9IjcwIiB4Mj0iMjAwIiB5Mj0iNzAiIC8+CiAgPGxpbmUgY2xhc3M9ImFycm93IiB4MT0iMzYwIiB5MT0iNzAiIHgyPSI0MDAiIHkyPSI3MCIgLz4KICA8bGluZSBjbGFzcz0iYXJyb3ciIHgxPSI1NTAiIHkxPSI3MCIgeDI9IjU4MCIgeTI9IjcwIiAvPgogIDxsaW5lIGNsYXNzPSJhcnJvdyIgeDE9Ijc1MCIgeTE9IjcwIiB4Mj0iNzgwIiB5Mj0iNzAiIC8+CgogIDxyZWN0IGNsYXNzPSJkcm9wIiB4PSIyMjAiIHk9IjE1MCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI1MCIgcng9IjgiIC8+CiAgPHRleHQgY2xhc3M9InRleHQiIHg9IjI4MCIgeT0iMTgwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5Ecm9wPC90ZXh0PgogIDxsaW5lIGNsYXNzPSJhcnJvdyIgeDE9IjI4MCIgeTE9IjEwMCIgeDI9IjI4MCIgeTI9IjE1MCIgLz4KICA8dGV4dCBjbGFzcz0ibGFiZWwiIHg9IjI1MCIgeT0iMTMwIiB0ZXh0LWFuY2hvcj0iZW5kIj5kaXNhYmxlZDwvdGV4dD4KCiAgPHJlY3QgY2xhc3M9ImRyb3AiIHg9IjQxMCIgeT0iMTUwIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjUwIiByeD0iOCIgLz4KICA8dGV4dCBjbGFzcz0idGV4dCIgeD0iNDcwIiB5PSIxODAiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkRyb3A8L3RleHQ+CiAgPGxpbmUgY2xhc3M9ImFycm93IiB4MT0iNDc1IiB5MT0iMTAwIiB4Mj0iNDcwIiB5Mj0iMTUwIiAvPgogIDx0ZXh0IGNsYXNzPSJsYWJlbCIgeD0iNDQ1IiB5PSIxMzAiIHRleHQtYW5jaG9yPSJlbmQiPm5vdCBhbGxvd2VkPC90ZXh0PgoKICA8cmVjdCBjbGFzcz0ibm90ZSIgeD0iNjAwIiB5PSIxNTAiIHdpZHRoPSIyMDAiIGhlaWdodD0iNTAiIHJ4PSI4IiAvPgogIDx0ZXh0IGNsYXNzPSJ0ZXh0IiB4PSI3MDAiIHk9IjE3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+U3RvcmUgZm9yIGNvbnRleHQ8L3RleHQ+CiAgPHRleHQgY2xhc3M9ImxhYmVsIiB4PSI3MDAiIHk9IjE5MiIgdGV4dC1hbmNob3I9Im1pZGRsZSI+KG5vIG1lbnRpb24pPC90ZXh0PgogIDxsaW5lIGNsYXNzPSJhcnJvdyIgeDE9IjY2NSIgeTE9IjEwMCIgeDI9IjcwMCIgeTI9IjE1MCIgLz4KPC9zdmc+Cg==" width="960" height="260" class="img_ev3q"></p>
<p>If you want...</p>

























<table><thead><tr><th>Goal</th><th>What to set</th></tr></thead><tbody><tr><td>Allow all groups but only reply on @mentions</td><td><code>groups: { &quot;*&quot;: { requireMention: true } }</code></td></tr><tr><td>Disable all group replies</td><td><code>groupPolicy: &quot;disabled&quot;</code></td></tr><tr><td>Only specific groups</td><td><code>groups: { &quot;&lt;group-id&gt;&quot;: { ... } }</code> (no <code>&quot;*&quot;</code> key)</td></tr><tr><td>Only you can trigger in groups</td><td><code>groupPolicy: &quot;allowlist&quot;</code>, <code>groupAllowFrom: [&quot;+1555...&quot;]</code></td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="session-keys">Session keys<a href="#session-keys" class="hash-link" aria-label="Session keys的直接链接" title="Session keys的直接链接" translate="no">​</a></h2>
<ul>
<li class="">Group sessions use <code>agent:&lt;agentId&gt;:&lt;channel&gt;:group:&lt;id&gt;</code> session keys (rooms/channels use <code>agent:&lt;agentId&gt;:&lt;channel&gt;:channel:&lt;id&gt;</code>).</li>
<li class="">Telegram forum topics add <code>:topic:&lt;threadId&gt;</code> to the group id so each topic has its own session.</li>
<li class="">Direct chats use the main session (or per-sender if configured).</li>
<li class="">Heartbeats are skipped for group sessions.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="pattern-personal-dms--public-groups-single-agent">Pattern: personal DMs + public groups (single agent)<a href="#pattern-personal-dms--public-groups-single-agent" class="hash-link" aria-label="Pattern: personal DMs + public groups (single agent)的直接链接" title="Pattern: personal DMs + public groups (single agent)的直接链接" translate="no">​</a></h2>
<p>Yes — this works well if your “personal” traffic is <strong>DMs</strong> and your “public” traffic is <strong>groups</strong>.</p>
<p>Why: in single-agent mode, DMs typically land in the <strong>main</strong> session key (<code>agent:main:main</code>), while groups always use <strong>non-main</strong> session keys (<code>agent:main:&lt;channel&gt;:group:&lt;id&gt;</code>). If you enable sandboxing with <code>mode: &quot;non-main&quot;</code>, those group sessions run in Docker while your main DM session stays on-host.</p>
<p>This gives you one agent “brain” (shared workspace + memory), but two execution postures:</p>
<ul>
<li class=""><strong>DMs</strong>: full tools (host)</li>
<li class=""><strong>Groups</strong>: sandbox + restricted tools (Docker)</li>
</ul>
<blockquote>
<p>If you need truly separate workspaces/personas (“personal” and “public” must never mix), use a second agent + bindings. See <a class="" href="/moltbot-doc/concepts/multi-agent">Multi-Agent Routing</a>.</p>
</blockquote>
<p>Example (DMs on host, groups sandboxed + messaging-only tools):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      sandbox: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        mode: &quot;non-main&quot;, // groups/channels are non-main -&gt; sandboxed</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        scope: &quot;session&quot;, // strongest isolation (one container per group/channel)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        workspaceAccess: &quot;none&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    sandbox: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        // If allow is non-empty, everything else is blocked (deny still wins).</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        allow: [&quot;group:messaging&quot;, &quot;group:sessions&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        deny: [&quot;group:runtime&quot;, &quot;group:fs&quot;, &quot;group:ui&quot;, &quot;nodes&quot;, &quot;cron&quot;, &quot;gateway&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Want “groups can only see folder X” instead of “no host access”? Keep <code>workspaceAccess: &quot;none&quot;</code> and mount only allowlisted paths into the sandbox:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      sandbox: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        mode: &quot;non-main&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        scope: &quot;session&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        workspaceAccess: &quot;none&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        docker: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          binds: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            // hostPath:containerPath:mode</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            &quot;~/FriendsShared:/data:ro&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Related:</p>
<ul>
<li class="">Configuration keys and defaults: <a class="" href="/moltbot-doc/gateway/configuration#agentsdefaultssandbox">Gateway configuration</a></li>
<li class="">Debugging why a tool is blocked: <a class="" href="/moltbot-doc/gateway/sandbox-vs-tool-policy-vs-elevated">Sandbox vs Tool Policy vs Elevated</a></li>
<li class="">Bind mounts details: <a class="" href="/moltbot-doc/gateway/sandboxing#custom-bind-mounts">Sandboxing</a></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="display-labels">Display labels<a href="#display-labels" class="hash-link" aria-label="Display labels的直接链接" title="Display labels的直接链接" translate="no">​</a></h2>
<ul>
<li class="">UI labels use <code>displayName</code> when available, formatted as <code>&lt;channel&gt;:&lt;token&gt;</code>.</li>
<li class=""><code>#room</code> is reserved for rooms/channels; group chats use <code>g-&lt;slug&gt;</code> (lowercase, spaces -&gt; <code>-</code>, keep <code>#@+._-</code>).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="group-policy">Group policy<a href="#group-policy" class="hash-link" aria-label="Group policy的直接链接" title="Group policy的直接链接" translate="no">​</a></h2>
<p>Control how group/room messages are handled per channel:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;disabled&quot;, // &quot;open&quot; | &quot;disabled&quot; | &quot;allowlist&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;+15551234567&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    telegram: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;disabled&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;123456789&quot;, &quot;@username&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    signal: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;disabled&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;+15551234567&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    imessage: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;disabled&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;chat_id:123&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    msteams: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;disabled&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;user@org.com&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    discord: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      guilds: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;GUILD_ID&quot;: { channels: { help: { allow: true } } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    slack: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      channels: { &quot;#general&quot;: { allow: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    matrix: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;@owner:example.org&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;!roomId:example.org&quot;: { allow: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;#alias:example.org&quot;: { allow: true }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>





















<table><thead><tr><th>Policy</th><th>Behavior</th></tr></thead><tbody><tr><td><code>&quot;open&quot;</code></td><td>Groups bypass allowlists; mention-gating still applies.</td></tr><tr><td><code>&quot;disabled&quot;</code></td><td>Block all group messages entirely.</td></tr><tr><td><code>&quot;allowlist&quot;</code></td><td>Only allow groups/rooms that match the configured allowlist.</td></tr></tbody></table>
<p>Notes:</p>
<ul>
<li class=""><code>groupPolicy</code> is separate from mention-gating (which requires @mentions).</li>
<li class="">WhatsApp/Telegram/Signal/iMessage/Microsoft Teams: use <code>groupAllowFrom</code> (fallback: explicit <code>allowFrom</code>).</li>
<li class="">Discord: allowlist uses <code>channels.discord.guilds.&lt;id&gt;.channels</code>.</li>
<li class="">Slack: allowlist uses <code>channels.slack.channels</code>.</li>
<li class="">Matrix: allowlist uses <code>channels.matrix.groups</code> (room IDs, aliases, or names). Use <code>channels.matrix.groupAllowFrom</code> to restrict senders; per-room <code>users</code> allowlists are also supported.</li>
<li class="">Group DMs are controlled separately (<code>channels.discord.dm.*</code>, <code>channels.slack.dm.*</code>).</li>
<li class="">Telegram allowlist can match user IDs (<code>&quot;123456789&quot;</code>, <code>&quot;telegram:123456789&quot;</code>, <code>&quot;tg:123456789&quot;</code>) or usernames (<code>&quot;@alice&quot;</code> or <code>&quot;alice&quot;</code>); prefixes are case-insensitive.</li>
<li class="">Default is <code>groupPolicy: &quot;allowlist&quot;</code>; if your group allowlist is empty, group messages are blocked.</li>
</ul>
<p>Quick mental model (evaluation order for group messages):</p>
<ol>
<li class=""><code>groupPolicy</code> (open/disabled/allowlist)</li>
<li class="">group allowlists (<code>*.groups</code>, <code>*.groupAllowFrom</code>, channel-specific allowlist)</li>
<li class="">mention gating (<code>requireMention</code>, <code>/activation</code>)</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="mention-gating-default">Mention gating (default)<a href="#mention-gating-default" class="hash-link" aria-label="Mention gating (default)的直接链接" title="Mention gating (default)的直接链接" translate="no">​</a></h2>
<p>Group messages require a mention unless overridden per group. Defaults live per subsystem under <code>*.groups.&quot;*&quot;</code>.</p>
<p>Replying to a bot message counts as an implicit mention (when the channel supports reply metadata). This applies to Telegram, WhatsApp, Slack, Discord, and Microsoft Teams.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;*&quot;: { requireMention: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;123@g.us&quot;: { requireMention: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    telegram: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;*&quot;: { requireMention: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;123456789&quot;: { requireMention: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    imessage: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;*&quot;: { requireMention: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;123&quot;: { requireMention: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;main&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        groupChat: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          mentionPatterns: [&quot;@clawd&quot;, &quot;moltbot&quot;, &quot;\\+15555550123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          historyLimit: 50</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class=""><code>mentionPatterns</code> are case-insensitive regexes.</li>
<li class="">Surfaces that provide explicit mentions still pass; patterns are a fallback.</li>
<li class="">Per-agent override: <code>agents.list[].groupChat.mentionPatterns</code> (useful when multiple agents share a group).</li>
<li class="">Mention gating is only enforced when mention detection is possible (native mentions or <code>mentionPatterns</code> are configured).</li>
<li class="">Discord defaults live in <code>channels.discord.guilds.&quot;*&quot;</code> (overridable per guild/channel).</li>
<li class="">Group history context is wrapped uniformly across channels and is <strong>pending-only</strong> (messages skipped due to mention gating); use <code>messages.groupChat.historyLimit</code> for the global default and <code>channels.&lt;channel&gt;.historyLimit</code> (or <code>channels.&lt;channel&gt;.accounts.*.historyLimit</code>) for overrides. Set <code>0</code> to disable.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="groupchannel-tool-restrictions-optional">Group/channel tool restrictions (optional)<a href="#groupchannel-tool-restrictions-optional" class="hash-link" aria-label="Group/channel tool restrictions (optional)的直接链接" title="Group/channel tool restrictions (optional)的直接链接" translate="no">​</a></h2>
<p>Some channel configs support restricting which tools are available <strong>inside a specific group/room/channel</strong>.</p>
<ul>
<li class=""><code>tools</code>: allow/deny tools for the whole group.</li>
<li class=""><code>toolsBySender</code>: per-sender overrides within the group (keys are sender IDs/usernames/emails/phone numbers depending on the channel). Use <code>&quot;*&quot;</code> as a wildcard.</li>
</ul>
<p>Resolution order (most specific wins):</p>
<ol>
<li class="">group/channel <code>toolsBySender</code> match</li>
<li class="">group/channel <code>tools</code></li>
<li class="">default (<code>&quot;*&quot;</code>) <code>toolsBySender</code> match</li>
<li class="">default (<code>&quot;*&quot;</code>) <code>tools</code></li>
</ol>
<p>Example (Telegram):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    telegram: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;*&quot;: { tools: { deny: [&quot;exec&quot;] } },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;-1001234567890&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          tools: { deny: [&quot;exec&quot;, &quot;read&quot;, &quot;write&quot;] },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          toolsBySender: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            &quot;123456789&quot;: { alsoAllow: [&quot;exec&quot;] }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Group/channel tool restrictions are applied in addition to global/agent tool policy (deny still wins).</li>
<li class="">Some channels use different nesting for rooms/channels (e.g., Discord <code>guilds.*.channels.*</code>, Slack <code>channels.*</code>, MS Teams <code>teams.*.channels.*</code>).</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="group-allowlists">Group allowlists<a href="#group-allowlists" class="hash-link" aria-label="Group allowlists的直接链接" title="Group allowlists的直接链接" translate="no">​</a></h2>
<p>When <code>channels.whatsapp.groups</code>, <code>channels.telegram.groups</code>, or <code>channels.imessage.groups</code> is configured, the keys act as a group allowlist. Use <code>&quot;*&quot;</code> to allow all groups while still setting default mention behavior.</p>
<p>Common intents (copy/paste):</p>
<ol>
<li class="">Disable all group replies</li>
</ol>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: { whatsapp: { groupPolicy: &quot;disabled&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="2">
<li class="">Allow only specific groups (WhatsApp)</li>
</ol>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;123@g.us&quot;: { requireMention: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;456@g.us&quot;: { requireMention: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="3">
<li class="">Allow all groups but require mention (explicit)</li>
</ol>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: { &quot;*&quot;: { requireMention: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="4">
<li class="">Only the owner can trigger in groups (WhatsApp)</li>
</ol>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;+15551234567&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: { &quot;*&quot;: { requireMention: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="activation-owner-only">Activation (owner-only)<a href="#activation-owner-only" class="hash-link" aria-label="Activation (owner-only)的直接链接" title="Activation (owner-only)的直接链接" translate="no">​</a></h2>
<p>Group owners can toggle per-group activation:</p>
<ul>
<li class=""><code>/activation mention</code></li>
<li class=""><code>/activation always</code></li>
</ul>
<p>Owner is determined by <code>channels.whatsapp.allowFrom</code> (or the bot’s self E.164 when unset). Send the command as a standalone message. Other surfaces currently ignore <code>/activation</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="context-fields">Context fields<a href="#context-fields" class="hash-link" aria-label="Context fields的直接链接" title="Context fields的直接链接" translate="no">​</a></h2>
<p>Group inbound payloads set:</p>
<ul>
<li class=""><code>ChatType=group</code></li>
<li class=""><code>GroupSubject</code> (if known)</li>
<li class=""><code>GroupMembers</code> (if known)</li>
<li class=""><code>WasMentioned</code> (mention gating result)</li>
<li class="">Telegram forum topics also include <code>MessageThreadId</code> and <code>IsForum</code>.</li>
</ul>
<p>The agent system prompt includes a group intro on the first turn of a new group session. It reminds the model to respond like a human, avoid Markdown tables, and avoid typing literal <code>\n</code> sequences.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="imessage-specifics">iMessage specifics<a href="#imessage-specifics" class="hash-link" aria-label="iMessage specifics的直接链接" title="iMessage specifics的直接链接" translate="no">​</a></h2>
<ul>
<li class="">Prefer <code>chat_id:&lt;id&gt;</code> when routing or allowlisting.</li>
<li class="">List chats: <code>imsg chats --limit 20</code>.</li>
<li class="">Group replies always go back to the same <code>chat_id</code>.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="whatsapp-specifics">WhatsApp specifics<a href="#whatsapp-specifics" class="hash-link" aria-label="WhatsApp specifics的直接链接" title="WhatsApp specifics的直接链接" translate="no">​</a></h2>
<p>See <a class="" href="/moltbot-doc/concepts/group-messages">Group messages</a> for WhatsApp-only behavior (history injection, mention handling details).</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"></nav></div></div><div class="col col--3"><div class="tocWrapper_xKoj"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#beginner-intro-2-minutes" class="table-of-contents__link toc-highlight">Beginner intro (2 minutes)</a></li><li><a href="#session-keys" class="table-of-contents__link toc-highlight">Session keys</a></li><li><a href="#pattern-personal-dms--public-groups-single-agent" class="table-of-contents__link toc-highlight">Pattern: personal DMs + public groups (single agent)</a></li><li><a href="#display-labels" class="table-of-contents__link toc-highlight">Display labels</a></li><li><a href="#group-policy" class="table-of-contents__link toc-highlight">Group policy</a></li><li><a href="#mention-gating-default" class="table-of-contents__link toc-highlight">Mention gating (default)</a></li><li><a href="#groupchannel-tool-restrictions-optional" class="table-of-contents__link toc-highlight">Group/channel tool restrictions (optional)</a></li><li><a href="#group-allowlists" class="table-of-contents__link toc-highlight">Group allowlists</a></li><li><a href="#activation-owner-only" class="table-of-contents__link toc-highlight">Activation (owner-only)</a></li><li><a href="#context-fields" class="table-of-contents__link toc-highlight">Context fields</a></li><li><a href="#imessage-specifics" class="table-of-contents__link toc-highlight">iMessage specifics</a></li><li><a href="#whatsapp-specifics" class="table-of-contents__link toc-highlight">WhatsApp specifics</a></li></ul></div><div class="tocFooter_Fu2z"><div class="themeGroup_RzWV" role="group" aria-label="Theme"><button class="themeBtn_tGr6" aria-label="Light theme" title="Light"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button><button class="themeBtn_tGr6 themeBtnActive_A6tm" aria-label="Dark theme" title="Dark"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M11.38 2.019a7.5 7.5 0 1 0 10.6 10.6C21.83 17.963 17.315 22 12.002 22 6.477 22 2 17.523 2 12c0-5.314 4.038-9.827 9.38-10.28z"></path></svg></button></div></div></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Moltbot Docs.</div></div></div></footer></div>
</body>
</html>