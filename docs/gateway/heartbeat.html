<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-gateway/heartbeat" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Heartbeat (Gateway) | Moltbot Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luuman.github.io/moltbot-doc/docs/gateway/heartbeat"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Heartbeat (Gateway) | Moltbot Docs"><meta data-rh="true" name="description" content="Heartbeat vs Cron? See Cron vs Heartbeat for guidance on when to use each."><meta data-rh="true" property="og:description" content="Heartbeat vs Cron? See Cron vs Heartbeat for guidance on when to use each."><link data-rh="true" rel="icon" href="/moltbot-doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luuman.github.io/moltbot-doc/docs/gateway/heartbeat"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/gateway/heartbeat" hreflang="zh"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/gateway/heartbeat" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/moltbot-doc/blog/rss.xml" title="Moltbot Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/moltbot-doc/blog/atom.xml" title="Moltbot Docs Atom Feed"><link rel="stylesheet" href="/moltbot-doc/assets/css/styles.484b4c98.css">
<script src="/moltbot-doc/assets/js/runtime~main.6cf495cf.js" defer="defer"></script>
<script src="/moltbot-doc/assets/js/main.f9205183.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav class="navbar navbar--fixed-top navbar_MONK" role="navigation" aria-label="Main"><div class="navbarInner_ASTH"><div class="navbarLeft_pUmY"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="brand_SXL9" href="/moltbot-doc/"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="6" fill="var(--ifm-color-primary)"></rect><path d="M7 8.5h10M7 12h7M7 15.5h10" stroke="white" stroke-width="1.8" stroke-linecap="round"></path></svg><span class="brandTitle_XbyU">Moltbot</span></a><div class="dropdown_GrgZ"><button class="dropdownToggle_Nf_z">全部站点<svg class="dropdownArrow_Eka8" viewBox="0 0 12 12" fill="none"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><ul class="dropdownMenu_zsxH"><li><a href="https://luuman.github.io/docs-workspace/docs" class="dropdownMenuItem_VBaP">Workspace</a></li><li><a href="https://luuman.github.io/claude-doc/docs" class="dropdownMenuItem_VBaP">Claude</a></li><li><a href="https://luuman.github.io/electron-doc/docs" class="dropdownMenuItem_VBaP">Electron</a></li><li><a href="https://luuman.github.io/tauri-doc/docs" class="dropdownMenuItem_VBaP">Tauri</a></li><li><a href="https://luuman.github.io/matrx-doc/docs" class="dropdownMenuItem_VBaP">Matrx</a></li><li><a href="https://luuman.github.io/brainboard-doc/docs" class="dropdownMenuItem_VBaP">Brainboard</a></li><li><a href="https://luuman.github.io/synology-doc/docs" class="dropdownMenuItem_VBaP">Synology</a></li><li><a href="https://luuman.github.io/codex-doc/docs" class="dropdownMenuItem_VBaP">Codex</a></li><li><a href="https://luuman.github.io/ai-doc/docs" class="dropdownMenuItem_VBaP">AI</a></li></ul></div></div><div class="navbarCenter_Zdr3"><div class="root_OF3s"><span class="icon_UcOK" aria-hidden="true"><svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></span><div class="slot__FGx"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div class="navbarRight_q16u"><a class="navLink_RnnM" href="/moltbot-doc/docs">Docs</a><a class="navLink_RnnM" href="/moltbot-doc/blog">Blog</a><button class="themeToggle_zD_x" aria-label="Switch to light theme" title="Light"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Heartbeat (Gateway)</h1></header>
<blockquote>
<p><strong>Heartbeat vs Cron?</strong> See <a class="" href="/moltbot-doc/automation/cron-vs-heartbeat">Cron vs Heartbeat</a> for guidance on when to use each.</p>
</blockquote>
<p>Heartbeat runs <strong>periodic agent turns</strong> in the main session so the model can
surface anything that needs attention without spamming you.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="quick-start-beginner">Quick start (beginner)<a href="#quick-start-beginner" class="hash-link" aria-label="Quick start (beginner)的直接链接" title="Quick start (beginner)的直接链接" translate="no">​</a></h2>
<ol>
<li class="">Leave heartbeats enabled (default is <code>30m</code>, or <code>1h</code> for Anthropic OAuth/setup-token) or set your own cadence.</li>
<li class="">Create a tiny <code>HEARTBEAT.md</code> checklist in the agent workspace (optional but recommended).</li>
<li class="">Decide where heartbeat messages should go (<code>target: &quot;last&quot;</code> is the default).</li>
<li class="">Optional: enable heartbeat reasoning delivery for transparency.</li>
<li class="">Optional: restrict heartbeats to active hours (local time).</li>
</ol>
<p>Example config:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      heartbeat: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        every: &quot;30m&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        target: &quot;last&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        // activeHours: { start: &quot;08:00&quot;, end: &quot;24:00&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        // includeReasoning: true, // optional: send separate `Reasoning:` message too</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="defaults">Defaults<a href="#defaults" class="hash-link" aria-label="Defaults的直接链接" title="Defaults的直接链接" translate="no">​</a></h2>
<ul>
<li class="">Interval: <code>30m</code> (or <code>1h</code> when Anthropic OAuth/setup-token is the detected auth mode). Set <code>agents.defaults.heartbeat.every</code> or per-agent <code>agents.list[].heartbeat.every</code>; use <code>0m</code> to disable.</li>
<li class="">Prompt body (configurable via <code>agents.defaults.heartbeat.prompt</code>):
<code>Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior chats. If nothing needs attention, reply HEARTBEAT_OK.</code></li>
<li class="">The heartbeat prompt is sent <strong>verbatim</strong> as the user message. The system
prompt includes a “Heartbeat” section and the run is flagged internally.</li>
<li class="">Active hours (<code>heartbeat.activeHours</code>) are checked in the configured timezone.
Outside the window, heartbeats are skipped until the next tick inside the window.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-the-heartbeat-prompt-is-for">What the heartbeat prompt is for<a href="#what-the-heartbeat-prompt-is-for" class="hash-link" aria-label="What the heartbeat prompt is for的直接链接" title="What the heartbeat prompt is for的直接链接" translate="no">​</a></h2>
<p>The default prompt is intentionally broad:</p>
<ul>
<li class=""><strong>Background tasks</strong>: “Consider outstanding tasks” nudges the agent to review
follow-ups (inbox, calendar, reminders, queued work) and surface anything urgent.</li>
<li class=""><strong>Human check-in</strong>: “Checkup sometimes on your human during day time” nudges an
occasional lightweight “anything you need?” message, but avoids night-time spam
by using your configured local timezone (see <a class="" href="/moltbot-doc/concepts/timezone">/concepts/timezone</a>).</li>
</ul>
<p>If you want a heartbeat to do something very specific (e.g. “check Gmail PubSub
stats” or “verify gateway health”), set <code>agents.defaults.heartbeat.prompt</code> (or
<code>agents.list[].heartbeat.prompt</code>) to a custom body (sent verbatim).</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="response-contract">Response contract<a href="#response-contract" class="hash-link" aria-label="Response contract的直接链接" title="Response contract的直接链接" translate="no">​</a></h2>
<ul>
<li class="">If nothing needs attention, reply with <strong><code>HEARTBEAT_OK</code></strong>.</li>
<li class="">During heartbeat runs, Moltbot treats <code>HEARTBEAT_OK</code> as an ack when it appears
at the <strong>start or end</strong> of the reply. The token is stripped and the reply is
dropped if the remaining content is <strong>≤ <code>ackMaxChars</code></strong> (default: 300).</li>
<li class="">If <code>HEARTBEAT_OK</code> appears in the <strong>middle</strong> of a reply, it is not treated
specially.</li>
<li class="">For alerts, <strong>do not</strong> include <code>HEARTBEAT_OK</code>; return only the alert text.</li>
</ul>
<p>Outside heartbeats, stray <code>HEARTBEAT_OK</code> at the start/end of a message is stripped
and logged; a message that is only <code>HEARTBEAT_OK</code> is dropped.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="config">Config<a href="#config" class="hash-link" aria-label="Config的直接链接" title="Config的直接链接" translate="no">​</a></h2>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      heartbeat: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        every: &quot;30m&quot;,           // default: 30m (0m disables)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        model: &quot;anthropic/claude-opus-4-5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        includeReasoning: false, // default: false (deliver separate Reasoning: message when available)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        target: &quot;last&quot;,         // last | none | &lt;channel id&gt; (core or plugin, e.g. &quot;bluebubbles&quot;)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        to: &quot;+15551234567&quot;,     // optional channel-specific override</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        prompt: &quot;Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior chats. If nothing needs attention, reply HEARTBEAT_OK.&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ackMaxChars: 300         // max chars allowed after HEARTBEAT_OK</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="scope-and-precedence">Scope and precedence<a href="#scope-and-precedence" class="hash-link" aria-label="Scope and precedence的直接链接" title="Scope and precedence的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><code>agents.defaults.heartbeat</code> sets global heartbeat behavior.</li>
<li class=""><code>agents.list[].heartbeat</code> merges on top; if any agent has a <code>heartbeat</code> block, <strong>only those agents</strong> run heartbeats.</li>
<li class=""><code>channels.defaults.heartbeat</code> sets visibility defaults for all channels.</li>
<li class=""><code>channels.&lt;channel&gt;.heartbeat</code> overrides channel defaults.</li>
<li class=""><code>channels.&lt;channel&gt;.accounts.&lt;id&gt;.heartbeat</code> (multi-account channels) overrides per-channel settings.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="per-agent-heartbeats">Per-agent heartbeats<a href="#per-agent-heartbeats" class="hash-link" aria-label="Per-agent heartbeats的直接链接" title="Per-agent heartbeats的直接链接" translate="no">​</a></h3>
<p>If any <code>agents.list[]</code> entry includes a <code>heartbeat</code> block, <strong>only those agents</strong>
run heartbeats. The per-agent block merges on top of <code>agents.defaults.heartbeat</code>
(so you can set shared defaults once and override per agent).</p>
<p>Example: two agents, only the second agent runs heartbeats.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      heartbeat: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        every: &quot;30m&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        target: &quot;last&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      { id: &quot;main&quot;, default: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;ops&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        heartbeat: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          every: &quot;1h&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          target: &quot;whatsapp&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          to: &quot;+15551234567&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          prompt: &quot;Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior chats. If nothing needs attention, reply HEARTBEAT_OK.&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="field-notes">Field notes<a href="#field-notes" class="hash-link" aria-label="Field notes的直接链接" title="Field notes的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><code>every</code>: heartbeat interval (duration string; default unit = minutes).</li>
<li class=""><code>model</code>: optional model override for heartbeat runs (<code>provider/model</code>).</li>
<li class=""><code>includeReasoning</code>: when enabled, also deliver the separate <code>Reasoning:</code> message when available (same shape as <code>/reasoning on</code>).</li>
<li class=""><code>session</code>: optional session key for heartbeat runs.
<ul>
<li class=""><code>main</code> (default): agent main session.</li>
<li class="">Explicit session key (copy from <code>moltbot sessions --json</code> or the <a class="" href="/moltbot-doc/cli/sessions">sessions CLI</a>).</li>
<li class="">Session key formats: see <a class="" href="/moltbot-doc/concepts/session">Sessions</a> and <a class="" href="/moltbot-doc/concepts/groups">Groups</a>.</li>
</ul>
</li>
<li class=""><code>target</code>:
<ul>
<li class=""><code>last</code> (default): deliver to the last used external channel.</li>
<li class="">explicit channel: <code>whatsapp</code> / <code>telegram</code> / <code>discord</code> / <code>googlechat</code> / <code>slack</code> / <code>msteams</code> / <code>signal</code> / <code>imessage</code>.</li>
<li class=""><code>none</code>: run the heartbeat but <strong>do not deliver</strong> externally.</li>
</ul>
</li>
<li class=""><code>to</code>: optional recipient override (channel-specific id, e.g. E.164 for WhatsApp or a Telegram chat id).</li>
<li class=""><code>prompt</code>: overrides the default prompt body (not merged).</li>
<li class=""><code>ackMaxChars</code>: max chars allowed after <code>HEARTBEAT_OK</code> before delivery.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="delivery-behavior">Delivery behavior<a href="#delivery-behavior" class="hash-link" aria-label="Delivery behavior的直接链接" title="Delivery behavior的直接链接" translate="no">​</a></h2>
<ul>
<li class="">Heartbeats run in the agent’s main session by default (<code>agent:&lt;id&gt;:&lt;mainKey&gt;</code>),
or <code>global</code> when <code>session.scope = &quot;global&quot;</code>. Set <code>session</code> to override to a
specific channel session (Discord/WhatsApp/etc.).</li>
<li class=""><code>session</code> only affects the run context; delivery is controlled by <code>target</code> and <code>to</code>.</li>
<li class="">To deliver to a specific channel/recipient, set <code>target</code> + <code>to</code>. With
<code>target: &quot;last&quot;</code>, delivery uses the last external channel for that session.</li>
<li class="">If the main queue is busy, the heartbeat is skipped and retried later.</li>
<li class="">If <code>target</code> resolves to no external destination, the run still happens but no
outbound message is sent.</li>
<li class="">Heartbeat-only replies do <strong>not</strong> keep the session alive; the last <code>updatedAt</code>
is restored so idle expiry behaves normally.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="visibility-controls">Visibility controls<a href="#visibility-controls" class="hash-link" aria-label="Visibility controls的直接链接" title="Visibility controls的直接链接" translate="no">​</a></h2>
<p>By default, <code>HEARTBEAT_OK</code> acknowledgments are suppressed while alert content is
delivered. You can adjust this per channel or per account:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token key atrule" style="color:#C792EA">channels</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">defaults</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">heartbeat</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">showOk</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">false</span><span class="token plain">      </span><span class="token comment" style="color:#637777;font-style:italic"># Hide HEARTBEAT_OK (default)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">showAlerts</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">true</span><span class="token plain">   </span><span class="token comment" style="color:#637777;font-style:italic"># Show alert messages (default)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">useIndicator</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">true</span><span class="token plain"> </span><span class="token comment" style="color:#637777;font-style:italic"># Emit indicator events (default)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">telegram</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">heartbeat</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">showOk</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">true</span><span class="token plain">       </span><span class="token comment" style="color:#637777;font-style:italic"># Show OK acknowledgments on Telegram</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">whatsapp</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">accounts</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">work</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">heartbeat</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">showAlerts</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">false</span><span class="token plain"> </span><span class="token comment" style="color:#637777;font-style:italic"># Suppress alert delivery for this account</span><br></span></code></pre></div></div>
<p>Precedence: per-account → per-channel → channel defaults → built-in defaults.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-each-flag-does">What each flag does<a href="#what-each-flag-does" class="hash-link" aria-label="What each flag does的直接链接" title="What each flag does的直接链接" translate="no">​</a></h3>
<ul>
<li class=""><code>showOk</code>: sends a <code>HEARTBEAT_OK</code> acknowledgment when the model returns an OK-only reply.</li>
<li class=""><code>showAlerts</code>: sends the alert content when the model returns a non-OK reply.</li>
<li class=""><code>useIndicator</code>: emits indicator events for UI status surfaces.</li>
</ul>
<p>If <strong>all three</strong> are false, Moltbot skips the heartbeat run entirely (no model call).</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="per-channel-vs-per-account-examples">Per-channel vs per-account examples<a href="#per-channel-vs-per-account-examples" class="hash-link" aria-label="Per-channel vs per-account examples的直接链接" title="Per-channel vs per-account examples的直接链接" translate="no">​</a></h3>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token key atrule" style="color:#C792EA">channels</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">defaults</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">heartbeat</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">showOk</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">showAlerts</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">useIndicator</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">slack</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">heartbeat</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">showOk</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">true</span><span class="token plain"> </span><span class="token comment" style="color:#637777;font-style:italic"># all Slack accounts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">accounts</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">ops</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        </span><span class="token key atrule" style="color:#C792EA">heartbeat</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          </span><span class="token key atrule" style="color:#C792EA">showAlerts</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">false</span><span class="token plain"> </span><span class="token comment" style="color:#637777;font-style:italic"># suppress alerts for the ops account only</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><span class="token key atrule" style="color:#C792EA">telegram</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    </span><span class="token key atrule" style="color:#C792EA">heartbeat</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      </span><span class="token key atrule" style="color:#C792EA">showOk</span><span class="token punctuation" style="color:#C792EA">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#D6DEEB">true</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="common-patterns">Common patterns<a href="#common-patterns" class="hash-link" aria-label="Common patterns的直接链接" title="Common patterns的直接链接" translate="no">​</a></h3>

























<table><thead><tr><th>Goal</th><th>Config</th></tr></thead><tbody><tr><td>Default behavior (silent OKs, alerts on)</td><td><em>(no config needed)</em></td></tr><tr><td>Fully silent (no messages, no indicator)</td><td><code>channels.defaults.heartbeat: { showOk: false, showAlerts: false, useIndicator: false }</code></td></tr><tr><td>Indicator-only (no messages)</td><td><code>channels.defaults.heartbeat: { showOk: false, showAlerts: false, useIndicator: true }</code></td></tr><tr><td>OKs in one channel only</td><td><code>channels.telegram.heartbeat: { showOk: true }</code></td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="heartbeatmd-optional">HEARTBEAT.md (optional)<a href="#heartbeatmd-optional" class="hash-link" aria-label="HEARTBEAT.md (optional)的直接链接" title="HEARTBEAT.md (optional)的直接链接" translate="no">​</a></h2>
<p>If a <code>HEARTBEAT.md</code> file exists in the workspace, the default prompt tells the
agent to read it. Think of it as your “heartbeat checklist”: small, stable, and
safe to include every 30 minutes.</p>
<p>If <code>HEARTBEAT.md</code> exists but is effectively empty (only blank lines and markdown
headers like <code># Heading</code>), Moltbot skips the heartbeat run to save API calls.
If the file is missing, the heartbeat still runs and the model decides what to do.</p>
<p>Keep it tiny (short checklist or reminders) to avoid prompt bloat.</p>
<p>Example <code>HEARTBEAT.md</code>:</p>
<div class="language-md codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-md codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token title important punctuation" style="color:#C792EA">#</span><span class="token title important" style="color:#D6DEEB"> Heartbeat checklist</span><span class="token plain"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token list punctuation" style="color:#C792EA">-</span><span class="token plain"> Quick scan: anything urgent in inboxes?</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token list punctuation" style="color:#C792EA">-</span><span class="token plain"> If it’s daytime, do a lightweight check-in if nothing else is pending.</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain"></span><span class="token list punctuation" style="color:#C792EA">-</span><span class="token plain"> If a task is blocked, write down </span><span class="token italic punctuation" style="color:#C792EA">*</span><span class="token italic content">what is missing</span><span class="token italic punctuation" style="color:#C792EA">*</span><span class="token plain"> and ask Peter next time.</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="can-the-agent-update-heartbeatmd">Can the agent update HEARTBEAT.md?<a href="#can-the-agent-update-heartbeatmd" class="hash-link" aria-label="Can the agent update HEARTBEAT.md?的直接链接" title="Can the agent update HEARTBEAT.md?的直接链接" translate="no">​</a></h3>
<p>Yes — if you ask it to.</p>
<p><code>HEARTBEAT.md</code> is just a normal file in the agent workspace, so you can tell the
agent (in a normal chat) something like:</p>
<ul>
<li class="">“Update <code>HEARTBEAT.md</code> to add a daily calendar check.”</li>
<li class="">“Rewrite <code>HEARTBEAT.md</code> so it’s shorter and focused on inbox follow-ups.”</li>
</ul>
<p>If you want this to happen proactively, you can also include an explicit line in
your heartbeat prompt like: “If the checklist becomes stale, update HEARTBEAT.md
with a better one.”</p>
<p>Safety note: don’t put secrets (API keys, phone numbers, private tokens) into
<code>HEARTBEAT.md</code> — it becomes part of the prompt context.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="manual-wake-on-demand">Manual wake (on-demand)<a href="#manual-wake-on-demand" class="hash-link" aria-label="Manual wake (on-demand)的直接链接" title="Manual wake (on-demand)的直接链接" translate="no">​</a></h2>
<p>You can enqueue a system event and trigger an immediate heartbeat with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">moltbot system event --text &quot;Check for urgent follow-ups&quot; --mode now</span><br></span></code></pre></div></div>
<p>If multiple agents have <code>heartbeat</code> configured, a manual wake runs each of those
agent heartbeats immediately.</p>
<p>Use <code>--mode next-heartbeat</code> to wait for the next scheduled tick.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="reasoning-delivery-optional">Reasoning delivery (optional)<a href="#reasoning-delivery-optional" class="hash-link" aria-label="Reasoning delivery (optional)的直接链接" title="Reasoning delivery (optional)的直接链接" translate="no">​</a></h2>
<p>By default, heartbeats deliver only the final “answer” payload.</p>
<p>If you want transparency, enable:</p>
<ul>
<li class=""><code>agents.defaults.heartbeat.includeReasoning: true</code></li>
</ul>
<p>When enabled, heartbeats will also deliver a separate message prefixed
<code>Reasoning:</code> (same shape as <code>/reasoning on</code>). This can be useful when the agent
is managing multiple sessions/codexes and you want to see why it decided to ping
you — but it can also leak more internal detail than you want. Prefer keeping it
off in group chats.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cost-awareness">Cost awareness<a href="#cost-awareness" class="hash-link" aria-label="Cost awareness的直接链接" title="Cost awareness的直接链接" translate="no">​</a></h2>
<p>Heartbeats run full agent turns. Shorter intervals burn more tokens. Keep
<code>HEARTBEAT.md</code> small and consider a cheaper <code>model</code> or <code>target: &quot;none&quot;</code> if you
only want internal state updates.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"></nav></div></div><div class="col col--3"><div class="tocWrapper_xKoj"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#quick-start-beginner" class="table-of-contents__link toc-highlight">Quick start (beginner)</a></li><li><a href="#defaults" class="table-of-contents__link toc-highlight">Defaults</a></li><li><a href="#what-the-heartbeat-prompt-is-for" class="table-of-contents__link toc-highlight">What the heartbeat prompt is for</a></li><li><a href="#response-contract" class="table-of-contents__link toc-highlight">Response contract</a></li><li><a href="#config" class="table-of-contents__link toc-highlight">Config</a><ul><li><a href="#scope-and-precedence" class="table-of-contents__link toc-highlight">Scope and precedence</a></li><li><a href="#per-agent-heartbeats" class="table-of-contents__link toc-highlight">Per-agent heartbeats</a></li><li><a href="#field-notes" class="table-of-contents__link toc-highlight">Field notes</a></li></ul></li><li><a href="#delivery-behavior" class="table-of-contents__link toc-highlight">Delivery behavior</a></li><li><a href="#visibility-controls" class="table-of-contents__link toc-highlight">Visibility controls</a><ul><li><a href="#what-each-flag-does" class="table-of-contents__link toc-highlight">What each flag does</a></li><li><a href="#per-channel-vs-per-account-examples" class="table-of-contents__link toc-highlight">Per-channel vs per-account examples</a></li><li><a href="#common-patterns" class="table-of-contents__link toc-highlight">Common patterns</a></li></ul></li><li><a href="#heartbeatmd-optional" class="table-of-contents__link toc-highlight">HEARTBEAT.md (optional)</a><ul><li><a href="#can-the-agent-update-heartbeatmd" class="table-of-contents__link toc-highlight">Can the agent update HEARTBEAT.md?</a></li></ul></li><li><a href="#manual-wake-on-demand" class="table-of-contents__link toc-highlight">Manual wake (on-demand)</a></li><li><a href="#reasoning-delivery-optional" class="table-of-contents__link toc-highlight">Reasoning delivery (optional)</a></li><li><a href="#cost-awareness" class="table-of-contents__link toc-highlight">Cost awareness</a></li></ul></div><div class="tocFooter_Fu2z"><div class="themeGroup_RzWV" role="group" aria-label="Theme"><button class="themeBtn_tGr6" aria-label="Light theme" title="Light"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button><button class="themeBtn_tGr6 themeBtnActive_A6tm" aria-label="Dark theme" title="Dark"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M11.38 2.019a7.5 7.5 0 1 0 10.6 10.6C21.83 17.963 17.315 22 12.002 22 6.477 22 2 17.523 2 12c0-5.314 4.038-9.827 9.38-10.28z"></path></svg></button></div></div></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Moltbot Docs.</div></div></div></footer></div>
</body>
</html>