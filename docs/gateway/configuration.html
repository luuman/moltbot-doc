<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-gateway/configuration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Configuration ğŸ”§ | Moltbot Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://luuman.github.io/moltbot-doc/docs/gateway/configuration"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Configuration ğŸ”§ | Moltbot Docs"><meta data-rh="true" name="description" content="Moltbot reads an optional JSON5 config from ~/.clawdbot/moltbot.json (comments + trailing commas allowed)."><meta data-rh="true" property="og:description" content="Moltbot reads an optional JSON5 config from ~/.clawdbot/moltbot.json (comments + trailing commas allowed)."><link data-rh="true" rel="icon" href="/moltbot-doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://luuman.github.io/moltbot-doc/docs/gateway/configuration"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/gateway/configuration" hreflang="zh"><link data-rh="true" rel="alternate" href="https://luuman.github.io/moltbot-doc/docs/gateway/configuration" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"é…ç½®","item":"https://luuman.github.io/moltbot-doc/docs/gateway/configuration"}]}</script><link rel="alternate" type="application/rss+xml" href="/moltbot-doc/blog/rss.xml" title="Moltbot Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/moltbot-doc/blog/atom.xml" title="Moltbot Docs Atom Feed"><link rel="stylesheet" href="/moltbot-doc/assets/css/styles.484b4c98.css">
<script src="/moltbot-doc/assets/js/runtime~main.6cf495cf.js" defer="defer"></script>
<script src="/moltbot-doc/assets/js/main.f9205183.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"dark"),document.documentElement.setAttribute("data-theme-choice",t||"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav class="navbar navbar--fixed-top navbar_MONK" role="navigation" aria-label="Main"><div class="navbarInner_ASTH"><div class="navbarLeft_pUmY"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="brand_SXL9" href="/moltbot-doc/"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="24" height="24" rx="6" fill="var(--ifm-color-primary)"></rect><path d="M7 8.5h10M7 12h7M7 15.5h10" stroke="white" stroke-width="1.8" stroke-linecap="round"></path></svg><span class="brandTitle_XbyU">Moltbot</span></a><div class="dropdown_GrgZ"><button class="dropdownToggle_Nf_z">å…¨éƒ¨ç«™ç‚¹<svg class="dropdownArrow_Eka8" viewBox="0 0 12 12" fill="none"><path d="M2 4l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><ul class="dropdownMenu_zsxH"><li><a href="https://luuman.github.io/docs-workspace/docs" class="dropdownMenuItem_VBaP">Workspace</a></li><li><a href="https://luuman.github.io/claude-doc/docs" class="dropdownMenuItem_VBaP">Claude</a></li><li><a href="https://luuman.github.io/electron-doc/docs" class="dropdownMenuItem_VBaP">Electron</a></li><li><a href="https://luuman.github.io/tauri-doc/docs" class="dropdownMenuItem_VBaP">Tauri</a></li><li><a href="https://luuman.github.io/matrx-doc/docs" class="dropdownMenuItem_VBaP">Matrx</a></li><li><a href="https://luuman.github.io/brainboard-doc/docs" class="dropdownMenuItem_VBaP">Brainboard</a></li><li><a href="https://luuman.github.io/synology-doc/docs" class="dropdownMenuItem_VBaP">Synology</a></li><li><a href="https://luuman.github.io/codex-doc/docs" class="dropdownMenuItem_VBaP">Codex</a></li><li><a href="https://luuman.github.io/ai-doc/docs" class="dropdownMenuItem_VBaP">AI</a></li></ul></div></div><div class="navbarCenter_Zdr3"><div class="root_OF3s"><span class="icon_UcOK" aria-hidden="true"><svg viewBox="0 0 24 24" fill="currentColor" width="15" height="15"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></span><div class="slot__FGx"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="æœç´¢" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div class="navbarRight_q16u"><a class="navLink_RnnM" href="/moltbot-doc/docs">Docs</a><a class="navLink_RnnM" href="/moltbot-doc/blog">Blog</a><button class="themeToggle_zD_x" aria-label="Switch to light theme" title="Light"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button></div></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs"><span title="ä»è¿™é‡Œå¼€å§‹" class="categoryLinkLabel_W154">ä»è¿™é‡Œå¼€å§‹</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs"><span title="ç´¢å¼•" class="linkLabel_WmDU">ç´¢å¼•</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/getting-started"><span title="å¿«é€Ÿå…¥é—¨" class="linkLabel_WmDU">å¿«é€Ÿå…¥é—¨</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/wizard"><span title="å‘å¯¼" class="linkLabel_WmDU">å‘å¯¼</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/setup"><span title="è®¾ç½®" class="linkLabel_WmDU">è®¾ç½®</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/pairing"><span title="é…å¯¹" class="linkLabel_WmDU">é…å¯¹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/clawd"><span title="Clawd" class="linkLabel_WmDU">Clawd</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/showcase"><span title="åŠŸèƒ½å±•ç¤º" class="linkLabel_WmDU">åŠŸèƒ½å±•ç¤º</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/hubs"><span title="ä¸­å¿ƒèŠ‚ç‚¹" class="linkLabel_WmDU">ä¸­å¿ƒèŠ‚ç‚¹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/onboarding"><span title="åˆå§‹å¼•å¯¼" class="linkLabel_WmDU">åˆå§‹å¼•å¯¼</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/start/lore"><span title="èƒŒæ™¯è®¾å®š" class="linkLabel_WmDU">èƒŒæ™¯è®¾å®š</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/help"><span title="å¸®åŠ©" class="categoryLinkLabel_W154">å¸®åŠ©</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/help"><span title="ç´¢å¼•" class="linkLabel_WmDU">ç´¢å¼•</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/help/troubleshooting"><span title="æ•…éšœæ’é™¤" class="linkLabel_WmDU">æ•…éšœæ’é™¤</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/help/faq"><span title="å¸¸è§é—®é¢˜" class="linkLabel_WmDU">å¸¸è§é—®é¢˜</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/install"><span title="å®‰è£…ä¸æ›´æ–°" class="categoryLinkLabel_W154">å®‰è£…ä¸æ›´æ–°</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install"><span title="ç´¢å¼•" class="linkLabel_WmDU">ç´¢å¼•</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/installer"><span title="å®‰è£…ç¨‹åº" class="linkLabel_WmDU">å®‰è£…ç¨‹åº</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/updating"><span title="æ›´æ–°" class="linkLabel_WmDU">æ›´æ–°</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/development-channels"><span title="å¼€å‘é¢‘é“" class="linkLabel_WmDU">å¼€å‘é¢‘é“</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/uninstall"><span title="å¸è½½" class="linkLabel_WmDU">å¸è½½</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/ansible"><span title="Ansible" class="linkLabel_WmDU">Ansible</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/nix"><span title="Nix" class="linkLabel_WmDU">Nix</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/docker"><span title="Docker" class="linkLabel_WmDU">Docker</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/railway"><span title="éƒ¨ç½²åˆ° Railway" class="linkLabel_WmDU">éƒ¨ç½²åˆ° Railway</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/render"><span title="éƒ¨ç½²åˆ° Render" class="linkLabel_WmDU">éƒ¨ç½²åˆ° Render</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/northflank"><span title="éƒ¨ç½²åˆ° Northflank" class="linkLabel_WmDU">éƒ¨ç½²åˆ° Northflank</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/install/bun"><span title="Bun" class="linkLabel_WmDU">Bun</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/cli"><span title="å‘½ä»¤è¡Œç•Œé¢ (CLI)" class="categoryLinkLabel_W154">å‘½ä»¤è¡Œç•Œé¢ (CLI)</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli"><span title="ç´¢å¼•" class="linkLabel_WmDU">ç´¢å¼•</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/setup"><span title="è®¾ç½®" class="linkLabel_WmDU">è®¾ç½®</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/onboard"><span title="åˆå§‹å¼•å¯¼" class="linkLabel_WmDU">åˆå§‹å¼•å¯¼</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/configure"><span title="é…ç½®" class="linkLabel_WmDU">é…ç½®</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/doctor"><span title="ç³»ç»Ÿè¯Šæ–­" class="linkLabel_WmDU">ç³»ç»Ÿè¯Šæ–­</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/dashboard"><span title="ä»ªè¡¨æ¿" class="linkLabel_WmDU">ä»ªè¡¨æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/reset"><span title="é‡ç½®" class="linkLabel_WmDU">é‡ç½®</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/uninstall"><span title="å¸è½½" class="linkLabel_WmDU">å¸è½½</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/browser"><span title="æµè§ˆå™¨" class="linkLabel_WmDU">æµè§ˆå™¨</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/message"><span title="æ¶ˆæ¯" class="linkLabel_WmDU">æ¶ˆæ¯</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/agent"><span title="ä»£ç†" class="linkLabel_WmDU">ä»£ç†</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/agents"><span title="ä»£ç†åˆ—è¡¨" class="linkLabel_WmDU">ä»£ç†åˆ—è¡¨</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/status"><span title="çŠ¶æ€" class="linkLabel_WmDU">çŠ¶æ€</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/health"><span title="å¥åº·çŠ¶æ€" class="linkLabel_WmDU">å¥åº·çŠ¶æ€</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/sessions"><span title="ä¼šè¯" class="linkLabel_WmDU">ä¼šè¯</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/channels"><span title="é¢‘é“" class="linkLabel_WmDU">é¢‘é“</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/directory"><span title="ç›®å½•" class="linkLabel_WmDU">ç›®å½•</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/skills"><span title="æŠ€èƒ½" class="linkLabel_WmDU">æŠ€èƒ½</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/plugins"><span title="æ’ä»¶" class="linkLabel_WmDU">æ’ä»¶</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/memory"><span title="å†…å­˜" class="linkLabel_WmDU">å†…å­˜</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/models"><span title="æ¨¡å‹" class="linkLabel_WmDU">æ¨¡å‹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/logs"><span title="æ—¥å¿—" class="linkLabel_WmDU">æ—¥å¿—</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/system"><span title="ç³»ç»Ÿ" class="linkLabel_WmDU">ç³»ç»Ÿ</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/nodes"><span title="èŠ‚ç‚¹" class="linkLabel_WmDU">èŠ‚ç‚¹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/approvals"><span title="å®¡æ‰¹" class="linkLabel_WmDU">å®¡æ‰¹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/gateway"><span title="ç½‘å…³" class="linkLabel_WmDU">ç½‘å…³</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/tui"><span title="æ–‡æœ¬ç”¨æˆ·ç•Œé¢" class="linkLabel_WmDU">æ–‡æœ¬ç”¨æˆ·ç•Œé¢</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/voicecall"><span title="è¯­éŸ³é€šè¯" class="linkLabel_WmDU">è¯­éŸ³é€šè¯</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/cron"><span title="å®šæ—¶ä»»åŠ¡" class="linkLabel_WmDU">å®šæ—¶ä»»åŠ¡</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/dns"><span title="åŸŸåç³»ç»Ÿ" class="linkLabel_WmDU">åŸŸåç³»ç»Ÿ</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/docs"><span title="æ–‡æ¡£" class="linkLabel_WmDU">æ–‡æ¡£</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/hooks"><span title="é’©å­" class="linkLabel_WmDU">é’©å­</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/pairing"><span title="é…å¯¹" class="linkLabel_WmDU">é…å¯¹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/security"><span title="å®‰å…¨" class="linkLabel_WmDU">å®‰å…¨</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/update"><span title="æ›´æ–°" class="linkLabel_WmDU">æ›´æ–°</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/cli/sandbox"><span title="æ²™ç›’å‘½ä»¤è¡Œç•Œé¢" class="linkLabel_WmDU">æ²™ç›’å‘½ä»¤è¡Œç•Œé¢</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/concepts/architecture"><span title="æ ¸å¿ƒæ¦‚å¿µ" class="categoryLinkLabel_W154">æ ¸å¿ƒæ¦‚å¿µ</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/architecture"><span title="æ¶æ„" class="linkLabel_WmDU">æ¶æ„</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/agent"><span title="ä»£ç†" class="linkLabel_WmDU">ä»£ç†</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/agent-loop"><span title="ä»£ç†å¾ªç¯" class="linkLabel_WmDU">ä»£ç†å¾ªç¯</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/agent-workspace"><span title="ä»£ç†å·¥ä½œç©ºé—´" class="linkLabel_WmDU">ä»£ç†å·¥ä½œç©ºé—´</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/session"><span title="ä¼šè¯" class="linkLabel_WmDU">ä¼šè¯</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/session-pruning"><span title="ä¼šè¯æ¸…ç†" class="linkLabel_WmDU">ä¼šè¯æ¸…ç†</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/session-tool"><span title="ä¼šè¯å·¥å…·" class="linkLabel_WmDU">ä¼šè¯å·¥å…·</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/model-providers"><span title="æ¨¡å‹æä¾›å•†" class="linkLabel_WmDU">æ¨¡å‹æä¾›å•†</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/concepts/model-failover"><span title="æ¨¡å‹æ•…éšœè½¬ç§»" class="linkLabel_WmDU">æ¨¡å‹æ•…éšœè½¬ç§»</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/moltbot-doc/docs/gateway/configuration"><span title="ç½‘å…³è¿ç»´" class="categoryLinkLabel_W154">ç½‘å…³è¿ç»´</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/moltbot-doc/docs/gateway/configuration"><span title="é…ç½®" class="linkLabel_WmDU">é…ç½®</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/gateway/configuration-examples"><span title="é…ç½®ç¤ºä¾‹" class="linkLabel_WmDU">é…ç½®ç¤ºä¾‹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/gateway/remote"><span title="è¿œç¨‹" class="linkLabel_WmDU">è¿œç¨‹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/gateway/remote-gateway-readme"><span title="è¿œç¨‹ç½‘å…³è¯´æ˜" class="linkLabel_WmDU">è¿œç¨‹ç½‘å…³è¯´æ˜</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/automation/cron-jobs"><span title="è‡ªåŠ¨åŒ–é’©å­" class="categoryLinkLabel_W154">è‡ªåŠ¨åŒ–é’©å­</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/automation/cron-jobs"><span title="å®šæ—¶ä»»åŠ¡" class="linkLabel_WmDU">å®šæ—¶ä»»åŠ¡</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/automation/cron-vs-heartbeat"><span title="å®šæ—¶ä»»åŠ¡ vs å¿ƒè·³" class="linkLabel_WmDU">å®šæ—¶ä»»åŠ¡ vs å¿ƒè·³</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/tools/browser"><span title="å·¥å…·ä¸æŠ€èƒ½" class="categoryLinkLabel_W154">å·¥å…·ä¸æŠ€èƒ½</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/tools/browser"><span title="æµè§ˆå™¨" class="linkLabel_WmDU">æµè§ˆå™¨</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/tools/browser-login"><span title="æµè§ˆå™¨ç™»å½•" class="linkLabel_WmDU">æµè§ˆå™¨ç™»å½•</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/tools/browser-linux-troubleshooting"><span title="æµè§ˆå™¨ Linux æ•…éšœæ’é™¤" class="linkLabel_WmDU">æµè§ˆå™¨ Linux æ•…éšœæ’é™¤</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/tools/skills"><span title="æŠ€èƒ½" class="linkLabel_WmDU">æŠ€èƒ½</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/tools/skills-config"><span title="æŠ€èƒ½é…ç½®" class="linkLabel_WmDU">æŠ€èƒ½é…ç½®</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/platforms/macos"><span title="å¹³å°" class="categoryLinkLabel_W154">å¹³å°</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/macos"><span title="macOS" class="linkLabel_WmDU">macOS</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/macos-vm"><span title="macOS è™šæ‹Ÿæœº" class="linkLabel_WmDU">macOS è™šæ‹Ÿæœº</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/platforms/mac/dev-setup"><span title="macOS ä¼´ä¾£åº”ç”¨" class="categoryLinkLabel_W154">macOS ä¼´ä¾£åº”ç”¨</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/dev-setup"><span title="å¼€å‘ç¯å¢ƒè®¾ç½®" class="linkLabel_WmDU">å¼€å‘ç¯å¢ƒè®¾ç½®</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/menu-bar"><span title="èœå•æ " class="linkLabel_WmDU">èœå•æ </span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/voicewake"><span title="è¯­éŸ³å”¤é†’" class="linkLabel_WmDU">è¯­éŸ³å”¤é†’</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/voice-overlay"><span title="è¯­éŸ³æ‚¬æµ®çª—" class="linkLabel_WmDU">è¯­éŸ³æ‚¬æµ®çª—</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/webchat"><span title="ç½‘é¡µèŠå¤©" class="linkLabel_WmDU">ç½‘é¡µèŠå¤©</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/canvas"><span title="ç”»å¸ƒ" class="linkLabel_WmDU">ç”»å¸ƒ</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/child-process"><span title="å­è¿›ç¨‹" class="linkLabel_WmDU">å­è¿›ç¨‹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/health"><span title="å¥åº·çŠ¶æ€" class="linkLabel_WmDU">å¥åº·çŠ¶æ€</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/icon"><span title="å›¾æ ‡" class="linkLabel_WmDU">å›¾æ ‡</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/logging"><span title="æ—¥å¿—è®°å½•" class="linkLabel_WmDU">æ—¥å¿—è®°å½•</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/permissions"><span title="æƒé™" class="linkLabel_WmDU">æƒé™</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/remote"><span title="è¿œç¨‹" class="linkLabel_WmDU">è¿œç¨‹</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/signing"><span title="ç­¾å" class="linkLabel_WmDU">ç­¾å</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/release"><span title="å‘å¸ƒ" class="linkLabel_WmDU">å‘å¸ƒ</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/bundled-gateway"><span title="æ†ç»‘ç½‘å…³" class="linkLabel_WmDU">æ†ç»‘ç½‘å…³</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/xpc"><span title="XPC" class="linkLabel_WmDU">XPC</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/skills"><span title="æŠ€èƒ½" class="linkLabel_WmDU">æŠ€èƒ½</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/platforms/mac/peekaboo"><span title="Peekaboo" class="linkLabel_WmDU">Peekaboo</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/moltbot-doc/docs/reference/templates/AGENTS"><span title="å‚è€ƒæ¨¡æ¿" class="categoryLinkLabel_W154">å‚è€ƒæ¨¡æ¿</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/AGENTS"><span title="ä»£ç†æ¨¡æ¿" class="linkLabel_WmDU">ä»£ç†æ¨¡æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/BOOT"><span title="å¯åŠ¨æ¨¡æ¿" class="linkLabel_WmDU">å¯åŠ¨æ¨¡æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/BOOTSTRAP"><span title="å¼•å¯¼ç¨‹åºæ¨¡æ¿" class="linkLabel_WmDU">å¼•å¯¼ç¨‹åºæ¨¡æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/HEARTBEAT"><span title="å¿ƒè·³æ¨¡æ¿" class="linkLabel_WmDU">å¿ƒè·³æ¨¡æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/IDENTITY"><span title="èº«ä»½æ¨¡æ¿" class="linkLabel_WmDU">èº«ä»½æ¨¡æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/SOUL"><span title="æ ¸å¿ƒæ¨¡æ¿" class="linkLabel_WmDU">æ ¸å¿ƒæ¨¡æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/TOOLS"><span title="å·¥å…·æ¨¡æ¿" class="linkLabel_WmDU">å·¥å…·æ¨¡æ¿</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/moltbot-doc/docs/reference/templates/USER"><span title="ç”¨æˆ·æ¨¡æ¿" class="linkLabel_WmDU">ç”¨æˆ·æ¨¡æ¿</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/moltbot-doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ç½‘å…³è¿ç»´</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">é…ç½®</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>Configuration ğŸ”§</h1></header>
<p>Moltbot reads an optional <strong>JSON5</strong> config from <code>~/.clawdbot/moltbot.json</code> (comments + trailing commas allowed).</p>
<p>If the file is missing, Moltbot uses safe-ish defaults (embedded Pi agent + per-sender sessions + workspace <code>~/clawd</code>). You usually only need a config to:</p>
<ul>
<li class="">restrict who can trigger the bot (<code>channels.whatsapp.allowFrom</code>, <code>channels.telegram.allowFrom</code>, etc.)</li>
<li class="">control group allowlists + mention behavior (<code>channels.whatsapp.groups</code>, <code>channels.telegram.groups</code>, <code>channels.discord.guilds</code>, <code>agents.list[].groupChat</code>)</li>
<li class="">customize message prefixes (<code>messages</code>)</li>
<li class="">set the agent&#x27;s workspace (<code>agents.defaults.workspace</code> or <code>agents.list[].workspace</code>)</li>
<li class="">tune the embedded agent defaults (<code>agents.defaults</code>) and session behavior (<code>session</code>)</li>
<li class="">set per-agent identity (<code>agents.list[].identity</code>)</li>
</ul>
<blockquote>
<p><strong>New to configuration?</strong> Check out the <a class="" href="/moltbot-doc/gateway/configuration-examples">Configuration Examples</a> guide for complete examples with detailed explanations!</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="strict-config-validation">Strict config validation<a href="#strict-config-validation" class="hash-link" aria-label="Strict config validationçš„ç›´æ¥é“¾æ¥" title="Strict config validationçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>Moltbot only accepts configurations that fully match the schema.
Unknown keys, malformed types, or invalid values cause the Gateway to <strong>refuse to start</strong> for safety.</p>
<p>When validation fails:</p>
<ul>
<li class="">The Gateway does not boot.</li>
<li class="">Only diagnostic commands are allowed (for example: <code>moltbot doctor</code>, <code>moltbot logs</code>, <code>moltbot health</code>, <code>moltbot status</code>, <code>moltbot service</code>, <code>moltbot help</code>).</li>
<li class="">Run <code>moltbot doctor</code> to see the exact issues.</li>
<li class="">Run <code>moltbot doctor --fix</code> (or <code>--yes</code>) to apply migrations/repairs.</li>
</ul>
<p>Doctor never writes changes unless you explicitly opt into <code>--fix</code>/<code>--yes</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="schema--ui-hints">Schema + UI hints<a href="#schema--ui-hints" class="hash-link" aria-label="Schema + UI hintsçš„ç›´æ¥é“¾æ¥" title="Schema + UI hintsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>The Gateway exposes a JSON Schema representation of the config via <code>config.schema</code> for UI editors.
The Control UI renders a form from this schema, with a <strong>Raw JSON</strong> editor as an escape hatch.</p>
<p>Channel plugins and extensions can register schema + UI hints for their config, so channel settings
stay schema-driven across apps without hard-coded forms.</p>
<p>Hints (labels, grouping, sensitive fields) ship alongside the schema so clients can render
better forms without hard-coding config knowledge.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="apply--restart-rpc">Apply + restart (RPC)<a href="#apply--restart-rpc" class="hash-link" aria-label="Apply + restart (RPC)çš„ç›´æ¥é“¾æ¥" title="Apply + restart (RPC)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>Use <code>config.apply</code> to validate + write the full config and restart the Gateway in one step.
It writes a restart sentinel and pings the last active session after the Gateway comes back.</p>
<p>Warning: <code>config.apply</code> replaces the <strong>entire config</strong>. If you want to change only a few keys,
use <code>config.patch</code> or <code>moltbot config set</code>. Keep a backup of <code>~/.clawdbot/moltbot.json</code>.</p>
<p>Params:</p>
<ul>
<li class=""><code>raw</code> (string) â€” JSON5 payload for the entire config</li>
<li class=""><code>baseHash</code> (optional) â€” config hash from <code>config.get</code> (required when a config already exists)</li>
<li class=""><code>sessionKey</code> (optional) â€” last active session key for the wake-up ping</li>
<li class=""><code>note</code> (optional) â€” note to include in the restart sentinel</li>
<li class=""><code>restartDelayMs</code> (optional) â€” delay before restart (default 2000)</li>
</ul>
<p>Example (via <code>gateway call</code>):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">moltbot gateway call config.get --params &#x27;{}&#x27; # capture payload.hash</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">moltbot gateway call config.apply --params &#x27;{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;raw&quot;: &quot;{\\n  agents: { defaults: { workspace: \\&quot;~/clawd\\&quot; } }\\n}\\n&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;baseHash&quot;: &quot;&lt;hash-from-config.get&gt;&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;sessionKey&quot;: &quot;agent:main:whatsapp:dm:+15555550123&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;restartDelayMs&quot;: 1000</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}&#x27;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="partial-updates-rpc">Partial updates (RPC)<a href="#partial-updates-rpc" class="hash-link" aria-label="Partial updates (RPC)çš„ç›´æ¥é“¾æ¥" title="Partial updates (RPC)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>Use <code>config.patch</code> to merge a partial update into the existing config without clobbering
unrelated keys. It applies JSON merge patch semantics:</p>
<ul>
<li class="">objects merge recursively</li>
<li class=""><code>null</code> deletes a key</li>
<li class="">arrays replace
Like <code>config.apply</code>, it validates, writes the config, stores a restart sentinel, and schedules
the Gateway restart (with an optional wake when <code>sessionKey</code> is provided).</li>
</ul>
<p>Params:</p>
<ul>
<li class=""><code>raw</code> (string) â€” JSON5 payload containing just the keys to change</li>
<li class=""><code>baseHash</code> (required) â€” config hash from <code>config.get</code></li>
<li class=""><code>sessionKey</code> (optional) â€” last active session key for the wake-up ping</li>
<li class=""><code>note</code> (optional) â€” note to include in the restart sentinel</li>
<li class=""><code>restartDelayMs</code> (optional) â€” delay before restart (default 2000)</li>
</ul>
<p>Example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">moltbot gateway call config.get --params &#x27;{}&#x27; # capture payload.hash</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">moltbot gateway call config.patch --params &#x27;{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;raw&quot;: &quot;{\\n  channels: { telegram: { groups: { \\&quot;*\\&quot;: { requireMention: false } } } }\\n}\\n&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;baseHash&quot;: &quot;&lt;hash-from-config.get&gt;&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;sessionKey&quot;: &quot;agent:main:whatsapp:dm:+15555550123&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;restartDelayMs&quot;: 1000</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}&#x27;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="minimal-config-recommended-starting-point">Minimal config (recommended starting point)<a href="#minimal-config-recommended-starting-point" class="hash-link" aria-label="Minimal config (recommended starting point)çš„ç›´æ¥é“¾æ¥" title="Minimal config (recommended starting point)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { workspace: &quot;~/clawd&quot; } },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: { whatsapp: { allowFrom: [&quot;+15555550123&quot;] } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Build the default image once with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">scripts/sandbox-setup.sh</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="self-chat-mode-recommended-for-group-control">Self-chat mode (recommended for group control)<a href="#self-chat-mode-recommended-for-group-control" class="hash-link" aria-label="Self-chat mode (recommended for group control)çš„ç›´æ¥é“¾æ¥" title="Self-chat mode (recommended for group control)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>To prevent the bot from responding to WhatsApp @-mentions in groups (only respond to specific text triggers):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: { workspace: &quot;~/clawd&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;main&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        groupChat: { mentionPatterns: [&quot;@clawd&quot;, &quot;reisponde&quot;] }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Allowlist is DMs only; including your own number enables self-chat mode.</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowFrom: [&quot;+15555550123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: { &quot;*&quot;: { requireMention: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="config-includes-include">Config Includes (<code>$include</code>)<a href="#config-includes-include" class="hash-link" aria-label="config-includes-includeçš„ç›´æ¥é“¾æ¥" title="config-includes-includeçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>Split your config into multiple files using the <code>$include</code> directive. This is useful for:</p>
<ul>
<li class="">Organizing large configs (e.g., per-client agent definitions)</li>
<li class="">Sharing common settings across environments</li>
<li class="">Keeping sensitive configs separate</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="basic-usage">Basic usage<a href="#basic-usage" class="hash-link" aria-label="Basic usageçš„ç›´æ¥é“¾æ¥" title="Basic usageçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">// ~/.clawdbot/moltbot.json</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  gateway: { port: 18789 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  // Include a single file (replaces the key&#x27;s value)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { &quot;$include&quot;: &quot;./agents.json5&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  // Include multiple files (deep-merged in order)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  broadcast: { </span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    &quot;$include&quot;: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;./clients/mueller.json5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;./clients/schmidt.json5&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">// ~/.clawdbot/agents.json5</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  defaults: { sandbox: { mode: &quot;all&quot;, scope: &quot;session&quot; } },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    { id: &quot;main&quot;, workspace: &quot;~/clawd&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="merge-behavior">Merge behavior<a href="#merge-behavior" class="hash-link" aria-label="Merge behaviorçš„ç›´æ¥é“¾æ¥" title="Merge behaviorçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<ul>
<li class=""><strong>Single file</strong>: Replaces the object containing <code>$include</code></li>
<li class=""><strong>Array of files</strong>: Deep-merges files in order (later files override earlier ones)</li>
<li class=""><strong>With sibling keys</strong>: Sibling keys are merged after includes (override included values)</li>
<li class=""><strong>Sibling keys + arrays/primitives</strong>: Not supported (included content must be an object)</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">// Sibling keys override included values</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;$include&quot;: &quot;./base.json5&quot;,   // { a: 1, b: 2 }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  b: 99                          // Result: { a: 1, b: 99 }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="nested-includes">Nested includes<a href="#nested-includes" class="hash-link" aria-label="Nested includesçš„ç›´æ¥é“¾æ¥" title="Nested includesçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Included files can themselves contain <code>$include</code> directives (up to 10 levels deep):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">// clients/mueller.json5</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { &quot;$include&quot;: &quot;./mueller/agents.json5&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  broadcast: { &quot;$include&quot;: &quot;./mueller/broadcast.json5&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="path-resolution">Path resolution<a href="#path-resolution" class="hash-link" aria-label="Path resolutionçš„ç›´æ¥é“¾æ¥" title="Path resolutionçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<ul>
<li class=""><strong>Relative paths</strong>: Resolved relative to the including file</li>
<li class=""><strong>Absolute paths</strong>: Used as-is</li>
<li class=""><strong>Parent directories</strong>: <code>../</code> references work as expected</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{ &quot;$include&quot;: &quot;./sub/config.json5&quot; }      // relative</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{ &quot;$include&quot;: &quot;/etc/moltbot/base.json5&quot; } // absolute</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{ &quot;$include&quot;: &quot;../shared/common.json5&quot; }   // parent dir</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="error-handling">Error handling<a href="#error-handling" class="hash-link" aria-label="Error handlingçš„ç›´æ¥é“¾æ¥" title="Error handlingçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<ul>
<li class=""><strong>Missing file</strong>: Clear error with resolved path</li>
<li class=""><strong>Parse error</strong>: Shows which included file failed</li>
<li class=""><strong>Circular includes</strong>: Detected and reported with include chain</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-multi-client-legal-setup">Example: Multi-client legal setup<a href="#example-multi-client-legal-setup" class="hash-link" aria-label="Example: Multi-client legal setupçš„ç›´æ¥é“¾æ¥" title="Example: Multi-client legal setupçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">// ~/.clawdbot/moltbot.json</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  gateway: { port: 18789, auth: { token: &quot;secret&quot; } },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  // Common agent defaults</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      sandbox: { mode: &quot;all&quot;, scope: &quot;session&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // Merge agent lists from all clients</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: { &quot;$include&quot;: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;./clients/mueller/agents.json5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;./clients/schmidt/agents.json5&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]}</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  // Merge broadcast configs</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  broadcast: { &quot;$include&quot;: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    &quot;./clients/mueller/broadcast.json5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    &quot;./clients/schmidt/broadcast.json5&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  ]},</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  </span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: { whatsapp: { groupPolicy: &quot;allowlist&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">// ~/.clawdbot/clients/mueller/agents.json5</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">[</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  { id: &quot;mueller-transcribe&quot;, workspace: &quot;~/clients/mueller/transcribe&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  { id: &quot;mueller-docs&quot;, workspace: &quot;~/clients/mueller/docs&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">]</span><br></span></code></pre></div></div>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">// ~/.clawdbot/clients/mueller/broadcast.json5</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  &quot;120363403215116621@g.us&quot;: [&quot;mueller-transcribe&quot;, &quot;mueller-docs&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="common-options">Common options<a href="#common-options" class="hash-link" aria-label="Common optionsçš„ç›´æ¥é“¾æ¥" title="Common optionsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="env-vars--env">Env vars + <code>.env</code><a href="#env-vars--env" class="hash-link" aria-label="env-vars--envçš„ç›´æ¥é“¾æ¥" title="env-vars--envçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Moltbot reads env vars from the parent process (shell, launchd/systemd, CI, etc.).</p>
<p>Additionally, it loads:</p>
<ul>
<li class=""><code>.env</code> from the current working directory (if present)</li>
<li class="">a global fallback <code>.env</code> from <code>~/.clawdbot/.env</code> (aka <code>$CLAWDBOT_STATE_DIR/.env</code>)</li>
</ul>
<p>Neither <code>.env</code> file overrides existing env vars.</p>
<p>You can also provide inline env vars in config. These are only applied if the
process env is missing the key (same non-overriding rule):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  env: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    OPENROUTER_API_KEY: &quot;sk-or-...&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    vars: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      GROQ_API_KEY: &quot;gsk-...&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>See <a class="" href="/moltbot-doc/environment">/environment</a> for full precedence and sources.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="envshellenv-optional"><code>env.shellEnv</code> (optional)<a href="#envshellenv-optional" class="hash-link" aria-label="envshellenv-optionalçš„ç›´æ¥é“¾æ¥" title="envshellenv-optionalçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Opt-in convenience: if enabled and none of the expected keys are set yet, Moltbot runs your login shell and imports only the missing expected keys (never overrides).
This effectively sources your shell profile.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  env: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    shellEnv: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      timeoutMs: 15000</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Env var equivalent:</p>
<ul>
<li class=""><code>CLAWDBOT_LOAD_SHELL_ENV=1</code></li>
<li class=""><code>CLAWDBOT_SHELL_ENV_TIMEOUT_MS=15000</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="env-var-substitution-in-config">Env var substitution in config<a href="#env-var-substitution-in-config" class="hash-link" aria-label="Env var substitution in configçš„ç›´æ¥é“¾æ¥" title="Env var substitution in configçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>You can reference environment variables directly in any config string value using
<code>${VAR_NAME}</code> syntax. Variables are substituted at config load time, before validation.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;vercel-gateway&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;${VERCEL_GATEWAY_API_KEY}&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  gateway: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    auth: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      token: &quot;${CLAWDBOT_GATEWAY_TOKEN}&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Rules:</strong></p>
<ul>
<li class="">Only uppercase env var names are matched: <code>[A-Z_][A-Z0-9_]*</code></li>
<li class="">Missing or empty env vars throw an error at config load</li>
<li class="">Escape with <code>$${VAR}</code> to output a literal <code>${VAR}</code></li>
<li class="">Works with <code>$include</code> (included files also get substitution)</li>
</ul>
<p><strong>Inline substitution:</strong></p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      custom: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;${CUSTOM_API_BASE}/v1&quot;  // â†’ &quot;https://api.example.com/v1&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="auth-storage-oauth--api-keys">Auth storage (OAuth + API keys)<a href="#auth-storage-oauth--api-keys" class="hash-link" aria-label="Auth storage (OAuth + API keys)çš„ç›´æ¥é“¾æ¥" title="Auth storage (OAuth + API keys)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Moltbot stores <strong>per-agent</strong> auth profiles (OAuth + API keys) in:</p>
<ul>
<li class=""><code>&lt;agentDir&gt;/auth-profiles.json</code> (default: <code>~/.clawdbot/agents/&lt;agentId&gt;/agent/auth-profiles.json</code>)</li>
</ul>
<p>See also: <a class="" href="/moltbot-doc/concepts/oauth">/concepts/oauth</a></p>
<p>Legacy OAuth imports:</p>
<ul>
<li class=""><code>~/.clawdbot/credentials/oauth.json</code> (or <code>$CLAWDBOT_STATE_DIR/credentials/oauth.json</code>)</li>
</ul>
<p>The embedded Pi agent maintains a runtime cache at:</p>
<ul>
<li class=""><code>&lt;agentDir&gt;/auth.json</code> (managed automatically; donâ€™t edit manually)</li>
</ul>
<p>Legacy agent dir (pre multi-agent):</p>
<ul>
<li class=""><code>~/.clawdbot/agent/*</code> (migrated by <code>moltbot doctor</code> into <code>~/.clawdbot/agents/&lt;defaultAgentId&gt;/agent/*</code>)</li>
</ul>
<p>Overrides:</p>
<ul>
<li class="">OAuth dir (legacy import only): <code>CLAWDBOT_OAUTH_DIR</code></li>
<li class="">Agent dir (default agent root override): <code>CLAWDBOT_AGENT_DIR</code> (preferred), <code>PI_CODING_AGENT_DIR</code> (legacy)</li>
</ul>
<p>On first use, Moltbot imports <code>oauth.json</code> entries into <code>auth-profiles.json</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="auth"><code>auth</code><a href="#auth" class="hash-link" aria-label="authçš„ç›´æ¥é“¾æ¥" title="authçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Optional metadata for auth profiles. This does <strong>not</strong> store secrets; it maps
profile IDs to a provider + mode (and optional email) and defines the provider
rotation order used for failover.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  auth: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    profiles: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;anthropic:me@example.com&quot;: { provider: &quot;anthropic&quot;, mode: &quot;oauth&quot;, email: &quot;me@example.com&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;anthropic:work&quot;: { provider: &quot;anthropic&quot;, mode: &quot;api_key&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    order: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      anthropic: [&quot;anthropic:me@example.com&quot;, &quot;anthropic:work&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentslistidentity"><code>agents.list[].identity</code><a href="#agentslistidentity" class="hash-link" aria-label="agentslistidentityçš„ç›´æ¥é“¾æ¥" title="agentslistidentityçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Optional per-agent identity used for defaults and UX. This is written by the macOS onboarding assistant.</p>
<p>If set, Moltbot derives defaults (only when you havenâ€™t set them explicitly):</p>
<ul>
<li class=""><code>messages.ackReaction</code> from the <strong>active agent</strong>â€™s <code>identity.emoji</code> (falls back to ğŸ‘€)</li>
<li class=""><code>agents.list[].groupChat.mentionPatterns</code> from the agentâ€™s <code>identity.name</code>/<code>identity.emoji</code> (so â€œ@Samanthaâ€ works in groups across Telegram/Slack/Discord/Google Chat/iMessage/WhatsApp)</li>
<li class=""><code>identity.avatar</code> accepts a workspace-relative image path or a remote URL/data URL. Local files must live inside the agent workspace.</li>
</ul>
<p><code>identity.avatar</code> accepts:</p>
<ul>
<li class="">Workspace-relative path (must stay within the agent workspace)</li>
<li class=""><code>http(s)</code> URL</li>
<li class=""><code>data:</code> URI</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;main&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        identity: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          name: &quot;Samantha&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          theme: &quot;helpful sloth&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          emoji: &quot;ğŸ¦¥&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          avatar: &quot;avatars/samantha.png&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="wizard"><code>wizard</code><a href="#wizard" class="hash-link" aria-label="wizardçš„ç›´æ¥é“¾æ¥" title="wizardçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Metadata written by CLI wizards (<code>onboard</code>, <code>configure</code>, <code>doctor</code>).</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  wizard: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    lastRunAt: &quot;2026-01-01T00:00:00.000Z&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    lastRunVersion: &quot;2026.1.4&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    lastRunCommit: &quot;abc1234&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    lastRunCommand: &quot;configure&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    lastRunMode: &quot;local&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="logging"><code>logging</code><a href="#logging" class="hash-link" aria-label="loggingçš„ç›´æ¥é“¾æ¥" title="loggingçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<ul>
<li class="">Default log file: <code>/tmp/moltbot/moltbot-YYYY-MM-DD.log</code></li>
<li class="">If you want a stable path, set <code>logging.file</code> to <code>/tmp/moltbot/moltbot.log</code>.</li>
<li class="">Console output can be tuned separately via:
<ul>
<li class=""><code>logging.consoleLevel</code> (defaults to <code>info</code>, bumps to <code>debug</code> when <code>--verbose</code>)</li>
<li class=""><code>logging.consoleStyle</code> (<code>pretty</code> | <code>compact</code> | <code>json</code>)</li>
</ul>
</li>
<li class="">Tool summaries can be redacted to avoid leaking secrets:
<ul>
<li class=""><code>logging.redactSensitive</code> (<code>off</code> | <code>tools</code>, default: <code>tools</code>)</li>
<li class=""><code>logging.redactPatterns</code> (array of regex strings; overrides defaults)</li>
</ul>
</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  logging: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    level: &quot;info&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    file: &quot;/tmp/moltbot/moltbot.log&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    consoleLevel: &quot;info&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    consoleStyle: &quot;pretty&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    redactSensitive: &quot;tools&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    redactPatterns: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Example: override defaults with your own rules.</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;\\bTOKEN\\b\\s*[=:]\\s*([\&quot;&#x27;]?)([^\\s\&quot;&#x27;]+)\\1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;/\\bsk-[A-Za-z0-9_-]{8,}\\b/gi&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelswhatsappdmpolicy"><code>channels.whatsapp.dmPolicy</code><a href="#channelswhatsappdmpolicy" class="hash-link" aria-label="channelswhatsappdmpolicyçš„ç›´æ¥é“¾æ¥" title="channelswhatsappdmpolicyçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls how WhatsApp direct chats (DMs) are handled:</p>
<ul>
<li class=""><code>&quot;pairing&quot;</code> (default): unknown senders get a pairing code; owner must approve</li>
<li class=""><code>&quot;allowlist&quot;</code>: only allow senders in <code>channels.whatsapp.allowFrom</code> (or paired allow store)</li>
<li class=""><code>&quot;open&quot;</code>: allow all inbound DMs (<strong>requires</strong> <code>channels.whatsapp.allowFrom</code> to include <code>&quot;*&quot;</code>)</li>
<li class=""><code>&quot;disabled&quot;</code>: ignore all inbound DMs</li>
</ul>
<p>Pairing codes expire after 1 hour; the bot only sends a pairing code when a new request is created. Pending DM pairing requests are capped at <strong>3 per channel</strong> by default.</p>
<p>Pairing approvals:</p>
<ul>
<li class=""><code>moltbot pairing list whatsapp</code></li>
<li class=""><code>moltbot pairing approve whatsapp &lt;code&gt;</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelswhatsappallowfrom"><code>channels.whatsapp.allowFrom</code><a href="#channelswhatsappallowfrom" class="hash-link" aria-label="channelswhatsappallowfromçš„ç›´æ¥é“¾æ¥" title="channelswhatsappallowfromçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Allowlist of E.164 phone numbers that may trigger WhatsApp auto-replies (<strong>DMs only</strong>).
If empty and <code>channels.whatsapp.dmPolicy=&quot;pairing&quot;</code>, unknown senders will receive a pairing code.
For groups, use <code>channels.whatsapp.groupPolicy</code> + <code>channels.whatsapp.groupAllowFrom</code>.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dmPolicy: &quot;pairing&quot;, // pairing | allowlist | open | disabled</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowFrom: [&quot;+15555550123&quot;, &quot;+447700900123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      textChunkLimit: 4000, // optional outbound chunk size (chars)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      chunkMode: &quot;length&quot;, // optional chunking mode (length | newline)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mediaMaxMb: 50 // optional inbound media cap (MB)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelswhatsappsendreadreceipts"><code>channels.whatsapp.sendReadReceipts</code><a href="#channelswhatsappsendreadreceipts" class="hash-link" aria-label="channelswhatsappsendreadreceiptsçš„ç›´æ¥é“¾æ¥" title="channelswhatsappsendreadreceiptsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls whether inbound WhatsApp messages are marked as read (blue ticks). Default: <code>true</code>.</p>
<p>Self-chat mode always skips read receipts, even when enabled.</p>
<p>Per-account override: <code>channels.whatsapp.accounts.&lt;id&gt;.sendReadReceipts</code>.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: { sendReadReceipts: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelswhatsappaccounts-multi-account"><code>channels.whatsapp.accounts</code> (multi-account)<a href="#channelswhatsappaccounts-multi-account" class="hash-link" aria-label="channelswhatsappaccounts-multi-accountçš„ç›´æ¥é“¾æ¥" title="channelswhatsappaccounts-multi-accountçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Run multiple WhatsApp accounts in one gateway:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      accounts: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        default: {}, // optional; keeps the default id stable</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        personal: {},</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        biz: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          // Optional override. Default: ~/.clawdbot/credentials/whatsapp/biz</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          // authDir: &quot;~/.clawdbot/credentials/whatsapp/biz&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Outbound commands default to account <code>default</code> if present; otherwise the first configured account id (sorted).</li>
<li class="">The legacy single-account Baileys auth dir is migrated by <code>moltbot doctor</code> into <code>whatsapp/default</code>.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelstelegramaccounts--channelsdiscordaccounts--channelsgooglechataccounts--channelsslackaccounts--channelsmattermostaccounts--channelssignalaccounts--channelsimessageaccounts"><code>channels.telegram.accounts</code> / <code>channels.discord.accounts</code> / <code>channels.googlechat.accounts</code> / <code>channels.slack.accounts</code> / <code>channels.mattermost.accounts</code> / <code>channels.signal.accounts</code> / <code>channels.imessage.accounts</code><a href="#channelstelegramaccounts--channelsdiscordaccounts--channelsgooglechataccounts--channelsslackaccounts--channelsmattermostaccounts--channelssignalaccounts--channelsimessageaccounts" class="hash-link" aria-label="channelstelegramaccounts--channelsdiscordaccounts--channelsgooglechataccounts--channelsslackaccounts--channelsmattermostaccounts--channelssignalaccounts--channelsimessageaccountsçš„ç›´æ¥é“¾æ¥" title="channelstelegramaccounts--channelsdiscordaccounts--channelsgooglechataccounts--channelsslackaccounts--channelsmattermostaccounts--channelssignalaccounts--channelsimessageaccountsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Run multiple accounts per channel (each account has its own <code>accountId</code> and optional <code>name</code>):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    telegram: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      accounts: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        default: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          name: &quot;Primary bot&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          botToken: &quot;123456:ABC...&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        alerts: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          name: &quot;Alerts bot&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          botToken: &quot;987654:XYZ...&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class=""><code>default</code> is used when <code>accountId</code> is omitted (CLI + routing).</li>
<li class="">Env tokens only apply to the <strong>default</strong> account.</li>
<li class="">Base channel settings (group policy, mention gating, etc.) apply to all accounts unless overridden per account.</li>
<li class="">Use <code>bindings[].match.accountId</code> to route each account to a different agents.defaults.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="group-chat-mention-gating-agentslistgroupchat--messagesgroupchat">Group chat mention gating (<code>agents.list[].groupChat</code> + <code>messages.groupChat</code>)<a href="#group-chat-mention-gating-agentslistgroupchat--messagesgroupchat" class="hash-link" aria-label="group-chat-mention-gating-agentslistgroupchat--messagesgroupchatçš„ç›´æ¥é“¾æ¥" title="group-chat-mention-gating-agentslistgroupchat--messagesgroupchatçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Group messages default to <strong>require mention</strong> (either metadata mention or regex patterns). Applies to WhatsApp, Telegram, Discord, Google Chat, and iMessage group chats.</p>
<p><strong>Mention types:</strong></p>
<ul>
<li class=""><strong>Metadata mentions</strong>: Native platform @-mentions (e.g., WhatsApp tap-to-mention). Ignored in WhatsApp self-chat mode (see <code>channels.whatsapp.allowFrom</code>).</li>
<li class=""><strong>Text patterns</strong>: Regex patterns defined in <code>agents.list[].groupChat.mentionPatterns</code>. Always checked regardless of self-chat mode.</li>
<li class="">Mention gating is enforced only when mention detection is possible (native mentions or at least one <code>mentionPattern</code>).</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  messages: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    groupChat: { historyLimit: 50 }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      { id: &quot;main&quot;, groupChat: { mentionPatterns: [&quot;@clawd&quot;, &quot;moltbot&quot;, &quot;clawd&quot;] } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>messages.groupChat.historyLimit</code> sets the global default for group history context. Channels can override with <code>channels.&lt;channel&gt;.historyLimit</code> (or <code>channels.&lt;channel&gt;.accounts.*.historyLimit</code> for multi-account). Set <code>0</code> to disable history wrapping.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="dm-history-limits">DM history limits<a href="#dm-history-limits" class="hash-link" aria-label="DM history limitsçš„ç›´æ¥é“¾æ¥" title="DM history limitsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>DM conversations use session-based history managed by the agent. You can limit the number of user turns retained per DM session:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    telegram: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dmHistoryLimit: 30,  // limit DM sessions to 30 user turns</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dms: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;123456789&quot;: { historyLimit: 50 }  // per-user override (user ID)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Resolution order:</p>
<ol>
<li class="">Per-DM override: <code>channels.&lt;provider&gt;.dms[userId].historyLimit</code></li>
<li class="">Provider default: <code>channels.&lt;provider&gt;.dmHistoryLimit</code></li>
<li class="">No limit (all history retained)</li>
</ol>
<p>Supported providers: <code>telegram</code>, <code>whatsapp</code>, <code>discord</code>, <code>slack</code>, <code>signal</code>, <code>imessage</code>, <code>msteams</code>.</p>
<p>Per-agent override (takes precedence when set, even <code>[]</code>):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      { id: &quot;work&quot;, groupChat: { mentionPatterns: [&quot;@workbot&quot;, &quot;\\+15555550123&quot;] } },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      { id: &quot;personal&quot;, groupChat: { mentionPatterns: [&quot;@homebot&quot;, &quot;\\+15555550999&quot;] } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Mention gating defaults live per channel (<code>channels.whatsapp.groups</code>, <code>channels.telegram.groups</code>, <code>channels.imessage.groups</code>, <code>channels.discord.guilds</code>). When <code>*.groups</code> is set, it also acts as a group allowlist; include <code>&quot;*&quot;</code> to allow all groups.</p>
<p>To respond <strong>only</strong> to specific text triggers (ignoring native @-mentions):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Include your own number to enable self-chat mode (ignore native @-mentions).</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowFrom: [&quot;+15555550123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: { &quot;*&quot;: { requireMention: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;main&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        groupChat: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          // Only these text patterns will trigger responses</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          mentionPatterns: [&quot;reisponde&quot;, &quot;@clawd&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="group-policy-per-channel">Group policy (per channel)<a href="#group-policy-per-channel" class="hash-link" aria-label="Group policy (per channel)çš„ç›´æ¥é“¾æ¥" title="Group policy (per channel)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Use <code>channels.*.groupPolicy</code> to control whether group/room messages are accepted at all:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;+15551234567&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    telegram: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;tg:123456789&quot;, &quot;@alice&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    signal: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;+15551234567&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    imessage: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;chat_id:123&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    msteams: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupAllowFrom: [&quot;user@org.com&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    discord: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      guilds: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;GUILD_ID&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          channels: { help: { allow: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    slack: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      channels: { &quot;#general&quot;: { allow: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class=""><code>&quot;open&quot;</code>: groups bypass allowlists; mention-gating still applies.</li>
<li class=""><code>&quot;disabled&quot;</code>: block all group/room messages.</li>
<li class=""><code>&quot;allowlist&quot;</code>: only allow groups/rooms that match the configured allowlist.</li>
<li class=""><code>channels.defaults.groupPolicy</code> sets the default when a providerâ€™s <code>groupPolicy</code> is unset.</li>
<li class="">WhatsApp/Telegram/Signal/iMessage/Microsoft Teams use <code>groupAllowFrom</code> (fallback: explicit <code>allowFrom</code>).</li>
<li class="">Discord/Slack use channel allowlists (<code>channels.discord.guilds.*.channels</code>, <code>channels.slack.channels</code>).</li>
<li class="">Group DMs (Discord/Slack) are still controlled by <code>dm.groupEnabled</code> + <code>dm.groupChannels</code>.</li>
<li class="">Default is <code>groupPolicy: &quot;allowlist&quot;</code> (unless overridden by <code>channels.defaults.groupPolicy</code>); if no allowlist is configured, group messages are blocked.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="multi-agent-routing-agentslist--bindings">Multi-agent routing (<code>agents.list</code> + <code>bindings</code>)<a href="#multi-agent-routing-agentslist--bindings" class="hash-link" aria-label="multi-agent-routing-agentslist--bindingsçš„ç›´æ¥é“¾æ¥" title="multi-agent-routing-agentslist--bindingsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Run multiple isolated agents (separate workspace, <code>agentDir</code>, sessions) inside one Gateway.
Inbound messages are routed to an agent via bindings.</p>
<ul>
<li class=""><code>agents.list[]</code>: per-agent overrides.
<ul>
<li class=""><code>id</code>: stable agent id (required).</li>
<li class=""><code>default</code>: optional; when multiple are set, the first wins and a warning is logged.
If none are set, the <strong>first entry</strong> in the list is the default agent.</li>
<li class=""><code>name</code>: display name for the agent.</li>
<li class=""><code>workspace</code>: default <code>~/clawd-&lt;agentId&gt;</code> (for <code>main</code>, falls back to <code>agents.defaults.workspace</code>).</li>
<li class=""><code>agentDir</code>: default <code>~/.clawdbot/agents/&lt;agentId&gt;/agent</code>.</li>
<li class=""><code>model</code>: per-agent default model, overrides <code>agents.defaults.model</code> for that agent.
<ul>
<li class="">string form: <code>&quot;provider/model&quot;</code>, overrides only <code>agents.defaults.model.primary</code></li>
<li class="">object form: <code>{ primary, fallbacks }</code> (fallbacks override <code>agents.defaults.model.fallbacks</code>; <code>[]</code> disables global fallbacks for that agent)</li>
</ul>
</li>
<li class=""><code>identity</code>: per-agent name/theme/emoji (used for mention patterns + ack reactions).</li>
<li class=""><code>groupChat</code>: per-agent mention-gating (<code>mentionPatterns</code>).</li>
<li class=""><code>sandbox</code>: per-agent sandbox config (overrides <code>agents.defaults.sandbox</code>).
<ul>
<li class=""><code>mode</code>: <code>&quot;off&quot;</code> | <code>&quot;non-main&quot;</code> | <code>&quot;all&quot;</code></li>
<li class=""><code>workspaceAccess</code>: <code>&quot;none&quot;</code> | <code>&quot;ro&quot;</code> | <code>&quot;rw&quot;</code></li>
<li class=""><code>scope</code>: <code>&quot;session&quot;</code> | <code>&quot;agent&quot;</code> | <code>&quot;shared&quot;</code></li>
<li class=""><code>workspaceRoot</code>: custom sandbox workspace root</li>
<li class=""><code>docker</code>: per-agent docker overrides (e.g. <code>image</code>, <code>network</code>, <code>env</code>, <code>setupCommand</code>, limits; ignored when <code>scope: &quot;shared&quot;</code>)</li>
<li class=""><code>browser</code>: per-agent sandboxed browser overrides (ignored when <code>scope: &quot;shared&quot;</code>)</li>
<li class=""><code>prune</code>: per-agent sandbox pruning overrides (ignored when <code>scope: &quot;shared&quot;</code>)</li>
</ul>
</li>
<li class=""><code>subagents</code>: per-agent sub-agent defaults.
<ul>
<li class=""><code>allowAgents</code>: allowlist of agent ids for <code>sessions_spawn</code> from this agent (<code>[&quot;*&quot;]</code> = allow any; default: only same agent)</li>
</ul>
</li>
<li class=""><code>tools</code>: per-agent tool restrictions (applied before sandbox tool policy).
<ul>
<li class=""><code>profile</code>: base tool profile (applied before allow/deny)</li>
<li class=""><code>allow</code>: array of allowed tool names</li>
<li class=""><code>deny</code>: array of denied tool names (deny wins)</li>
</ul>
</li>
</ul>
</li>
<li class=""><code>agents.defaults</code>: shared agent defaults (model, workspace, sandbox, etc.).</li>
<li class=""><code>bindings[]</code>: routes inbound messages to an <code>agentId</code>.
<ul>
<li class=""><code>match.channel</code> (required)</li>
<li class=""><code>match.accountId</code> (optional; <code>*</code> = any account; omitted = default account)</li>
<li class=""><code>match.peer</code> (optional; <code>{ kind: dm|group|channel, id }</code>)</li>
<li class=""><code>match.guildId</code> / <code>match.teamId</code> (optional; channel-specific)</li>
</ul>
</li>
</ul>
<p>Deterministic match order:</p>
<ol>
<li class=""><code>match.peer</code></li>
<li class=""><code>match.guildId</code></li>
<li class=""><code>match.teamId</code></li>
<li class=""><code>match.accountId</code> (exact, no peer/guild/team)</li>
<li class=""><code>match.accountId: &quot;*&quot;</code> (channel-wide, no peer/guild/team)</li>
<li class="">default agent (<code>agents.list[].default</code>, else first list entry, else <code>&quot;main&quot;</code>)</li>
</ol>
<p>Within each match tier, the first matching entry in <code>bindings</code> wins.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="per-agent-access-profiles-multi-agent">Per-agent access profiles (multi-agent)<a href="#per-agent-access-profiles-multi-agent" class="hash-link" aria-label="Per-agent access profiles (multi-agent)çš„ç›´æ¥é“¾æ¥" title="Per-agent access profiles (multi-agent)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>Each agent can carry its own sandbox + tool policy. Use this to mix access
levels in one gateway:</p>
<ul>
<li class=""><strong>Full access</strong> (personal agent)</li>
<li class=""><strong>Read-only</strong> tools + workspace</li>
<li class=""><strong>No filesystem access</strong> (messaging/session tools only)</li>
</ul>
<p>See <a class="" href="/moltbot-doc/multi-agent-sandbox-tools">Multi-Agent Sandbox &amp; Tools</a> for precedence and
additional examples.</p>
<p>Full access (no sandbox):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;personal&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        workspace: &quot;~/clawd-personal&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        sandbox: { mode: &quot;off&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Read-only tools + read-only workspace:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;family&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        workspace: &quot;~/clawd-family&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        sandbox: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          mode: &quot;all&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          scope: &quot;agent&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          workspaceAccess: &quot;ro&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allow: [&quot;read&quot;, &quot;sessions_list&quot;, &quot;sessions_history&quot;, &quot;sessions_send&quot;, &quot;sessions_spawn&quot;, &quot;session_status&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          deny: [&quot;write&quot;, &quot;edit&quot;, &quot;apply_patch&quot;, &quot;exec&quot;, &quot;process&quot;, &quot;browser&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>No filesystem access (messaging/session tools enabled):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;public&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        workspace: &quot;~/clawd-public&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        sandbox: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          mode: &quot;all&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          scope: &quot;agent&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          workspaceAccess: &quot;none&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allow: [&quot;sessions_list&quot;, &quot;sessions_history&quot;, &quot;sessions_send&quot;, &quot;sessions_spawn&quot;, &quot;session_status&quot;, &quot;whatsapp&quot;, &quot;telegram&quot;, &quot;slack&quot;, &quot;discord&quot;, &quot;gateway&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          deny: [&quot;read&quot;, &quot;write&quot;, &quot;edit&quot;, &quot;apply_patch&quot;, &quot;exec&quot;, &quot;process&quot;, &quot;browser&quot;, &quot;canvas&quot;, &quot;nodes&quot;, &quot;cron&quot;, &quot;gateway&quot;, &quot;image&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Example: two WhatsApp accounts â†’ two agents:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      { id: &quot;home&quot;, default: true, workspace: &quot;~/clawd-home&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      { id: &quot;work&quot;, workspace: &quot;~/clawd-work&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  bindings: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    { agentId: &quot;home&quot;, match: { channel: &quot;whatsapp&quot;, accountId: &quot;personal&quot; } },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    { agentId: &quot;work&quot;, match: { channel: &quot;whatsapp&quot;, accountId: &quot;biz&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    whatsapp: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      accounts: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        personal: {},</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        biz: {},</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="toolsagenttoagent-optional"><code>tools.agentToAgent</code> (optional)<a href="#toolsagenttoagent-optional" class="hash-link" aria-label="toolsagenttoagent-optionalçš„ç›´æ¥é“¾æ¥" title="toolsagenttoagent-optionalçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Agent-to-agent messaging is opt-in:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    agentToAgent: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allow: [&quot;home&quot;, &quot;work&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="messagesqueue"><code>messages.queue</code><a href="#messagesqueue" class="hash-link" aria-label="messagesqueueçš„ç›´æ¥é“¾æ¥" title="messagesqueueçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls how inbound messages behave when an agent run is already active.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  messages: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    queue: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mode: &quot;collect&quot;, // steer | followup | collect | steer-backlog (steer+backlog ok) | interrupt (queue=steer legacy)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      debounceMs: 1000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      cap: 20,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      drop: &quot;summarize&quot;, // old | new | summarize</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      byChannel: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        whatsapp: &quot;collect&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        telegram: &quot;collect&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        discord: &quot;collect&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        imessage: &quot;collect&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        webchat: &quot;collect&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="messagesinbound"><code>messages.inbound</code><a href="#messagesinbound" class="hash-link" aria-label="messagesinboundçš„ç›´æ¥é“¾æ¥" title="messagesinboundçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Debounce rapid inbound messages from the <strong>same sender</strong> so multiple back-to-back
messages become a single agent turn. Debouncing is scoped per channel + conversation
and uses the most recent message for reply threading/IDs.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  messages: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    inbound: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      debounceMs: 2000, // 0 disables</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      byChannel: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        whatsapp: 5000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        slack: 1500,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        discord: 1500</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Debounce batches <strong>text-only</strong> messages; media/attachments flush immediately.</li>
<li class="">Control commands (e.g. <code>/queue</code>, <code>/new</code>) bypass debouncing so they stay standalone.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="commands-chat-command-handling"><code>commands</code> (chat command handling)<a href="#commands-chat-command-handling" class="hash-link" aria-label="commands-chat-command-handlingçš„ç›´æ¥é“¾æ¥" title="commands-chat-command-handlingçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls how chat commands are enabled across connectors.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  commands: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    native: &quot;auto&quot;,         // register native commands when supported (auto)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    text: true,             // parse slash commands in chat messages</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    bash: false,            // allow ! (alias: /bash) (host-only; requires tools.elevated allowlists)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    bashForegroundMs: 2000, // bash foreground window (0 backgrounds immediately)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    config: false,          // allow /config (writes to disk)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    debug: false,           // allow /debug (runtime-only overrides)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    restart: false,         // allow /restart + gateway restart tool</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    useAccessGroups: true   // enforce access-group allowlists/policies for commands</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Text commands must be sent as a <strong>standalone</strong> message and use the leading <code>/</code> (no plain-text aliases).</li>
<li class=""><code>commands.text: false</code> disables parsing chat messages for commands.</li>
<li class=""><code>commands.native: &quot;auto&quot;</code> (default) turns on native commands for Discord/Telegram and leaves Slack off; unsupported channels stay text-only.</li>
<li class="">Set <code>commands.native: true|false</code> to force all, or override per channel with <code>channels.discord.commands.native</code>, <code>channels.telegram.commands.native</code>, <code>channels.slack.commands.native</code> (bool or <code>&quot;auto&quot;</code>). <code>false</code> clears previously registered commands on Discord/Telegram at startup; Slack commands are managed in the Slack app.</li>
<li class=""><code>channels.telegram.customCommands</code> adds extra Telegram bot menu entries. Names are normalized; conflicts with native commands are ignored.</li>
<li class=""><code>commands.bash: true</code> enables <code>! &lt;cmd&gt;</code> to run host shell commands (<code>/bash &lt;cmd&gt;</code> also works as an alias). Requires <code>tools.elevated.enabled</code> and allowlisting the sender in <code>tools.elevated.allowFrom.&lt;channel&gt;</code>.</li>
<li class=""><code>commands.bashForegroundMs</code> controls how long bash waits before backgrounding. While a bash job is running, new <code>! &lt;cmd&gt;</code> requests are rejected (one at a time).</li>
<li class=""><code>commands.config: true</code> enables <code>/config</code> (reads/writes <code>moltbot.json</code>).</li>
<li class=""><code>channels.&lt;provider&gt;.configWrites</code> gates config mutations initiated by that channel (default: true). This applies to <code>/config set|unset</code> plus provider-specific auto-migrations (Telegram supergroup ID changes, Slack channel ID changes).</li>
<li class=""><code>commands.debug: true</code> enables <code>/debug</code> (runtime-only overrides).</li>
<li class=""><code>commands.restart: true</code> enables <code>/restart</code> and the gateway tool restart action.</li>
<li class=""><code>commands.useAccessGroups: false</code> allows commands to bypass access-group allowlists/policies.</li>
<li class="">Slash commands and directives are only honored for <strong>authorized senders</strong>. Authorization is derived from
channel allowlists/pairing plus <code>commands.useAccessGroups</code>.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="web-whatsapp-web-channel-runtime"><code>web</code> (WhatsApp web channel runtime)<a href="#web-whatsapp-web-channel-runtime" class="hash-link" aria-label="web-whatsapp-web-channel-runtimeçš„ç›´æ¥é“¾æ¥" title="web-whatsapp-web-channel-runtimeçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>WhatsApp runs through the gatewayâ€™s web channel (Baileys Web). It starts automatically when a linked session exists.
Set <code>web.enabled: false</code> to keep it off by default.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  web: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    heartbeatSeconds: 60,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    reconnect: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      initialMs: 2000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      maxMs: 120000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      factor: 1.4,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      jitter: 0.2,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      maxAttempts: 0</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelstelegram-bot-transport"><code>channels.telegram</code> (bot transport)<a href="#channelstelegram-bot-transport" class="hash-link" aria-label="channelstelegram-bot-transportçš„ç›´æ¥é“¾æ¥" title="channelstelegram-bot-transportçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Moltbot starts Telegram only when a <code>channels.telegram</code> config section exists. The bot token is resolved from <code>channels.telegram.botToken</code> (or <code>channels.telegram.tokenFile</code>), with <code>TELEGRAM_BOT_TOKEN</code> as a fallback for the default account.
Set <code>channels.telegram.enabled: false</code> to disable automatic startup.
Multi-account support lives under <code>channels.telegram.accounts</code> (see the multi-account section above). Env tokens only apply to the default account.
Set <code>channels.telegram.configWrites: false</code> to block Telegram-initiated config writes (including supergroup ID migrations and <code>/config set|unset</code>).</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    telegram: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      botToken: &quot;your-bot-token&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dmPolicy: &quot;pairing&quot;,                 // pairing | allowlist | open | disabled</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowFrom: [&quot;tg:123456789&quot;],         // optional; &quot;open&quot; requires [&quot;*&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;*&quot;: { requireMention: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;-1001234567890&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allowFrom: [&quot;@admin&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          systemPrompt: &quot;Keep answers brief.&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          topics: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            &quot;99&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              requireMention: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              skills: [&quot;search&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              systemPrompt: &quot;Stay on topic.&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      customCommands: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        { command: &quot;backup&quot;, description: &quot;Git backup&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        { command: &quot;generate&quot;, description: &quot;Create an image&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      historyLimit: 50,                     // include last N group messages as context (0 disables)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      replyToMode: &quot;first&quot;,                 // off | first | all</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      linkPreview: true,                   // toggle outbound link previews</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      streamMode: &quot;partial&quot;,               // off | partial | block (draft streaming; separate from block streaming)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      draftChunk: {                        // optional; only for streamMode=block</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        minChars: 200,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        maxChars: 800,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        breakPreference: &quot;paragraph&quot;       // paragraph | newline | sentence</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      actions: { reactions: true, sendMessage: true }, // tool action gates (false disables)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      reactionNotifications: &quot;own&quot;,   // off | own | all</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mediaMaxMb: 5,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      retry: {                             // outbound retry policy</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        attempts: 3,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        minDelayMs: 400,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        maxDelayMs: 30000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        jitter: 0.1</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      network: {                           // transport overrides</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        autoSelectFamily: false</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      proxy: &quot;socks5://localhost:9050&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      webhookUrl: &quot;https://example.com/telegram-webhook&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      webhookSecret: &quot;secret&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      webhookPath: &quot;/telegram-webhook&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Draft streaming notes:</p>
<ul>
<li class="">Uses Telegram <code>sendMessageDraft</code> (draft bubble, not a real message).</li>
<li class="">Requires <strong>private chat topics</strong> (message_thread_id in DMs; bot has topics enabled).</li>
<li class=""><code>/reasoning stream</code> streams reasoning into the draft, then sends the final answer.
Retry policy defaults and behavior are documented in <a class="" href="/moltbot-doc/concepts/retry">Retry policy</a>.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelsdiscord-bot-transport"><code>channels.discord</code> (bot transport)<a href="#channelsdiscord-bot-transport" class="hash-link" aria-label="channelsdiscord-bot-transportçš„ç›´æ¥é“¾æ¥" title="channelsdiscord-bot-transportçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Configure the Discord bot by setting the bot token and optional gating:
Multi-account support lives under <code>channels.discord.accounts</code> (see the multi-account section above). Env tokens only apply to the default account.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    discord: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      token: &quot;your-bot-token&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mediaMaxMb: 8,                          // clamp inbound media size</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowBots: false,                       // allow bot-authored messages</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      actions: {                              // tool action gates (false disables)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        reactions: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        stickers: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        polls: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        permissions: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        messages: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        threads: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        pins: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        search: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        memberInfo: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        roleInfo: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        roles: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        channelInfo: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        voiceStatus: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        events: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        moderation: false</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      replyToMode: &quot;off&quot;,                     // off | first | all</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dm: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true,                        // disable all DMs when false</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        policy: &quot;pairing&quot;,                    // pairing | allowlist | open | disabled</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        allowFrom: [&quot;1234567890&quot;, &quot;steipete&quot;], // optional DM allowlist (&quot;open&quot; requires [&quot;*&quot;])</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        groupEnabled: false,                 // enable group DMs</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        groupChannels: [&quot;clawd-dm&quot;]          // optional group DM allowlist</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      guilds: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;123456789012345678&quot;: {               // guild id (preferred) or slug</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          slug: &quot;friends-of-clawd&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          requireMention: false,              // per-guild default</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          reactionNotifications: &quot;own&quot;,       // off | own | all | allowlist</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          users: [&quot;987654321098765432&quot;],      // optional per-guild user allowlist</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            general: { allow: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            help: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              allow: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              requireMention: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              users: [&quot;987654321098765432&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              skills: [&quot;docs&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              systemPrompt: &quot;Short answers only.&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      historyLimit: 20,                       // include last N guild messages as context</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      textChunkLimit: 2000,                   // optional outbound text chunk size (chars)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      chunkMode: &quot;length&quot;,                    // optional chunking mode (length | newline)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      maxLinesPerMessage: 17,                 // soft max lines per message (Discord UI clipping)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      retry: {                                // outbound retry policy</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        attempts: 3,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        minDelayMs: 500,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        maxDelayMs: 30000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        jitter: 0.1</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Moltbot starts Discord only when a <code>channels.discord</code> config section exists. The token is resolved from <code>channels.discord.token</code>, with <code>DISCORD_BOT_TOKEN</code> as a fallback for the default account (unless <code>channels.discord.enabled</code> is <code>false</code>). Use <code>user:&lt;id&gt;</code> (DM) or <code>channel:&lt;id&gt;</code> (guild channel) when specifying delivery targets for cron/CLI commands; bare numeric IDs are ambiguous and rejected.
Guild slugs are lowercase with spaces replaced by <code>-</code>; channel keys use the slugged channel name (no leading <code>#</code>). Prefer guild ids as keys to avoid rename ambiguity.
Bot-authored messages are ignored by default. Enable with <code>channels.discord.allowBots</code> (own messages are still filtered to prevent self-reply loops).
Reaction notification modes:</p>
<ul>
<li class=""><code>off</code>: no reaction events.</li>
<li class=""><code>own</code>: reactions on the bot&#x27;s own messages (default).</li>
<li class=""><code>all</code>: all reactions on all messages.</li>
<li class=""><code>allowlist</code>: reactions from <code>guilds.&lt;id&gt;.users</code> on all messages (empty list disables).
Outbound text is chunked by <code>channels.discord.textChunkLimit</code> (default 2000). Set <code>channels.discord.chunkMode=&quot;newline&quot;</code> to split on blank lines (paragraph boundaries) before length chunking. Discord clients can clip very tall messages, so <code>channels.discord.maxLinesPerMessage</code> (default 17) splits long multi-line replies even when under 2000 chars.
Retry policy defaults and behavior are documented in <a class="" href="/moltbot-doc/concepts/retry">Retry policy</a>.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelsgooglechat-chat-api-webhook"><code>channels.googlechat</code> (Chat API webhook)<a href="#channelsgooglechat-chat-api-webhook" class="hash-link" aria-label="channelsgooglechat-chat-api-webhookçš„ç›´æ¥é“¾æ¥" title="channelsgooglechat-chat-api-webhookçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Google Chat runs over HTTP webhooks with app-level auth (service account).
Multi-account support lives under <code>channels.googlechat.accounts</code> (see the multi-account section above). Env vars only apply to the default account.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    &quot;googlechat&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      serviceAccountFile: &quot;/path/to/service-account.json&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      audienceType: &quot;app-url&quot;,             // app-url | project-number</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      audience: &quot;https://gateway.example.com/googlechat&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      webhookPath: &quot;/googlechat&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      botUser: &quot;users/1234567890&quot;,        // optional; improves mention detection</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dm: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        policy: &quot;pairing&quot;,                // pairing | allowlist | open | disabled</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        allowFrom: [&quot;users/1234567890&quot;]   // optional; &quot;open&quot; requires [&quot;*&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groupPolicy: &quot;allowlist&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      groups: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;spaces/AAAA&quot;: { allow: true, requireMention: true }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      actions: { reactions: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      typingIndicator: &quot;message&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mediaMaxMb: 20</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Service account JSON can be inline (<code>serviceAccount</code>) or file-based (<code>serviceAccountFile</code>).</li>
<li class="">Env fallbacks for the default account: <code>GOOGLE_CHAT_SERVICE_ACCOUNT</code> or <code>GOOGLE_CHAT_SERVICE_ACCOUNT_FILE</code>.</li>
<li class=""><code>audienceType</code> + <code>audience</code> must match the Chat appâ€™s webhook auth config.</li>
<li class="">Use <code>spaces/&lt;spaceId&gt;</code> or <code>users/&lt;userId|email&gt;</code> when setting delivery targets.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelsslack-socket-mode"><code>channels.slack</code> (socket mode)<a href="#channelsslack-socket-mode" class="hash-link" aria-label="channelsslack-socket-modeçš„ç›´æ¥é“¾æ¥" title="channelsslack-socket-modeçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Slack runs in Socket Mode and requires both a bot token and app token:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    slack: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      botToken: &quot;xoxb-...&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      appToken: &quot;xapp-...&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dm: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        policy: &quot;pairing&quot;, // pairing | allowlist | open | disabled</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        allowFrom: [&quot;U123&quot;, &quot;U456&quot;, &quot;*&quot;], // optional; &quot;open&quot; requires [&quot;*&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        groupEnabled: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        groupChannels: [&quot;G123&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        C123: { allow: true, requireMention: true, allowBots: false },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;#general&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allow: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          requireMention: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allowBots: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          users: [&quot;U123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          skills: [&quot;docs&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          systemPrompt: &quot;Short answers only.&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      historyLimit: 50,          // include last N channel/group messages as context (0 disables)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowBots: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      reactionNotifications: &quot;own&quot;, // off | own | all | allowlist</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      reactionAllowlist: [&quot;U123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      replyToMode: &quot;off&quot;,           // off | first | all</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      thread: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        historyScope: &quot;thread&quot;,     // thread | channel</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        inheritParent: false</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      actions: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        reactions: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        messages: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        pins: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        memberInfo: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        emojiList: true</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      slashCommand: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        name: &quot;clawd&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        sessionPrefix: &quot;slack:slash&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ephemeral: true</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      textChunkLimit: 4000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      chunkMode: &quot;length&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mediaMaxMb: 20</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Multi-account support lives under <code>channels.slack.accounts</code> (see the multi-account section above). Env tokens only apply to the default account.</p>
<p>Moltbot starts Slack when the provider is enabled and both tokens are set (via config or <code>SLACK_BOT_TOKEN</code> + <code>SLACK_APP_TOKEN</code>). Use <code>user:&lt;id&gt;</code> (DM) or <code>channel:&lt;id&gt;</code> when specifying delivery targets for cron/CLI commands.
Set <code>channels.slack.configWrites: false</code> to block Slack-initiated config writes (including channel ID migrations and <code>/config set|unset</code>).</p>
<p>Bot-authored messages are ignored by default. Enable with <code>channels.slack.allowBots</code> or <code>channels.slack.channels.&lt;id&gt;.allowBots</code>.</p>
<p>Reaction notification modes:</p>
<ul>
<li class=""><code>off</code>: no reaction events.</li>
<li class=""><code>own</code>: reactions on the bot&#x27;s own messages (default).</li>
<li class=""><code>all</code>: all reactions on all messages.</li>
<li class=""><code>allowlist</code>: reactions from <code>channels.slack.reactionAllowlist</code> on all messages (empty list disables).</li>
</ul>
<p>Thread session isolation:</p>
<ul>
<li class=""><code>channels.slack.thread.historyScope</code> controls whether thread history is per-thread (<code>thread</code>, default) or shared across the channel (<code>channel</code>).</li>
<li class=""><code>channels.slack.thread.inheritParent</code> controls whether new thread sessions inherit the parent channel transcript (default: false).</li>
</ul>
<p>Slack action groups (gate <code>slack</code> tool actions):</p>



































<table><thead><tr><th>Action group</th><th>Default</th><th>Notes</th></tr></thead><tbody><tr><td>reactions</td><td>enabled</td><td>React + list reactions</td></tr><tr><td>messages</td><td>enabled</td><td>Read/send/edit/delete</td></tr><tr><td>pins</td><td>enabled</td><td>Pin/unpin/list</td></tr><tr><td>memberInfo</td><td>enabled</td><td>Member info</td></tr><tr><td>emojiList</td><td>enabled</td><td>Custom emoji list</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelsmattermost-bot-token"><code>channels.mattermost</code> (bot token)<a href="#channelsmattermost-bot-token" class="hash-link" aria-label="channelsmattermost-bot-tokençš„ç›´æ¥é“¾æ¥" title="channelsmattermost-bot-tokençš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Mattermost ships as a plugin and is not bundled with the core install.
Install it first: <code>moltbot plugins install @moltbot/mattermost</code> (or <code>./extensions/mattermost</code> from a git checkout).</p>
<p>Mattermost requires a bot token plus the base URL for your server:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mattermost: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      botToken: &quot;mm-token&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      baseUrl: &quot;https://chat.example.com&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dmPolicy: &quot;pairing&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      chatmode: &quot;oncall&quot;, // oncall | onmessage | onchar</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      oncharPrefixes: [&quot;&gt;&quot;, &quot;!&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      textChunkLimit: 4000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      chunkMode: &quot;length&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Moltbot starts Mattermost when the account is configured (bot token + base URL) and enabled. The token + base URL are resolved from <code>channels.mattermost.botToken</code> + <code>channels.mattermost.baseUrl</code> or <code>MATTERMOST_BOT_TOKEN</code> + <code>MATTERMOST_URL</code> for the default account (unless <code>channels.mattermost.enabled</code> is <code>false</code>).</p>
<p>Chat modes:</p>
<ul>
<li class=""><code>oncall</code> (default): respond to channel messages only when @mentioned.</li>
<li class=""><code>onmessage</code>: respond to every channel message.</li>
<li class=""><code>onchar</code>: respond when a message starts with a trigger prefix (<code>channels.mattermost.oncharPrefixes</code>, default <code>[&quot;&gt;&quot;, &quot;!&quot;]</code>).</li>
</ul>
<p>Access control:</p>
<ul>
<li class="">Default DMs: <code>channels.mattermost.dmPolicy=&quot;pairing&quot;</code> (unknown senders get a pairing code).</li>
<li class="">Public DMs: <code>channels.mattermost.dmPolicy=&quot;open&quot;</code> plus <code>channels.mattermost.allowFrom=[&quot;*&quot;]</code>.</li>
<li class="">Groups: <code>channels.mattermost.groupPolicy=&quot;allowlist&quot;</code> by default (mention-gated). Use <code>channels.mattermost.groupAllowFrom</code> to restrict senders.</li>
</ul>
<p>Multi-account support lives under <code>channels.mattermost.accounts</code> (see the multi-account section above). Env vars only apply to the default account.
Use <code>channel:&lt;id&gt;</code> or <code>user:&lt;id&gt;</code> (or <code>@username</code>) when specifying delivery targets; bare ids are treated as channel ids.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelssignal-signal-cli"><code>channels.signal</code> (signal-cli)<a href="#channelssignal-signal-cli" class="hash-link" aria-label="channelssignal-signal-cliçš„ç›´æ¥é“¾æ¥" title="channelssignal-signal-cliçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Signal reactions can emit system events (shared reaction tooling):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    signal: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      reactionNotifications: &quot;own&quot;, // off | own | all | allowlist</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      reactionAllowlist: [&quot;+15551234567&quot;, &quot;uuid:123e4567-e89b-12d3-a456-426614174000&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      historyLimit: 50 // include last N group messages as context (0 disables)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Reaction notification modes:</p>
<ul>
<li class=""><code>off</code>: no reaction events.</li>
<li class=""><code>own</code>: reactions on the bot&#x27;s own messages (default).</li>
<li class=""><code>all</code>: all reactions on all messages.</li>
<li class=""><code>allowlist</code>: reactions from <code>channels.signal.reactionAllowlist</code> on all messages (empty list disables).</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="channelsimessage-imsg-cli"><code>channels.imessage</code> (imsg CLI)<a href="#channelsimessage-imsg-cli" class="hash-link" aria-label="channelsimessage-imsg-cliçš„ç›´æ¥é“¾æ¥" title="channelsimessage-imsg-cliçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Moltbot spawns <code>imsg rpc</code> (JSON-RPC over stdio). No daemon or port required.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  channels: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    imessage: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      cliPath: &quot;imsg&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dbPath: &quot;~/Library/Messages/chat.db&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      remoteHost: &quot;user@gateway-host&quot;, // SCP for remote attachments when using SSH wrapper</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dmPolicy: &quot;pairing&quot;, // pairing | allowlist | open | disabled</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowFrom: [&quot;+15555550123&quot;, &quot;user@example.com&quot;, &quot;chat_id:123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      historyLimit: 50,    // include last N group messages as context (0 disables)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      includeAttachments: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mediaMaxMb: 16,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      service: &quot;auto&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      region: &quot;US&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Multi-account support lives under <code>channels.imessage.accounts</code> (see the multi-account section above).</p>
<p>Notes:</p>
<ul>
<li class="">Requires Full Disk Access to the Messages DB.</li>
<li class="">The first send will prompt for Messages automation permission.</li>
<li class="">Prefer <code>chat_id:&lt;id&gt;</code> targets. Use <code>imsg chats --limit 20</code> to list chats.</li>
<li class=""><code>channels.imessage.cliPath</code> can point to a wrapper script (e.g. <code>ssh</code> to another Mac that runs <code>imsg rpc</code>); use SSH keys to avoid password prompts.</li>
<li class="">For remote SSH wrappers, set <code>channels.imessage.remoteHost</code> to fetch attachments via SCP when <code>includeAttachments</code> is enabled.</li>
</ul>
<p>Example wrapper:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">#!/usr/bin/env bash</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">exec ssh -T gateway-host imsg &quot;$@&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultsworkspace"><code>agents.defaults.workspace</code><a href="#agentsdefaultsworkspace" class="hash-link" aria-label="agentsdefaultsworkspaceçš„ç›´æ¥é“¾æ¥" title="agentsdefaultsworkspaceçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Sets the <strong>single global workspace directory</strong> used by the agent for file operations.</p>
<p>Default: <code>~/clawd</code>.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { workspace: &quot;~/clawd&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>If <code>agents.defaults.sandbox</code> is enabled, non-main sessions can override this with their
own per-scope workspaces under <code>agents.defaults.sandbox.workspaceRoot</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultsreporoot"><code>agents.defaults.repoRoot</code><a href="#agentsdefaultsreporoot" class="hash-link" aria-label="agentsdefaultsreporootçš„ç›´æ¥é“¾æ¥" title="agentsdefaultsreporootçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Optional repository root to show in the system promptâ€™s Runtime line. If unset, Moltbot
tries to detect a <code>.git</code> directory by walking upward from the workspace (and current
working directory). The path must exist to be used.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { repoRoot: &quot;~/Projects/moltbot&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultsskipbootstrap"><code>agents.defaults.skipBootstrap</code><a href="#agentsdefaultsskipbootstrap" class="hash-link" aria-label="agentsdefaultsskipbootstrapçš„ç›´æ¥é“¾æ¥" title="agentsdefaultsskipbootstrapçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Disables automatic creation of the workspace bootstrap files (<code>AGENTS.md</code>, <code>SOUL.md</code>, <code>TOOLS.md</code>, <code>IDENTITY.md</code>, <code>USER.md</code>, and <code>BOOTSTRAP.md</code>).</p>
<p>Use this for pre-seeded deployments where your workspace files come from a repo.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { skipBootstrap: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultsbootstrapmaxchars"><code>agents.defaults.bootstrapMaxChars</code><a href="#agentsdefaultsbootstrapmaxchars" class="hash-link" aria-label="agentsdefaultsbootstrapmaxcharsçš„ç›´æ¥é“¾æ¥" title="agentsdefaultsbootstrapmaxcharsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Max characters of each workspace bootstrap file injected into the system prompt
before truncation. Default: <code>20000</code>.</p>
<p>When a file exceeds this limit, Moltbot logs a warning and injects a truncated
head/tail with a marker.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { bootstrapMaxChars: 20000 } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultsusertimezone"><code>agents.defaults.userTimezone</code><a href="#agentsdefaultsusertimezone" class="hash-link" aria-label="agentsdefaultsusertimezoneçš„ç›´æ¥é“¾æ¥" title="agentsdefaultsusertimezoneçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Sets the userâ€™s timezone for <strong>system prompt context</strong> (not for timestamps in
message envelopes). If unset, Moltbot uses the host timezone at runtime.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { userTimezone: &quot;America/Chicago&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultstimeformat"><code>agents.defaults.timeFormat</code><a href="#agentsdefaultstimeformat" class="hash-link" aria-label="agentsdefaultstimeformatçš„ç›´æ¥é“¾æ¥" title="agentsdefaultstimeformatçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls the <strong>time format</strong> shown in the system promptâ€™s Current Date &amp; Time section.
Default: <code>auto</code> (OS preference).</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { timeFormat: &quot;auto&quot; } } // auto | 12 | 24</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="messages"><code>messages</code><a href="#messages" class="hash-link" aria-label="messagesçš„ç›´æ¥é“¾æ¥" title="messagesçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls inbound/outbound prefixes and optional ack reactions.
See <a class="" href="/moltbot-doc/concepts/messages">Messages</a> for queueing, sessions, and streaming context.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  messages: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    responsePrefix: &quot;ğŸ¦&quot;, // or &quot;auto&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ackReaction: &quot;ğŸ‘€&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ackReactionScope: &quot;group-mentions&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    removeAckAfterReply: false</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>responsePrefix</code> is applied to <strong>all outbound replies</strong> (tool summaries, block
streaming, final replies) across channels unless already present.</p>
<p>If <code>messages.responsePrefix</code> is unset, no prefix is applied by default. WhatsApp self-chat
replies are the exception: they default to <code>[{identity.name}]</code> when set, otherwise
<code>[moltbot]</code>, so same-phone conversations stay legible.
Set it to <code>&quot;auto&quot;</code> to derive <code>[{identity.name}]</code> for the routed agent (when set).</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="template-variables">Template variables<a href="#template-variables" class="hash-link" aria-label="Template variablesçš„ç›´æ¥é“¾æ¥" title="Template variablesçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>The <code>responsePrefix</code> string can include template variables that resolve dynamically:</p>



































<table><thead><tr><th>Variable</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>{model}</code></td><td>Short model name</td><td><code>claude-opus-4-5</code>, <code>gpt-4o</code></td></tr><tr><td><code>{modelFull}</code></td><td>Full model identifier</td><td><code>anthropic/claude-opus-4-5</code></td></tr><tr><td><code>{provider}</code></td><td>Provider name</td><td><code>anthropic</code>, <code>openai</code></td></tr><tr><td><code>{thinkingLevel}</code></td><td>Current thinking level</td><td><code>high</code>, <code>low</code>, <code>off</code></td></tr><tr><td><code>{identity.name}</code></td><td>Agent identity name</td><td>(same as <code>&quot;auto&quot;</code> mode)</td></tr></tbody></table>
<p>Variables are case-insensitive (<code>{MODEL}</code> = <code>{model}</code>). <code>{think}</code> is an alias for <code>{thinkingLevel}</code>.
Unresolved variables remain as literal text.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  messages: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    responsePrefix: &quot;[{model} | think:{thinkingLevel}]&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Example output: <code>[claude-opus-4-5 | think:high] Here&#x27;s my response...</code></p>
<p>WhatsApp inbound prefix is configured via <code>channels.whatsapp.messagePrefix</code> (deprecated:
<code>messages.messagePrefix</code>). Default stays <strong>unchanged</strong>: <code>&quot;[moltbot]&quot;</code> when
<code>channels.whatsapp.allowFrom</code> is empty, otherwise <code>&quot;&quot;</code> (no prefix). When using
<code>&quot;[moltbot]&quot;</code>, Moltbot will instead use <code>[{identity.name}]</code> when the routed
agent has <code>identity.name</code> set.</p>
<p><code>ackReaction</code> sends a best-effort emoji reaction to acknowledge inbound messages
on channels that support reactions (Slack/Discord/Telegram/Google Chat). Defaults to the
active agentâ€™s <code>identity.emoji</code> when set, otherwise <code>&quot;ğŸ‘€&quot;</code>. Set it to <code>&quot;&quot;</code> to disable.</p>
<p><code>ackReactionScope</code> controls when reactions fire:</p>
<ul>
<li class=""><code>group-mentions</code> (default): only when a group/room requires mentions <strong>and</strong> the bot was mentioned</li>
<li class=""><code>group-all</code>: all group/room messages</li>
<li class=""><code>direct</code>: direct messages only</li>
<li class=""><code>all</code>: all messages</li>
</ul>
<p><code>removeAckAfterReply</code> removes the botâ€™s ack reaction after a reply is sent
(Slack/Discord/Telegram/Google Chat only). Default: <code>false</code>.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="messagestts"><code>messages.tts</code><a href="#messagestts" class="hash-link" aria-label="messagesttsçš„ç›´æ¥é“¾æ¥" title="messagesttsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>Enable text-to-speech for outbound replies. When on, Moltbot generates audio
using ElevenLabs or OpenAI and attaches it to responses. Telegram uses Opus
voice notes; other channels send MP3 audio.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  messages: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    tts: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      auto: &quot;always&quot;, // off | always | inbound | tagged</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mode: &quot;final&quot;, // final | all (include tool/block replies)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      provider: &quot;elevenlabs&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      summaryModel: &quot;openai/gpt-4.1-mini&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      modelOverrides: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      maxTextLength: 4000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      timeoutMs: 30000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      prefsPath: &quot;~/.clawdbot/settings/tts.json&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      elevenlabs: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;elevenlabs_api_key&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;https://api.elevenlabs.io&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        voiceId: &quot;voice_id&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        modelId: &quot;eleven_multilingual_v2&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        seed: 42,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        applyTextNormalization: &quot;auto&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        languageCode: &quot;en&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        voiceSettings: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          stability: 0.5,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          similarityBoost: 0.75,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          style: 0.0,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          useSpeakerBoost: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          speed: 1.0</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      openai: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;openai_api_key&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        model: &quot;gpt-4o-mini-tts&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        voice: &quot;alloy&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class=""><code>messages.tts.auto</code> controls autoâ€‘TTS (<code>off</code>, <code>always</code>, <code>inbound</code>, <code>tagged</code>).</li>
<li class=""><code>/tts off|always|inbound|tagged</code> sets the perâ€‘session auto mode (overrides config).</li>
<li class=""><code>messages.tts.enabled</code> is legacy; doctor migrates it to <code>messages.tts.auto</code>.</li>
<li class=""><code>prefsPath</code> stores local overrides (provider/limit/summarize).</li>
<li class=""><code>maxTextLength</code> is a hard cap for TTS input; summaries are truncated to fit.</li>
<li class=""><code>summaryModel</code> overrides <code>agents.defaults.model.primary</code> for auto-summary.
<ul>
<li class="">Accepts <code>provider/model</code> or an alias from <code>agents.defaults.models</code>.</li>
</ul>
</li>
<li class=""><code>modelOverrides</code> enables model-driven overrides like <code>[[tts:...]]</code> tags (on by default).</li>
<li class=""><code>/tts limit</code> and <code>/tts summary</code> control per-user summarization settings.</li>
<li class=""><code>apiKey</code> values fall back to <code>ELEVENLABS_API_KEY</code>/<code>XI_API_KEY</code> and <code>OPENAI_API_KEY</code>.</li>
<li class=""><code>elevenlabs.baseUrl</code> overrides the ElevenLabs API base URL.</li>
<li class=""><code>elevenlabs.voiceSettings</code> supports <code>stability</code>/<code>similarityBoost</code>/<code>style</code> (0..1),
<code>useSpeakerBoost</code>, and <code>speed</code> (0.5..2.0).</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="talk"><code>talk</code><a href="#talk" class="hash-link" aria-label="talkçš„ç›´æ¥é“¾æ¥" title="talkçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Defaults for Talk mode (macOS/iOS/Android). Voice IDs fall back to <code>ELEVENLABS_VOICE_ID</code> or <code>SAG_VOICE_ID</code> when unset.
<code>apiKey</code> falls back to <code>ELEVENLABS_API_KEY</code> (or the gatewayâ€™s shell profile) when unset.
<code>voiceAliases</code> lets Talk directives use friendly names (e.g. <code>&quot;voice&quot;:&quot;Clawd&quot;</code>).</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  talk: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    voiceId: &quot;elevenlabs_voice_id&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    voiceAliases: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      Clawd: &quot;EXAVITQu4vr4xnSDxMaL&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      Roger: &quot;CwhRBWXzGAHq8TQ4Fs17&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    modelId: &quot;eleven_v3&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    outputFormat: &quot;mp3_44100_128&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    apiKey: &quot;elevenlabs_api_key&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    interruptOnSpeech: true</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaults"><code>agents.defaults</code><a href="#agentsdefaults" class="hash-link" aria-label="agentsdefaultsçš„ç›´æ¥é“¾æ¥" title="agentsdefaultsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls the embedded agent runtime (model/thinking/verbose/timeouts).
<code>agents.defaults.models</code> defines the configured model catalog (and acts as the allowlist for <code>/model</code>).
<code>agents.defaults.model.primary</code> sets the default model; <code>agents.defaults.model.fallbacks</code> are global failovers.
<code>agents.defaults.imageModel</code> is optional and is <strong>only used if the primary model lacks image input</strong>.
Each <code>agents.defaults.models</code> entry can include:</p>
<ul>
<li class=""><code>alias</code> (optional model shortcut, e.g. <code>/opus</code>).</li>
<li class=""><code>params</code> (optional provider-specific API params passed through to the model request).</li>
</ul>
<p><code>params</code> is also applied to streaming runs (embedded agent + compaction). Supported keys today: <code>temperature</code>, <code>maxTokens</code>. These merge with call-time options; caller-supplied values win. <code>temperature</code> is an advanced knobâ€”leave unset unless you know the modelâ€™s defaults and need a change.</p>
<p>Example:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;anthropic/claude-sonnet-4-5-20250929&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          params: { temperature: 0.6 }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;openai/gpt-5.2&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          params: { maxTokens: 8192 }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Z.AI GLM-4.x models automatically enable thinking mode unless you:</p>
<ul>
<li class="">set <code>--thinking off</code>, or</li>
<li class="">define <code>agents.defaults.models[&quot;zai/&lt;model&gt;&quot;].params.thinking</code> yourself.</li>
</ul>
<p>Moltbot also ships a few built-in alias shorthands. Defaults only apply when the model
is already present in <code>agents.defaults.models</code>:</p>
<ul>
<li class=""><code>opus</code> -&gt; <code>anthropic/claude-opus-4-5</code></li>
<li class=""><code>sonnet</code> -&gt; <code>anthropic/claude-sonnet-4-5</code></li>
<li class=""><code>gpt</code> -&gt; <code>openai/gpt-5.2</code></li>
<li class=""><code>gpt-mini</code> -&gt; <code>openai/gpt-5-mini</code></li>
<li class=""><code>gemini</code> -&gt; <code>google/gemini-3-pro-preview</code></li>
<li class=""><code>gemini-flash</code> -&gt; <code>google/gemini-3-flash-preview</code></li>
</ul>
<p>If you configure the same alias name (case-insensitive) yourself, your value wins (defaults never override).</p>
<p>Example: Opus 4.5 primary with MiniMax M2.1 fallback (hosted MiniMax):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;anthropic/claude-opus-4-5&quot;: { alias: &quot;opus&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;minimax/MiniMax-M2.1&quot;: { alias: &quot;minimax&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        primary: &quot;anthropic/claude-opus-4-5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        fallbacks: [&quot;minimax/MiniMax-M2.1&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>MiniMax auth: set <code>MINIMAX_API_KEY</code> (env) or configure <code>models.providers.minimax</code>.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultsclibackends-cli-fallback"><code>agents.defaults.cliBackends</code> (CLI fallback)<a href="#agentsdefaultsclibackends-cli-fallback" class="hash-link" aria-label="agentsdefaultsclibackends-cli-fallbackçš„ç›´æ¥é“¾æ¥" title="agentsdefaultsclibackends-cli-fallbackçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>Optional CLI backends for text-only fallback runs (no tool calls). These are useful as a
backup path when API providers fail. Image pass-through is supported when you configure
an <code>imageArg</code> that accepts file paths.</p>
<p>Notes:</p>
<ul>
<li class="">CLI backends are <strong>text-first</strong>; tools are always disabled.</li>
<li class="">Sessions are supported when <code>sessionArg</code> is set; session ids are persisted per backend.</li>
<li class="">For <code>claude-cli</code>, defaults are wired in. Override the command path if PATH is minimal
(launchd/systemd).</li>
</ul>
<p>Example:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      cliBackends: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;claude-cli&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          command: &quot;/opt/homebrew/bin/claude&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;my-cli&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          command: &quot;my-cli&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          args: [&quot;--json&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          output: &quot;json&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          modelArg: &quot;--model&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          sessionArg: &quot;--session&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          sessionMode: &quot;existing&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          systemPromptArg: &quot;--system&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          systemPromptWhen: &quot;first&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          imageArg: &quot;--image&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          imageMode: &quot;repeat&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;anthropic/claude-opus-4-5&quot;: { alias: &quot;Opus&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;anthropic/claude-sonnet-4-1&quot;: { alias: &quot;Sonnet&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;openrouter/deepseek/deepseek-r1:free&quot;: {},</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;zai/glm-4.7&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          alias: &quot;GLM&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          params: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            thinking: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              type: &quot;enabled&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">              clear_thinking: false</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        primary: &quot;anthropic/claude-opus-4-5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        fallbacks: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          &quot;openrouter/deepseek/deepseek-r1:free&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          &quot;openrouter/meta-llama/llama-3.3-70b-instruct:free&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      imageModel: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        primary: &quot;openrouter/qwen/qwen-2.5-vl-72b-instruct:free&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        fallbacks: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          &quot;openrouter/google/gemini-2.0-flash-vision:free&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      thinkingDefault: &quot;low&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      verboseDefault: &quot;off&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      elevatedDefault: &quot;on&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      timeoutSeconds: 600,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mediaMaxMb: 5,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      heartbeat: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        every: &quot;30m&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        target: &quot;last&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      maxConcurrent: 3,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      subagents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        model: &quot;minimax/MiniMax-M2.1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        maxConcurrent: 1,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        archiveAfterMinutes: 60</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      exec: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        backgroundMs: 10000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        timeoutSec: 1800,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        cleanupMs: 1800000</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      contextTokens: 200000</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultscontextpruning-tool-result-pruning"><code>agents.defaults.contextPruning</code> (tool-result pruning)<a href="#agentsdefaultscontextpruning-tool-result-pruning" class="hash-link" aria-label="agentsdefaultscontextpruning-tool-result-pruningçš„ç›´æ¥é“¾æ¥" title="agentsdefaultscontextpruning-tool-result-pruningçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p><code>agents.defaults.contextPruning</code> prunes <strong>old tool results</strong> from the in-memory context right before a request is sent to the LLM.
It does <strong>not</strong> modify the session history on disk (<code>*.jsonl</code> remains complete).</p>
<p>This is intended to reduce token usage for chatty agents that accumulate large tool outputs over time.</p>
<p>High level:</p>
<ul>
<li class="">Never touches user/assistant messages.</li>
<li class="">Protects the last <code>keepLastAssistants</code> assistant messages (no tool results after that point are pruned).</li>
<li class="">Protects the bootstrap prefix (nothing before the first user message is pruned).</li>
<li class="">Modes:
<ul>
<li class=""><code>adaptive</code>: soft-trims oversized tool results (keep head/tail) when the estimated context ratio crosses <code>softTrimRatio</code>.
Then hard-clears the oldest eligible tool results when the estimated context ratio crosses <code>hardClearRatio</code> <strong>and</strong>
thereâ€™s enough prunable tool-result bulk (<code>minPrunableToolChars</code>).</li>
<li class=""><code>aggressive</code>: always replaces eligible tool results before the cutoff with the <code>hardClear.placeholder</code> (no ratio checks).</li>
</ul>
</li>
</ul>
<p>Soft vs hard pruning (what changes in the context sent to the LLM):</p>
<ul>
<li class=""><strong>Soft-trim</strong>: only for <em>oversized</em> tool results. Keeps the beginning + end and inserts <code>...</code> in the middle.
<ul>
<li class="">Before: <code>toolResult(&quot;â€¦very long outputâ€¦&quot;)</code></li>
<li class="">After: <code>toolResult(&quot;HEADâ€¦\n...\nâ€¦TAIL\n\n[Tool result trimmed: â€¦]&quot;)</code></li>
</ul>
</li>
<li class=""><strong>Hard-clear</strong>: replaces the entire tool result with the placeholder.
<ul>
<li class="">Before: <code>toolResult(&quot;â€¦very long outputâ€¦&quot;)</code></li>
<li class="">After: <code>toolResult(&quot;[Old tool result content cleared]&quot;)</code></li>
</ul>
</li>
</ul>
<p>Notes / current limitations:</p>
<ul>
<li class="">Tool results containing <strong>image blocks are skipped</strong> (never trimmed/cleared) right now.</li>
<li class="">The estimated â€œcontext ratioâ€ is based on <strong>characters</strong> (approximate), not exact tokens.</li>
<li class="">If the session doesnâ€™t contain at least <code>keepLastAssistants</code> assistant messages yet, pruning is skipped.</li>
<li class="">In <code>aggressive</code> mode, <code>hardClear.enabled</code> is ignored (eligible tool results are always replaced with <code>hardClear.placeholder</code>).</li>
</ul>
<p>Default (adaptive):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { contextPruning: { mode: &quot;adaptive&quot; } } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>To disable:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { contextPruning: { mode: &quot;off&quot; } } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Defaults (when <code>mode</code> is <code>&quot;adaptive&quot;</code> or <code>&quot;aggressive&quot;</code>):</p>
<ul>
<li class=""><code>keepLastAssistants</code>: <code>3</code></li>
<li class=""><code>softTrimRatio</code>: <code>0.3</code> (adaptive only)</li>
<li class=""><code>hardClearRatio</code>: <code>0.5</code> (adaptive only)</li>
<li class=""><code>minPrunableToolChars</code>: <code>50000</code> (adaptive only)</li>
<li class=""><code>softTrim</code>: <code>{ maxChars: 4000, headChars: 1500, tailChars: 1500 }</code> (adaptive only)</li>
<li class=""><code>hardClear</code>: <code>{ enabled: true, placeholder: &quot;[Old tool result content cleared]&quot; }</code></li>
</ul>
<p>Example (aggressive, minimal):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { contextPruning: { mode: &quot;aggressive&quot; } } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Example (adaptive tuned):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      contextPruning: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        mode: &quot;adaptive&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        keepLastAssistants: 3,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        softTrimRatio: 0.3,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        hardClearRatio: 0.5,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        minPrunableToolChars: 50000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        softTrim: { maxChars: 4000, headChars: 1500, tailChars: 1500 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        hardClear: { enabled: true, placeholder: &quot;[Old tool result content cleared]&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        // Optional: restrict pruning to specific tools (deny wins; supports &quot;*&quot; wildcards)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        tools: { deny: [&quot;browser&quot;, &quot;canvas&quot;] },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>See <a class="" href="/moltbot-doc/concepts/session-pruning">/concepts/session-pruning</a> for behavior details.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultscompaction-reserve-headroom--memory-flush"><code>agents.defaults.compaction</code> (reserve headroom + memory flush)<a href="#agentsdefaultscompaction-reserve-headroom--memory-flush" class="hash-link" aria-label="agentsdefaultscompaction-reserve-headroom--memory-flushçš„ç›´æ¥é“¾æ¥" title="agentsdefaultscompaction-reserve-headroom--memory-flushçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p><code>agents.defaults.compaction.mode</code> selects the compaction summarization strategy. Defaults to <code>default</code>; set <code>safeguard</code> to enable chunked summarization for very long histories. See <a class="" href="/moltbot-doc/concepts/compaction">/concepts/compaction</a>.</p>
<p><code>agents.defaults.compaction.reserveTokensFloor</code> enforces a minimum <code>reserveTokens</code>
value for Pi compaction (default: <code>20000</code>). Set it to <code>0</code> to disable the floor.</p>
<p><code>agents.defaults.compaction.memoryFlush</code> runs a <strong>silent</strong> agentic turn before
auto-compaction, instructing the model to store durable memories on disk (e.g.
<code>memory/YYYY-MM-DD.md</code>). It triggers when the session token estimate crosses a
soft threshold below the compaction limit.</p>
<p>Legacy defaults:</p>
<ul>
<li class=""><code>memoryFlush.enabled</code>: <code>true</code></li>
<li class=""><code>memoryFlush.softThresholdTokens</code>: <code>4000</code></li>
<li class=""><code>memoryFlush.prompt</code> / <code>memoryFlush.systemPrompt</code>: built-in defaults with <code>NO_REPLY</code></li>
<li class="">Note: memory flush is skipped when the session workspace is read-only
(<code>agents.defaults.sandbox.workspaceAccess: &quot;ro&quot;</code> or <code>&quot;none&quot;</code>).</li>
</ul>
<p>Example (tuned):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      compaction: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        mode: &quot;safeguard&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        reserveTokensFloor: 24000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        memoryFlush: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          softThresholdTokens: 6000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          systemPrompt: &quot;Session nearing compaction. Store durable memories now.&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          prompt: &quot;Write any lasting notes to memory/YYYY-MM-DD.md; reply with NO_REPLY if nothing to store.&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Block streaming:</p>
<ul>
<li class=""><code>agents.defaults.blockStreamingDefault</code>: <code>&quot;on&quot;</code>/<code>&quot;off&quot;</code> (default off).</li>
<li class="">Channel overrides: <code>*.blockStreaming</code> (and per-account variants) to force block streaming on/off.
Non-Telegram channels require an explicit <code>*.blockStreaming: true</code> to enable block replies.</li>
<li class=""><code>agents.defaults.blockStreamingBreak</code>: <code>&quot;text_end&quot;</code> or <code>&quot;message_end&quot;</code> (default: text_end).</li>
<li class=""><code>agents.defaults.blockStreamingChunk</code>: soft chunking for streamed blocks. Defaults to
800â€“1200 chars, prefers paragraph breaks (<code>\n\n</code>), then newlines, then sentences.
Example:
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { blockStreamingChunk: { minChars: 800, maxChars: 1200 } } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
</li>
<li class=""><code>agents.defaults.blockStreamingCoalesce</code>: merge streamed blocks before sending.
Defaults to <code>{ idleMs: 1000 }</code> and inherits <code>minChars</code> from <code>blockStreamingChunk</code>
with <code>maxChars</code> capped to the channel text limit. Signal/Slack/Discord/Google Chat default
to <code>minChars: 1500</code> unless overridden.
Channel overrides: <code>channels.whatsapp.blockStreamingCoalesce</code>, <code>channels.telegram.blockStreamingCoalesce</code>,
<code>channels.discord.blockStreamingCoalesce</code>, <code>channels.slack.blockStreamingCoalesce</code>, <code>channels.mattermost.blockStreamingCoalesce</code>,
<code>channels.signal.blockStreamingCoalesce</code>, <code>channels.imessage.blockStreamingCoalesce</code>, <code>channels.msteams.blockStreamingCoalesce</code>,
<code>channels.googlechat.blockStreamingCoalesce</code>
(and per-account variants).</li>
<li class=""><code>agents.defaults.humanDelay</code>: randomized pause between <strong>block replies</strong> after the first.
Modes: <code>off</code> (default), <code>natural</code> (800â€“2500ms), <code>custom</code> (use <code>minMs</code>/<code>maxMs</code>).
Per-agent override: <code>agents.list[].humanDelay</code>.
Example:
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: { defaults: { humanDelay: { mode: &quot;natural&quot; } } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
</li>
</ul>
<p>See <a class="" href="/moltbot-doc/concepts/streaming">/concepts/streaming</a> for behavior + chunking details.</p>
<p>Typing indicators:</p>
<ul>
<li class=""><code>agents.defaults.typingMode</code>: <code>&quot;never&quot; | &quot;instant&quot; | &quot;thinking&quot; | &quot;message&quot;</code>. Defaults to
<code>instant</code> for direct chats / mentions and <code>message</code> for unmentioned group chats.</li>
<li class=""><code>session.typingMode</code>: per-session override for the mode.</li>
<li class=""><code>agents.defaults.typingIntervalSeconds</code>: how often the typing signal is refreshed (default: 6s).</li>
<li class=""><code>session.typingIntervalSeconds</code>: per-session override for the refresh interval.
See <a class="" href="/moltbot-doc/concepts/typing-indicators">/concepts/typing-indicators</a> for behavior details.</li>
</ul>
<p><code>agents.defaults.model.primary</code> should be set as <code>provider/model</code> (e.g. <code>anthropic/claude-opus-4-5</code>).
Aliases come from <code>agents.defaults.models.*.alias</code> (e.g. <code>Opus</code>).
If you omit the provider, Moltbot currently assumes <code>anthropic</code> as a temporary
deprecation fallback.
Z.AI models are available as <code>zai/&lt;model&gt;</code> (e.g. <code>zai/glm-4.7</code>) and require
<code>ZAI_API_KEY</code> (or legacy <code>Z_AI_API_KEY</code>) in the environment.</p>
<p><code>agents.defaults.heartbeat</code> configures periodic heartbeat runs:</p>
<ul>
<li class=""><code>every</code>: duration string (<code>ms</code>, <code>s</code>, <code>m</code>, <code>h</code>); default unit minutes. Default:
<code>30m</code>. Set <code>0m</code> to disable.</li>
<li class=""><code>model</code>: optional override model for heartbeat runs (<code>provider/model</code>).</li>
<li class=""><code>includeReasoning</code>: when <code>true</code>, heartbeats will also deliver the separate <code>Reasoning:</code> message when available (same shape as <code>/reasoning on</code>). Default: <code>false</code>.</li>
<li class=""><code>session</code>: optional session key to control which session the heartbeat runs in. Default: <code>main</code>.</li>
<li class=""><code>to</code>: optional recipient override (channel-specific id, e.g. E.164 for WhatsApp, chat id for Telegram).</li>
<li class=""><code>target</code>: optional delivery channel (<code>last</code>, <code>whatsapp</code>, <code>telegram</code>, <code>discord</code>, <code>slack</code>, <code>msteams</code>, <code>signal</code>, <code>imessage</code>, <code>none</code>). Default: <code>last</code>.</li>
<li class=""><code>prompt</code>: optional override for the heartbeat body (default: <code>Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior chats. If nothing needs attention, reply HEARTBEAT_OK.</code>). Overrides are sent verbatim; include a <code>Read HEARTBEAT.md</code> line if you still want the file read.</li>
<li class=""><code>ackMaxChars</code>: max chars allowed after <code>HEARTBEAT_OK</code> before delivery (default: 300).</li>
</ul>
<p>Per-agent heartbeats:</p>
<ul>
<li class="">Set <code>agents.list[].heartbeat</code> to enable or override heartbeat settings for a specific agent.</li>
<li class="">If any agent entry defines <code>heartbeat</code>, <strong>only those agents</strong> run heartbeats; defaults
become the shared baseline for those agents.</li>
</ul>
<p>Heartbeats run full agent turns. Shorter intervals burn more tokens; be mindful
of <code>every</code>, keep <code>HEARTBEAT.md</code> tiny, and/or choose a cheaper <code>model</code>.</p>
<p><code>tools.exec</code> configures background exec defaults:</p>
<ul>
<li class=""><code>backgroundMs</code>: time before auto-background (ms, default 10000)</li>
<li class=""><code>timeoutSec</code>: auto-kill after this runtime (seconds, default 1800)</li>
<li class=""><code>cleanupMs</code>: how long to keep finished sessions in memory (ms, default 1800000)</li>
<li class=""><code>notifyOnExit</code>: enqueue a system event + request heartbeat when backgrounded exec exits (default true)</li>
<li class=""><code>applyPatch.enabled</code>: enable experimental <code>apply_patch</code> (OpenAI/OpenAI Codex only; default false)</li>
<li class=""><code>applyPatch.allowModels</code>: optional allowlist of model ids (e.g. <code>gpt-5.2</code> or <code>openai/gpt-5.2</code>)
Note: <code>applyPatch</code> is only under <code>tools.exec</code>.</li>
</ul>
<p><code>tools.web</code> configures web search + fetch tools:</p>
<ul>
<li class=""><code>tools.web.search.enabled</code> (default: true when key is present)</li>
<li class=""><code>tools.web.search.apiKey</code> (recommended: set via <code>moltbot configure --section web</code>, or use <code>BRAVE_API_KEY</code> env var)</li>
<li class=""><code>tools.web.search.maxResults</code> (1â€“10, default 5)</li>
<li class=""><code>tools.web.search.timeoutSeconds</code> (default 30)</li>
<li class=""><code>tools.web.search.cacheTtlMinutes</code> (default 15)</li>
<li class=""><code>tools.web.fetch.enabled</code> (default true)</li>
<li class=""><code>tools.web.fetch.maxChars</code> (default 50000)</li>
<li class=""><code>tools.web.fetch.timeoutSeconds</code> (default 30)</li>
<li class=""><code>tools.web.fetch.cacheTtlMinutes</code> (default 15)</li>
<li class=""><code>tools.web.fetch.userAgent</code> (optional override)</li>
<li class=""><code>tools.web.fetch.readability</code> (default true; disable to use basic HTML cleanup only)</li>
<li class=""><code>tools.web.fetch.firecrawl.enabled</code> (default true when an API key is set)</li>
<li class=""><code>tools.web.fetch.firecrawl.apiKey</code> (optional; defaults to <code>FIRECRAWL_API_KEY</code>)</li>
<li class=""><code>tools.web.fetch.firecrawl.baseUrl</code> (default <a href="https://api.firecrawl.dev" target="_blank" rel="noopener noreferrer" class="">https://api.firecrawl.dev</a>)</li>
<li class=""><code>tools.web.fetch.firecrawl.onlyMainContent</code> (default true)</li>
<li class=""><code>tools.web.fetch.firecrawl.maxAgeMs</code> (optional)</li>
<li class=""><code>tools.web.fetch.firecrawl.timeoutSeconds</code> (optional)</li>
</ul>
<p><code>tools.media</code> configures inbound media understanding (image/audio/video):</p>
<ul>
<li class=""><code>tools.media.models</code>: shared model list (capability-tagged; used after per-cap lists).</li>
<li class=""><code>tools.media.concurrency</code>: max concurrent capability runs (default 2).</li>
<li class=""><code>tools.media.image</code> / <code>tools.media.audio</code> / <code>tools.media.video</code>:
<ul>
<li class=""><code>enabled</code>: opt-out switch (default true when models are configured).</li>
<li class=""><code>prompt</code>: optional prompt override (image/video append a <code>maxChars</code> hint automatically).</li>
<li class=""><code>maxChars</code>: max output characters (default 500 for image/video; unset for audio).</li>
<li class=""><code>maxBytes</code>: max media size to send (defaults: image 10MB, audio 20MB, video 50MB).</li>
<li class=""><code>timeoutSeconds</code>: request timeout (defaults: image 60s, audio 60s, video 120s).</li>
<li class=""><code>language</code>: optional audio hint.</li>
<li class=""><code>attachments</code>: attachment policy (<code>mode</code>, <code>maxAttachments</code>, <code>prefer</code>).</li>
<li class=""><code>scope</code>: optional gating (first match wins) with <code>match.channel</code>, <code>match.chatType</code>, or <code>match.keyPrefix</code>.</li>
<li class=""><code>models</code>: ordered list of model entries; failures or oversize media fall back to the next entry.</li>
</ul>
</li>
<li class="">Each <code>models[]</code> entry:
<ul>
<li class="">Provider entry (<code>type: &quot;provider&quot;</code> or omitted):
<ul>
<li class=""><code>provider</code>: API provider id (<code>openai</code>, <code>anthropic</code>, <code>google</code>/<code>gemini</code>, <code>groq</code>, etc).</li>
<li class=""><code>model</code>: model id override (required for image; defaults to <code>gpt-4o-mini-transcribe</code>/<code>whisper-large-v3-turbo</code> for audio providers, and <code>gemini-3-flash-preview</code> for video).</li>
<li class=""><code>profile</code> / <code>preferredProfile</code>: auth profile selection.</li>
</ul>
</li>
<li class="">CLI entry (<code>type: &quot;cli&quot;</code>):
<ul>
<li class=""><code>command</code>: executable to run.</li>
<li class=""><code>args</code>: templated args (supports <code>{{MediaPath}}</code>, <code>{{Prompt}}</code>, <code>{{MaxChars}}</code>, etc).</li>
</ul>
</li>
<li class=""><code>capabilities</code>: optional list (<code>image</code>, <code>audio</code>, <code>video</code>) to gate a shared entry. Defaults when omitted: <code>openai</code>/<code>anthropic</code>/<code>minimax</code> â†’ image, <code>google</code> â†’ image+audio+video, <code>groq</code> â†’ audio.</li>
<li class=""><code>prompt</code>, <code>maxChars</code>, <code>maxBytes</code>, <code>timeoutSeconds</code>, <code>language</code> can be overridden per entry.</li>
</ul>
</li>
</ul>
<p>If no models are configured (or <code>enabled: false</code>), understanding is skipped; the model still receives the original attachments.</p>
<p>Provider auth follows the standard model auth order (auth profiles, env vars like <code>OPENAI_API_KEY</code>/<code>GROQ_API_KEY</code>/<code>GEMINI_API_KEY</code>, or <code>models.providers.*.apiKey</code>).</p>
<p>Example:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    media: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      audio: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        maxBytes: 20971520,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        scope: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          default: &quot;deny&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          rules: [{ action: &quot;allow&quot;, match: { chatType: &quot;direct&quot; } }]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          { provider: &quot;openai&quot;, model: &quot;gpt-4o-mini-transcribe&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          { type: &quot;cli&quot;, command: &quot;whisper&quot;, args: [&quot;--model&quot;, &quot;base&quot;, &quot;{{MediaPath}}&quot;] }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      video: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        maxBytes: 52428800,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [{ provider: &quot;google&quot;, model: &quot;gemini-3-flash-preview&quot; }]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>agents.defaults.subagents</code> configures sub-agent defaults:</p>
<ul>
<li class=""><code>model</code>: default model for spawned sub-agents (string or <code>{ primary, fallbacks }</code>). If omitted, sub-agents inherit the callerâ€™s model unless overridden per agent or per call.</li>
<li class=""><code>maxConcurrent</code>: max concurrent sub-agent runs (default 1)</li>
<li class=""><code>archiveAfterMinutes</code>: auto-archive sub-agent sessions after N minutes (default 60; set <code>0</code> to disable)</li>
<li class="">Per-subagent tool policy: <code>tools.subagents.tools.allow</code> / <code>tools.subagents.tools.deny</code> (deny wins)</li>
</ul>
<p><code>tools.profile</code> sets a <strong>base tool allowlist</strong> before <code>tools.allow</code>/<code>tools.deny</code>:</p>
<ul>
<li class=""><code>minimal</code>: <code>session_status</code> only</li>
<li class=""><code>coding</code>: <code>group:fs</code>, <code>group:runtime</code>, <code>group:sessions</code>, <code>group:memory</code>, <code>image</code></li>
<li class=""><code>messaging</code>: <code>group:messaging</code>, <code>sessions_list</code>, <code>sessions_history</code>, <code>sessions_send</code>, <code>session_status</code></li>
<li class=""><code>full</code>: no restriction (same as unset)</li>
</ul>
<p>Per-agent override: <code>agents.list[].tools.profile</code>.</p>
<p>Example (messaging-only by default, allow Slack + Discord tools too):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    profile: &quot;messaging&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    allow: [&quot;slack&quot;, &quot;discord&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Example (coding profile, but deny exec/process everywhere):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    profile: &quot;coding&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    deny: [&quot;group:runtime&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>tools.byProvider</code> lets you <strong>further restrict</strong> tools for specific providers (or a single <code>provider/model</code>).
Per-agent override: <code>agents.list[].tools.byProvider</code>.</p>
<p>Order: base profile â†’ provider profile â†’ allow/deny policies.
Provider keys accept either <code>provider</code> (e.g. <code>google-antigravity</code>) or <code>provider/model</code>
(e.g. <code>openai/gpt-5.2</code>).</p>
<p>Example (keep global coding profile, but minimal tools for Google Antigravity):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    profile: &quot;coding&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    byProvider: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;google-antigravity&quot;: { profile: &quot;minimal&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Example (provider/model-specific allowlist):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    allow: [&quot;group:fs&quot;, &quot;group:runtime&quot;, &quot;sessions_list&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    byProvider: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;openai/gpt-5.2&quot;: { allow: [&quot;group:fs&quot;, &quot;sessions_list&quot;] }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>tools.allow</code> / <code>tools.deny</code> configure a global tool allow/deny policy (deny wins).
Matching is case-insensitive and supports <code>*</code> wildcards (<code>&quot;*&quot;</code> means all tools).
This is applied even when the Docker sandbox is <strong>off</strong>.</p>
<p>Example (disable browser/canvas everywhere):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: { deny: [&quot;browser&quot;, &quot;canvas&quot;] }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Tool groups (shorthands) work in <strong>global</strong> and <strong>per-agent</strong> tool policies:</p>
<ul>
<li class=""><code>group:runtime</code>: <code>exec</code>, <code>bash</code>, <code>process</code></li>
<li class=""><code>group:fs</code>: <code>read</code>, <code>write</code>, <code>edit</code>, <code>apply_patch</code></li>
<li class=""><code>group:sessions</code>: <code>sessions_list</code>, <code>sessions_history</code>, <code>sessions_send</code>, <code>sessions_spawn</code>, <code>session_status</code></li>
<li class=""><code>group:memory</code>: <code>memory_search</code>, <code>memory_get</code></li>
<li class=""><code>group:web</code>: <code>web_search</code>, <code>web_fetch</code></li>
<li class=""><code>group:ui</code>: <code>browser</code>, <code>canvas</code></li>
<li class=""><code>group:automation</code>: <code>cron</code>, <code>gateway</code></li>
<li class=""><code>group:messaging</code>: <code>message</code></li>
<li class=""><code>group:nodes</code>: <code>nodes</code></li>
<li class=""><code>group:moltbot</code>: all built-in Moltbot tools (excludes provider plugins)</li>
</ul>
<p><code>tools.elevated</code> controls elevated (host) exec access:</p>
<ul>
<li class=""><code>enabled</code>: allow elevated mode (default true)</li>
<li class=""><code>allowFrom</code>: per-channel allowlists (empty = disabled)
<ul>
<li class=""><code>whatsapp</code>: E.164 numbers</li>
<li class=""><code>telegram</code>: chat ids or usernames</li>
<li class=""><code>discord</code>: user ids or usernames (falls back to <code>channels.discord.dm.allowFrom</code> if omitted)</li>
<li class=""><code>signal</code>: E.164 numbers</li>
<li class=""><code>imessage</code>: handles/chat ids</li>
<li class=""><code>webchat</code>: session ids or usernames</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    elevated: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      allowFrom: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        whatsapp: [&quot;+15555550123&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        discord: [&quot;steipete&quot;, &quot;1234567890123&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Per-agent override (further restrict):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    list: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        id: &quot;family&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          elevated: { enabled: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class=""><code>tools.elevated</code> is the global baseline. <code>agents.list[].tools.elevated</code> can only further restrict (both must allow).</li>
<li class=""><code>/elevated on|off|ask|full</code> stores state per session key; inline directives apply to a single message.</li>
<li class="">Elevated <code>exec</code> runs on the host and bypasses sandboxing.</li>
<li class="">Tool policy still applies; if <code>exec</code> is denied, elevated cannot be used.</li>
</ul>
<p><code>agents.defaults.maxConcurrent</code> sets the maximum number of embedded agent runs that can
execute in parallel across sessions. Each session is still serialized (one run
per session key at a time). Default: 1.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agentsdefaultssandbox"><code>agents.defaults.sandbox</code><a href="#agentsdefaultssandbox" class="hash-link" aria-label="agentsdefaultssandboxçš„ç›´æ¥é“¾æ¥" title="agentsdefaultssandboxçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Optional <strong>Docker sandboxing</strong> for the embedded agent. Intended for non-main
sessions so they cannot access your host system.</p>
<p>Details: <a class="" href="/moltbot-doc/gateway/sandboxing">Sandboxing</a></p>
<p>Defaults (if enabled):</p>
<ul>
<li class="">scope: <code>&quot;agent&quot;</code> (one container + workspace per agent)</li>
<li class="">Debian bookworm-slim based image</li>
<li class="">agent workspace access: <code>workspaceAccess: &quot;none&quot;</code> (default)
<ul>
<li class=""><code>&quot;none&quot;</code>: use a per-scope sandbox workspace under <code>~/.clawdbot/sandboxes</code></li>
</ul>
</li>
<li class=""><code>&quot;ro&quot;</code>: keep the sandbox workspace at <code>/workspace</code>, and mount the agent workspace read-only at <code>/agent</code> (disables <code>write</code>/<code>edit</code>/<code>apply_patch</code>)
<ul>
<li class=""><code>&quot;rw&quot;</code>: mount the agent workspace read/write at <code>/workspace</code></li>
</ul>
</li>
<li class="">auto-prune: idle &gt; 24h OR age &gt; 7d</li>
<li class="">tool policy: allow only <code>exec</code>, <code>process</code>, <code>read</code>, <code>write</code>, <code>edit</code>, <code>apply_patch</code>, <code>sessions_list</code>, <code>sessions_history</code>, <code>sessions_send</code>, <code>sessions_spawn</code>, <code>session_status</code> (deny wins)
<ul>
<li class="">configure via <code>tools.sandbox.tools</code>, override per-agent via <code>agents.list[].tools.sandbox.tools</code></li>
<li class="">tool group shorthands supported in sandbox policy: <code>group:runtime</code>, <code>group:fs</code>, <code>group:sessions</code>, <code>group:memory</code> (see <a class="" href="/moltbot-doc/gateway/sandbox-vs-tool-policy-vs-elevated#tool-groups-shorthands">Sandbox vs Tool Policy vs Elevated</a>)</li>
</ul>
</li>
<li class="">optional sandboxed browser (Chromium + CDP, noVNC observer)</li>
<li class="">hardening knobs: <code>network</code>, <code>user</code>, <code>pidsLimit</code>, <code>memory</code>, <code>cpus</code>, <code>ulimits</code>, <code>seccompProfile</code>, <code>apparmorProfile</code></li>
</ul>
<p>Warning: <code>scope: &quot;shared&quot;</code> means a shared container and shared workspace. No
cross-session isolation. Use <code>scope: &quot;session&quot;</code> for per-session isolation.</p>
<p>Legacy: <code>perSession</code> is still supported (<code>true</code> â†’ <code>scope: &quot;session&quot;</code>,
<code>false</code> â†’ <code>scope: &quot;shared&quot;</code>).</p>
<p><code>setupCommand</code> runs <strong>once</strong> after the container is created (inside the container via <code>sh -lc</code>).
For package installs, ensure network egress, a writable root FS, and a root user.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      sandbox: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        mode: &quot;non-main&quot;, // off | non-main | all</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        scope: &quot;agent&quot;, // session | agent | shared (agent is default)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        workspaceAccess: &quot;none&quot;, // none | ro | rw</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        workspaceRoot: &quot;~/.clawdbot/sandboxes&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        docker: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          image: &quot;moltbot-sandbox:bookworm-slim&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          containerPrefix: &quot;moltbot-sbx-&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          workdir: &quot;/workspace&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          readOnlyRoot: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          tmpfs: [&quot;/tmp&quot;, &quot;/var/tmp&quot;, &quot;/run&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          network: &quot;none&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          user: &quot;1000:1000&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          capDrop: [&quot;ALL&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          env: { LANG: &quot;C.UTF-8&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          setupCommand: &quot;apt-get update &amp;&amp; apt-get install -y git curl jq&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          // Per-agent override (multi-agent): agents.list[].sandbox.docker.*</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          pidsLimit: 256,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          memory: &quot;1g&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          memorySwap: &quot;2g&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          cpus: 1,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          ulimits: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            nofile: { soft: 1024, hard: 2048 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            nproc: 256</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          seccompProfile: &quot;/path/to/seccomp.json&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          apparmorProfile: &quot;moltbot-sandbox&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          dns: [&quot;1.1.1.1&quot;, &quot;8.8.8.8&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          extraHosts: [&quot;internal.service:10.0.0.5&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          binds: [&quot;/var/run/docker.sock:/var/run/docker.sock&quot;, &quot;/home/user/source:/source:rw&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        browser: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          enabled: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          image: &quot;moltbot-sandbox-browser:bookworm-slim&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          containerPrefix: &quot;moltbot-sbx-browser-&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          cdpPort: 9222,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          vncPort: 5900,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          noVncPort: 6080,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          headless: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          enableNoVnc: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allowHostControl: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allowedControlUrls: [&quot;http://10.0.0.42:18791&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allowedControlHosts: [&quot;browser.lab.local&quot;, &quot;10.0.0.42&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          allowedControlPorts: [18791],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          autoStart: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          autoStartTimeoutMs: 12000</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        prune: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          idleHours: 24,  // 0 disables idle pruning</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          maxAgeDays: 7   // 0 disables max-age pruning</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    sandbox: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      tools: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        allow: [&quot;exec&quot;, &quot;process&quot;, &quot;read&quot;, &quot;write&quot;, &quot;edit&quot;, &quot;apply_patch&quot;, &quot;sessions_list&quot;, &quot;sessions_history&quot;, &quot;sessions_send&quot;, &quot;sessions_spawn&quot;, &quot;session_status&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        deny: [&quot;browser&quot;, &quot;canvas&quot;, &quot;nodes&quot;, &quot;cron&quot;, &quot;discord&quot;, &quot;gateway&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Build the default sandbox image once with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">scripts/sandbox-setup.sh</span><br></span></code></pre></div></div>
<p>Note: sandbox containers default to <code>network: &quot;none&quot;</code>; set <code>agents.defaults.sandbox.docker.network</code>
to <code>&quot;bridge&quot;</code> (or your custom network) if the agent needs outbound access.</p>
<p>Note: inbound attachments are staged into the active workspace at <code>media/inbound/*</code>. With <code>workspaceAccess: &quot;rw&quot;</code>, that means files are written into the agent workspace.</p>
<p>Note: <code>docker.binds</code> mounts additional host directories; global and per-agent binds are merged.</p>
<p>Build the optional browser image with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">scripts/sandbox-browser-setup.sh</span><br></span></code></pre></div></div>
<p>When <code>agents.defaults.sandbox.browser.enabled=true</code>, the browser tool uses a sandboxed
Chromium instance (CDP). If noVNC is enabled (default when headless=false),
the noVNC URL is injected into the system prompt so the agent can reference it.
This does not require <code>browser.enabled</code> in the main config; the sandbox control
URL is injected per session.</p>
<p><code>agents.defaults.sandbox.browser.allowHostControl</code> (default: false) allows
sandboxed sessions to explicitly target the <strong>host</strong> browser control server
via the browser tool (<code>target: &quot;host&quot;</code>). Leave this off if you want strict
sandbox isolation.</p>
<p>Allowlists for remote control:</p>
<ul>
<li class=""><code>allowedControlUrls</code>: exact control URLs permitted for <code>target: &quot;custom&quot;</code>.</li>
<li class=""><code>allowedControlHosts</code>: hostnames permitted (hostname only, no port).</li>
<li class=""><code>allowedControlPorts</code>: ports permitted (defaults: http=80, https=443).
Defaults: all allowlists are unset (no restriction). <code>allowHostControl</code> defaults to false.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="models-custom-providers--base-urls"><code>models</code> (custom providers + base URLs)<a href="#models-custom-providers--base-urls" class="hash-link" aria-label="models-custom-providers--base-urlsçš„ç›´æ¥é“¾æ¥" title="models-custom-providers--base-urlsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Moltbot uses the <strong>pi-coding-agent</strong> model catalog. You can add custom providers
(LiteLLM, local OpenAI-compatible servers, Anthropic proxies, etc.) by writing
<code>~/.clawdbot/agents/&lt;agentId&gt;/agent/models.json</code> or by defining the same schema inside your
Moltbot config under <code>models.providers</code>.
Provider-by-provider overview + examples: <a class="" href="/moltbot-doc/concepts/model-providers">/concepts/model-providers</a>.</p>
<p>When <code>models.providers</code> is present, Moltbot writes/merges a <code>models.json</code> into
<code>~/.clawdbot/agents/&lt;agentId&gt;/agent/</code> on startup:</p>
<ul>
<li class="">default behavior: <strong>merge</strong> (keeps existing providers, overrides on name)</li>
<li class="">set <code>models.mode: &quot;replace&quot;</code> to overwrite the file contents</li>
</ul>
<p>Select the model via <code>agents.defaults.model.primary</code> (provider/model).</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: { primary: &quot;custom-proxy/llama-3.1-8b&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;custom-proxy/llama-3.1-8b&quot;: {}</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;merge&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;custom-proxy&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;http://localhost:4000/v1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;LITELLM_KEY&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        api: &quot;openai-completions&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            id: &quot;llama-3.1-8b&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            name: &quot;Llama 3.1 8B&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            reasoning: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            input: [&quot;text&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            cost: { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            contextWindow: 128000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            maxTokens: 32000</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="opencode-zen-multi-model-proxy">OpenCode Zen (multi-model proxy)<a href="#opencode-zen-multi-model-proxy" class="hash-link" aria-label="OpenCode Zen (multi-model proxy)çš„ç›´æ¥é“¾æ¥" title="OpenCode Zen (multi-model proxy)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>OpenCode Zen is a multi-model gateway with per-model endpoints. Moltbot uses
the built-in <code>opencode</code> provider from pi-ai; set <code>OPENCODE_API_KEY</code> (or
<code>OPENCODE_ZEN_API_KEY</code>) from <a href="https://opencode.ai/auth" target="_blank" rel="noopener noreferrer" class="">https://opencode.ai/auth</a>.</p>
<p>Notes:</p>
<ul>
<li class="">Model refs use <code>opencode/&lt;modelId&gt;</code> (example: <code>opencode/claude-opus-4-5</code>).</li>
<li class="">If you enable an allowlist via <code>agents.defaults.models</code>, add each model you plan to use.</li>
<li class="">Shortcut: <code>moltbot onboard --auth-choice opencode-zen</code>.</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: { primary: &quot;opencode/claude-opus-4-5&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: { &quot;opencode/claude-opus-4-5&quot;: { alias: &quot;Opus&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="zai-glm-47--provider-alias-support">Z.AI (GLM-4.7) â€” provider alias support<a href="#zai-glm-47--provider-alias-support" class="hash-link" aria-label="Z.AI (GLM-4.7) â€” provider alias supportçš„ç›´æ¥é“¾æ¥" title="Z.AI (GLM-4.7) â€” provider alias supportçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Z.AI models are available via the built-in <code>zai</code> provider. Set <code>ZAI_API_KEY</code>
in your environment and reference the model by provider/model.</p>
<p>Shortcut: <code>moltbot onboard --auth-choice zai-api-key</code>.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: { primary: &quot;zai/glm-4.7&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: { &quot;zai/glm-4.7&quot;: {} }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class=""><code>z.ai/*</code> and <code>z-ai/*</code> are accepted aliases and normalize to <code>zai/*</code>.</li>
<li class="">If <code>ZAI_API_KEY</code> is missing, requests to <code>zai/*</code> will fail with an auth error at runtime.</li>
<li class="">Example error: <code>No API key found for provider &quot;zai&quot;.</code></li>
<li class="">Z.AIâ€™s general API endpoint is <code>https://api.z.ai/api/paas/v4</code>. GLM coding
requests use the dedicated Coding endpoint <code>https://api.z.ai/api/coding/paas/v4</code>.
The built-in <code>zai</code> provider uses the Coding endpoint. If you need the general
endpoint, define a custom provider in <code>models.providers</code> with the base URL
override (see the custom providers section above).</li>
<li class="">Use a fake placeholder in docs/configs; never commit real API keys.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="moonshot-ai-kimi">Moonshot AI (Kimi)<a href="#moonshot-ai-kimi" class="hash-link" aria-label="Moonshot AI (Kimi)çš„ç›´æ¥é“¾æ¥" title="Moonshot AI (Kimi)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Use Moonshot&#x27;s OpenAI-compatible endpoint:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  env: { MOONSHOT_API_KEY: &quot;sk-...&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: { primary: &quot;moonshot/kimi-k2.5&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: { &quot;moonshot/kimi-k2.5&quot;: { alias: &quot;Kimi K2.5&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;merge&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      moonshot: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;https://api.moonshot.ai/v1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;${MOONSHOT_API_KEY}&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        api: &quot;openai-completions&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            id: &quot;kimi-k2.5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            name: &quot;Kimi K2.5&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            reasoning: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            input: [&quot;text&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            cost: { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            contextWindow: 256000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            maxTokens: 8192</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Set <code>MOONSHOT_API_KEY</code> in the environment or use <code>moltbot onboard --auth-choice moonshot-api-key</code>.</li>
<li class="">Model ref: <code>moonshot/kimi-k2.5</code>.</li>
<li class="">Use <code>https://api.moonshot.cn/v1</code> if you need the China endpoint.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="kimi-code">Kimi Code<a href="#kimi-code" class="hash-link" aria-label="Kimi Codeçš„ç›´æ¥é“¾æ¥" title="Kimi Codeçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Use Kimi Code&#x27;s dedicated OpenAI-compatible endpoint (separate from Moonshot):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  env: { KIMICODE_API_KEY: &quot;sk-...&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: { primary: &quot;kimi-code/kimi-for-coding&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: { &quot;kimi-code/kimi-for-coding&quot;: { alias: &quot;Kimi Code&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;merge&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;kimi-code&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;https://api.kimi.com/coding/v1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;${KIMICODE_API_KEY}&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        api: &quot;openai-completions&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            id: &quot;kimi-for-coding&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            name: &quot;Kimi For Coding&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            reasoning: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            input: [&quot;text&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            cost: { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            contextWindow: 262144,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            maxTokens: 32768,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            headers: { &quot;User-Agent&quot;: &quot;KimiCLI/0.77&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            compat: { supportsDeveloperRole: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Set <code>KIMICODE_API_KEY</code> in the environment or use <code>moltbot onboard --auth-choice kimi-code-api-key</code>.</li>
<li class="">Model ref: <code>kimi-code/kimi-for-coding</code>.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="synthetic-anthropic-compatible">Synthetic (Anthropic-compatible)<a href="#synthetic-anthropic-compatible" class="hash-link" aria-label="Synthetic (Anthropic-compatible)çš„ç›´æ¥é“¾æ¥" title="Synthetic (Anthropic-compatible)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Use Synthetic&#x27;s Anthropic-compatible endpoint:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  env: { SYNTHETIC_API_KEY: &quot;sk-...&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: { primary: &quot;synthetic/hf:MiniMaxAI/MiniMax-M2.1&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: { &quot;synthetic/hf:MiniMaxAI/MiniMax-M2.1&quot;: { alias: &quot;MiniMax M2.1&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;merge&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      synthetic: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;https://api.synthetic.new/anthropic&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;${SYNTHETIC_API_KEY}&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        api: &quot;anthropic-messages&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            id: &quot;hf:MiniMaxAI/MiniMax-M2.1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            name: &quot;MiniMax M2.1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            reasoning: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            input: [&quot;text&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            cost: { input: 0, output: 0, cacheRead: 0, cacheWrite: 0 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            contextWindow: 192000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            maxTokens: 65536</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Set <code>SYNTHETIC_API_KEY</code> or use <code>moltbot onboard --auth-choice synthetic-api-key</code>.</li>
<li class="">Model ref: <code>synthetic/hf:MiniMaxAI/MiniMax-M2.1</code>.</li>
<li class="">Base URL should omit <code>/v1</code> because the Anthropic client appends it.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="local-models-lm-studio--recommended-setup">Local models (LM Studio) â€” recommended setup<a href="#local-models-lm-studio--recommended-setup" class="hash-link" aria-label="Local models (LM Studio) â€” recommended setupçš„ç›´æ¥é“¾æ¥" title="Local models (LM Studio) â€” recommended setupçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>See <a class="" href="/moltbot-doc/gateway/local-models">/gateway/local-models</a> for the current local guidance. TL;DR: run MiniMax M2.1 via LM Studio Responses API on serious hardware; keep hosted models merged for fallback.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="minimax-m21">MiniMax M2.1<a href="#minimax-m21" class="hash-link" aria-label="MiniMax M2.1çš„ç›´æ¥é“¾æ¥" title="MiniMax M2.1çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Use MiniMax M2.1 directly without LM Studio:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agent: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    model: { primary: &quot;minimax/MiniMax-M2.1&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;anthropic/claude-opus-4-5&quot;: { alias: &quot;Opus&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;minimax/MiniMax-M2.1&quot;: { alias: &quot;Minimax&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;merge&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      minimax: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;https://api.minimax.io/anthropic&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;${MINIMAX_API_KEY}&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        api: &quot;anthropic-messages&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            id: &quot;MiniMax-M2.1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            name: &quot;MiniMax M2.1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            reasoning: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            input: [&quot;text&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            // Pricing: update in models.json if you need exact cost tracking.</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            cost: { input: 15, output: 60, cacheRead: 2, cacheWrite: 10 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            contextWindow: 200000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">            maxTokens: 8192</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Set <code>MINIMAX_API_KEY</code> environment variable or use <code>moltbot onboard --auth-choice minimax-api</code>.</li>
<li class="">Available model: <code>MiniMax-M2.1</code> (default).</li>
<li class="">Update pricing in <code>models.json</code> if you need exact cost tracking.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cerebras-glm-46--47">Cerebras (GLM 4.6 / 4.7)<a href="#cerebras-glm-46--47" class="hash-link" aria-label="Cerebras (GLM 4.6 / 4.7)çš„ç›´æ¥é“¾æ¥" title="Cerebras (GLM 4.6 / 4.7)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Use Cerebras via their OpenAI-compatible endpoint:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  env: { CEREBRAS_API_KEY: &quot;sk-...&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  agents: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaults: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        primary: &quot;cerebras/zai-glm-4.7&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        fallbacks: [&quot;cerebras/zai-glm-4.6&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;cerebras/zai-glm-4.7&quot;: { alias: &quot;GLM 4.7 (Cerebras)&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;cerebras/zai-glm-4.6&quot;: { alias: &quot;GLM 4.6 (Cerebras)&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  models: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;merge&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    providers: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      cerebras: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        baseUrl: &quot;https://api.cerebras.ai/v1&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;${CEREBRAS_API_KEY}&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        api: &quot;openai-completions&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        models: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          { id: &quot;zai-glm-4.7&quot;, name: &quot;GLM 4.7 (Cerebras)&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          { id: &quot;zai-glm-4.6&quot;, name: &quot;GLM 4.6 (Cerebras)&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Notes:</p>
<ul>
<li class="">Use <code>cerebras/zai-glm-4.7</code> for Cerebras; use <code>zai/glm-4.7</code> for Z.AI direct.</li>
<li class="">Set <code>CEREBRAS_API_KEY</code> in the environment or config.</li>
</ul>
<p>Notes:</p>
<ul>
<li class="">Supported APIs: <code>openai-completions</code>, <code>openai-responses</code>, <code>anthropic-messages</code>,
<code>google-generative-ai</code></li>
<li class="">Use <code>authHeader: true</code> + <code>headers</code> for custom auth needs.</li>
<li class="">Override the agent config root with <code>CLAWDBOT_AGENT_DIR</code> (or <code>PI_CODING_AGENT_DIR</code>)
if you want <code>models.json</code> stored elsewhere (default: <code>~/.clawdbot/agents/main/agent</code>).</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="session"><code>session</code><a href="#session" class="hash-link" aria-label="sessionçš„ç›´æ¥é“¾æ¥" title="sessionçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls session scoping, reset policy, reset triggers, and where the session store is written.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  session: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    scope: &quot;per-sender&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    dmScope: &quot;main&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    identityLinks: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      alice: [&quot;telegram:123456789&quot;, &quot;discord:987654321012345678&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    reset: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mode: &quot;daily&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      atHour: 4,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      idleMinutes: 60</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    resetByType: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      thread: { mode: &quot;daily&quot;, atHour: 4 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      dm: { mode: &quot;idle&quot;, idleMinutes: 240 },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      group: { mode: &quot;idle&quot;, idleMinutes: 120 }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    resetTriggers: [&quot;/new&quot;, &quot;/reset&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // Default is already per-agent under ~/.clawdbot/agents/&lt;agentId&gt;/sessions/sessions.json</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // You can override with {agentId} templating:</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    store: &quot;~/.clawdbot/agents/{agentId}/sessions/sessions.json&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // Direct chats collapse to agent:&lt;agentId&gt;:&lt;mainKey&gt; (default: &quot;main&quot;).</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mainKey: &quot;main&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    agentToAgent: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Max ping-pong reply turns between requester/target (0â€“5).</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      maxPingPongTurns: 5</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    sendPolicy: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      rules: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        { action: &quot;deny&quot;, match: { channel: &quot;discord&quot;, chatType: &quot;group&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      default: &quot;allow&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Fields:</p>
<ul>
<li class=""><code>mainKey</code>: direct-chat bucket key (default: <code>&quot;main&quot;</code>). Useful when you want to â€œrenameâ€ the primary DM thread without changing <code>agentId</code>.
<ul>
<li class="">Sandbox note: <code>agents.defaults.sandbox.mode: &quot;non-main&quot;</code> uses this key to detect the main session. Any session key that does not match <code>mainKey</code> (groups/channels) is sandboxed.</li>
</ul>
</li>
<li class=""><code>dmScope</code>: how DM sessions are grouped (default: <code>&quot;main&quot;</code>).
<ul>
<li class=""><code>main</code>: all DMs share the main session for continuity.</li>
<li class=""><code>per-peer</code>: isolate DMs by sender id across channels.</li>
<li class=""><code>per-channel-peer</code>: isolate DMs per channel + sender (recommended for multi-user inboxes).</li>
<li class=""><code>per-account-channel-peer</code>: isolate DMs per account + channel + sender (recommended for multi-account inboxes).</li>
</ul>
</li>
<li class=""><code>identityLinks</code>: map canonical ids to provider-prefixed peers so the same person shares a DM session across channels when using <code>per-peer</code>, <code>per-channel-peer</code>, or <code>per-account-channel-peer</code>.
<ul>
<li class="">Example: <code>alice: [&quot;telegram:123456789&quot;, &quot;discord:987654321012345678&quot;]</code>.</li>
</ul>
</li>
<li class=""><code>reset</code>: primary reset policy. Defaults to daily resets at 4:00 AM local time on the gateway host.
<ul>
<li class=""><code>mode</code>: <code>daily</code> or <code>idle</code> (default: <code>daily</code> when <code>reset</code> is present).</li>
<li class=""><code>atHour</code>: local hour (0-23) for the daily reset boundary.</li>
<li class=""><code>idleMinutes</code>: sliding idle window in minutes. When daily + idle are both configured, whichever expires first wins.</li>
</ul>
</li>
<li class=""><code>resetByType</code>: per-session overrides for <code>dm</code>, <code>group</code>, and <code>thread</code>.
<ul>
<li class="">If you only set legacy <code>session.idleMinutes</code> without any <code>reset</code>/<code>resetByType</code>, Moltbot stays in idle-only mode for backward compatibility.</li>
</ul>
</li>
<li class=""><code>heartbeatIdleMinutes</code>: optional idle override for heartbeat checks (daily reset still applies when enabled).</li>
<li class=""><code>agentToAgent.maxPingPongTurns</code>: max reply-back turns between requester/target (0â€“5, default 5).</li>
<li class=""><code>sendPolicy.default</code>: <code>allow</code> or <code>deny</code> fallback when no rule matches.</li>
<li class=""><code>sendPolicy.rules[]</code>: match by <code>channel</code>, <code>chatType</code> (<code>direct|group|room</code>), or <code>keyPrefix</code> (e.g. <code>cron:</code>). First deny wins; otherwise allow.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="skills-skills-config"><code>skills</code> (skills config)<a href="#skills-skills-config" class="hash-link" aria-label="skills-skills-configçš„ç›´æ¥é“¾æ¥" title="skills-skills-configçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls bundled allowlist, install preferences, extra skill folders, and per-skill
overrides. Applies to <strong>bundled</strong> skills and <code>~/.clawdbot/skills</code> (workspace skills
still win on name conflicts).</p>
<p>Fields:</p>
<ul>
<li class=""><code>allowBundled</code>: optional allowlist for <strong>bundled</strong> skills only. If set, only those
bundled skills are eligible (managed/workspace skills unaffected).</li>
<li class=""><code>load.extraDirs</code>: additional skill directories to scan (lowest precedence).</li>
<li class=""><code>install.preferBrew</code>: prefer brew installers when available (default: true).</li>
<li class=""><code>install.nodeManager</code>: node installer preference (<code>npm</code> | <code>pnpm</code> | <code>yarn</code>, default: npm).</li>
<li class=""><code>entries.&lt;skillKey&gt;</code>: per-skill config overrides.</li>
</ul>
<p>Per-skill fields:</p>
<ul>
<li class=""><code>enabled</code>: set <code>false</code> to disable a skill even if itâ€™s bundled/installed.</li>
<li class=""><code>env</code>: environment variables injected for the agent run (only if not already set).</li>
<li class=""><code>apiKey</code>: optional convenience for skills that declare a primary env var (e.g. <code>nano-banana-pro</code> â†’ <code>GEMINI_API_KEY</code>).</li>
</ul>
<p>Example:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  skills: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    allowBundled: [&quot;gemini&quot;, &quot;peekaboo&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    load: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      extraDirs: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;~/Projects/agent-scripts/skills&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        &quot;~/Projects/oss/some-skill-pack/skills&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      ]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    install: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      preferBrew: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      nodeManager: &quot;npm&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    entries: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;nano-banana-pro&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        apiKey: &quot;GEMINI_KEY_HERE&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        env: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          GEMINI_API_KEY: &quot;GEMINI_KEY_HERE&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      peekaboo: { enabled: true },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      sag: { enabled: false }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="plugins-extensions"><code>plugins</code> (extensions)<a href="#plugins-extensions" class="hash-link" aria-label="plugins-extensionsçš„ç›´æ¥é“¾æ¥" title="plugins-extensionsçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls plugin discovery, allow/deny, and per-plugin config. Plugins are loaded
from <code>~/.clawdbot/extensions</code>, <code>&lt;workspace&gt;/.clawdbot/extensions</code>, plus any
<code>plugins.load.paths</code> entries. <strong>Config changes require a gateway restart.</strong>
See <a class="" href="/moltbot-doc/plugin">/plugin</a> for full usage.</p>
<p>Fields:</p>
<ul>
<li class=""><code>enabled</code>: master toggle for plugin loading (default: true).</li>
<li class=""><code>allow</code>: optional allowlist of plugin ids; when set, only listed plugins load.</li>
<li class=""><code>deny</code>: optional denylist of plugin ids (deny wins).</li>
<li class=""><code>load.paths</code>: extra plugin files or directories to load (absolute or <code>~</code>).</li>
<li class=""><code>entries.&lt;pluginId&gt;</code>: per-plugin overrides.
<ul>
<li class=""><code>enabled</code>: set <code>false</code> to disable.</li>
<li class=""><code>config</code>: plugin-specific config object (validated by the plugin if provided).</li>
</ul>
</li>
</ul>
<p>Example:</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  plugins: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    allow: [&quot;voice-call&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    load: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      paths: [&quot;~/Projects/oss/voice-call-extension&quot;]</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    entries: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      &quot;voice-call&quot;: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        config: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          provider: &quot;twilio&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="browser-clawd-managed-browser"><code>browser</code> (clawd-managed browser)<a href="#browser-clawd-managed-browser" class="hash-link" aria-label="browser-clawd-managed-browserçš„ç›´æ¥é“¾æ¥" title="browser-clawd-managed-browserçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Moltbot can start a <strong>dedicated, isolated</strong> Chrome/Brave/Edge/Chromium instance for clawd and expose a small loopback control service.
Profiles can point at a <strong>remote</strong> Chromium-based browser via <code>profiles.&lt;name&gt;.cdpUrl</code>. Remote
profiles are attach-only (start/stop/reset are disabled).</p>
<p><code>browser.cdpUrl</code> remains for legacy single-profile configs and as the base
scheme/host for profiles that only set <code>cdpPort</code>.</p>
<p>Defaults:</p>
<ul>
<li class="">enabled: <code>true</code></li>
<li class="">evaluateEnabled: <code>true</code> (set <code>false</code> to disable <code>act:evaluate</code> and <code>wait --fn</code>)</li>
<li class="">control service: loopback only (port derived from <code>gateway.port</code>, default <code>18791</code>)</li>
<li class="">CDP URL: <code>http://127.0.0.1:18792</code> (control service + 1, legacy single-profile)</li>
<li class="">profile color: <code>#FF4500</code> (lobster-orange)</li>
<li class="">Note: the control server is started by the running gateway (Moltbot.app menubar, or <code>moltbot gateway</code>).</li>
<li class="">Auto-detect order: default browser if Chromium-based; otherwise Chrome â†’ Brave â†’ Edge â†’ Chromium â†’ Chrome Canary.</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  browser: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    evaluateEnabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // cdpUrl: &quot;http://127.0.0.1:18792&quot;, // legacy single-profile override</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    defaultProfile: &quot;chrome&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    profiles: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      clawd: { cdpPort: 18800, color: &quot;#FF4500&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      work: { cdpPort: 18801, color: &quot;#0066CC&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      remote: { cdpUrl: &quot;http://10.0.0.42:9222&quot;, color: &quot;#00AA00&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    color: &quot;#FF4500&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // Advanced:</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // headless: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // noSandbox: false,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // executablePath: &quot;/Applications/Brave Browser.app/Contents/MacOS/Brave Browser&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // attachOnly: false, // set true when tunneling a remote CDP to localhost</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="ui-appearance"><code>ui</code> (Appearance)<a href="#ui-appearance" class="hash-link" aria-label="ui-appearanceçš„ç›´æ¥é“¾æ¥" title="ui-appearanceçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Optional accent color used by the native apps for UI chrome (e.g. Talk Mode bubble tint).</p>
<p>If unset, clients fall back to a muted light-blue.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  ui: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    seamColor: &quot;#FF4500&quot;, // hex (RRGGBB or #RRGGBB)</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // Optional: Control UI assistant identity override.</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // If unset, the Control UI uses the active agent identity (config or IDENTITY.md).</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    assistant: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      name: &quot;Moltbot&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      avatar: &quot;CB&quot; // emoji, short text, or image URL/data URI</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gateway-gateway-server-mode--bind"><code>gateway</code> (Gateway server mode + bind)<a href="#gateway-gateway-server-mode--bind" class="hash-link" aria-label="gateway-gateway-server-mode--bindçš„ç›´æ¥é“¾æ¥" title="gateway-gateway-server-mode--bindçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Use <code>gateway.mode</code> to explicitly declare whether this machine should run the Gateway.</p>
<p>Defaults:</p>
<ul>
<li class="">mode: <strong>unset</strong> (treated as â€œdo not auto-startâ€)</li>
<li class="">bind: <code>loopback</code></li>
<li class="">port: <code>18789</code> (single port for WS + HTTP)</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  gateway: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;local&quot;, // or &quot;remote&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    port: 18789, // WS + HTTP multiplex</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    bind: &quot;loopback&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // controlUi: { enabled: true, basePath: &quot;/moltbot&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // auth: { mode: &quot;token&quot;, token: &quot;your-token&quot; } // token gates WS + Control UI access</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    // tailscale: { mode: &quot;off&quot; | &quot;serve&quot; | &quot;funnel&quot; }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Control UI base path:</p>
<ul>
<li class=""><code>gateway.controlUi.basePath</code> sets the URL prefix where the Control UI is served.</li>
<li class="">Examples: <code>&quot;/ui&quot;</code>, <code>&quot;/moltbot&quot;</code>, <code>&quot;/apps/moltbot&quot;</code>.</li>
<li class="">Default: root (<code>/</code>) (unchanged).</li>
<li class=""><code>gateway.controlUi.allowInsecureAuth</code> allows token-only auth for the Control UI when
device identity is omitted (typically over HTTP). Default: <code>false</code>. Prefer HTTPS
(Tailscale Serve) or <code>127.0.0.1</code>.</li>
<li class=""><code>gateway.controlUi.dangerouslyDisableDeviceAuth</code> disables device identity checks for the
Control UI (token/password only). Default: <code>false</code>. Break-glass only.</li>
</ul>
<p>Related docs:</p>
<ul>
<li class=""><a class="" href="/moltbot-doc/web/control-ui">Control UI</a></li>
<li class=""><a class="" href="/moltbot-doc/web">Web overview</a></li>
<li class=""><a class="" href="/moltbot-doc/gateway/tailscale">Tailscale</a></li>
<li class=""><a class="" href="/moltbot-doc/gateway/remote">Remote access</a></li>
</ul>
<p>Trusted proxies:</p>
<ul>
<li class=""><code>gateway.trustedProxies</code>: list of reverse proxy IPs that terminate TLS in front of the Gateway.</li>
<li class="">When a connection comes from one of these IPs, Moltbot uses <code>x-forwarded-for</code> (or <code>x-real-ip</code>) to determine the client IP for local pairing checks and HTTP auth/local checks.</li>
<li class="">Only list proxies you fully control, and ensure they <strong>overwrite</strong> incoming <code>x-forwarded-for</code>.</li>
</ul>
<p>Notes:</p>
<ul>
<li class=""><code>moltbot gateway</code> refuses to start unless <code>gateway.mode</code> is set to <code>local</code> (or you pass the override flag).</li>
<li class=""><code>gateway.port</code> controls the single multiplexed port used for WebSocket + HTTP (control UI, hooks, A2UI).</li>
<li class="">OpenAI Chat Completions endpoint: <strong>disabled by default</strong>; enable with <code>gateway.http.endpoints.chatCompletions.enabled: true</code>.</li>
<li class="">Precedence: <code>--port</code> &gt; <code>CLAWDBOT_GATEWAY_PORT</code> &gt; <code>gateway.port</code> &gt; default <code>18789</code>.</li>
<li class="">Gateway auth is required by default (token/password or Tailscale Serve identity). Non-loopback binds require a shared token/password.</li>
<li class="">The onboarding wizard generates a gateway token by default (even on loopback).</li>
<li class=""><code>gateway.remote.token</code> is <strong>only</strong> for remote CLI calls; it does not enable local gateway auth. <code>gateway.token</code> is ignored.</li>
</ul>
<p>Auth and Tailscale:</p>
<ul>
<li class=""><code>gateway.auth.mode</code> sets the handshake requirements (<code>token</code> or <code>password</code>). When unset, token auth is assumed.</li>
<li class=""><code>gateway.auth.token</code> stores the shared token for token auth (used by the CLI on the same machine).</li>
<li class="">When <code>gateway.auth.mode</code> is set, only that method is accepted (plus optional Tailscale headers).</li>
<li class=""><code>gateway.auth.password</code> can be set here, or via <code>CLAWDBOT_GATEWAY_PASSWORD</code> (recommended).</li>
<li class=""><code>gateway.auth.allowTailscale</code> allows Tailscale Serve identity headers
(<code>tailscale-user-login</code>) to satisfy auth when the request arrives on loopback
with <code>x-forwarded-for</code>, <code>x-forwarded-proto</code>, and <code>x-forwarded-host</code>. Moltbot
verifies the identity by resolving the <code>x-forwarded-for</code> address via
<code>tailscale whois</code> before accepting it. When <code>true</code>, Serve requests do not need
a token/password; set <code>false</code> to require explicit credentials. Defaults to
<code>true</code> when <code>tailscale.mode = &quot;serve&quot;</code> and auth mode is not <code>password</code>.</li>
<li class=""><code>gateway.tailscale.mode: &quot;serve&quot;</code> uses Tailscale Serve (tailnet only, loopback bind).</li>
<li class=""><code>gateway.tailscale.mode: &quot;funnel&quot;</code> exposes the dashboard publicly; requires auth.</li>
<li class=""><code>gateway.tailscale.resetOnExit</code> resets Serve/Funnel config on shutdown.</li>
</ul>
<p>Remote client defaults (CLI):</p>
<ul>
<li class=""><code>gateway.remote.url</code> sets the default Gateway WebSocket URL for CLI calls when <code>gateway.mode = &quot;remote&quot;</code>.</li>
<li class=""><code>gateway.remote.transport</code> selects the macOS remote transport (<code>ssh</code> default, <code>direct</code> for ws/wss). When <code>direct</code>, <code>gateway.remote.url</code> must be <code>ws://</code> or <code>wss://</code>. <code>ws://host</code> defaults to port <code>18789</code>.</li>
<li class=""><code>gateway.remote.token</code> supplies the token for remote calls (leave unset for no auth).</li>
<li class=""><code>gateway.remote.password</code> supplies the password for remote calls (leave unset for no auth).</li>
</ul>
<p>macOS app behavior:</p>
<ul>
<li class="">Moltbot.app watches <code>~/.clawdbot/moltbot.json</code> and switches modes live when <code>gateway.mode</code> or <code>gateway.remote.url</code> changes.</li>
<li class="">If <code>gateway.mode</code> is unset but <code>gateway.remote.url</code> is set, the macOS app treats it as remote mode.</li>
<li class="">When you change connection mode in the macOS app, it writes <code>gateway.mode</code> (and <code>gateway.remote.url</code> + <code>gateway.remote.transport</code> in remote mode) back to the config file.</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  gateway: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;remote&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    remote: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      url: &quot;ws://gateway.tailnet:18789&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      token: &quot;your-token&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      password: &quot;your-password&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Direct transport example (macOS app):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  gateway: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mode: &quot;remote&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    remote: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      transport: &quot;direct&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      url: &quot;wss://gateway.example.ts.net&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      token: &quot;your-token&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="gatewayreload-config-hot-reload"><code>gateway.reload</code> (Config hot reload)<a href="#gatewayreload-config-hot-reload" class="hash-link" aria-label="gatewayreload-config-hot-reloadçš„ç›´æ¥é“¾æ¥" title="gatewayreload-config-hot-reloadçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>The Gateway watches <code>~/.clawdbot/moltbot.json</code> (or <code>CLAWDBOT_CONFIG_PATH</code>) and applies changes automatically.</p>
<p>Modes:</p>
<ul>
<li class=""><code>hybrid</code> (default): hot-apply safe changes; restart the Gateway for critical changes.</li>
<li class=""><code>hot</code>: only apply hot-safe changes; log when a restart is required.</li>
<li class=""><code>restart</code>: restart the Gateway on any config change.</li>
<li class=""><code>off</code>: disable hot reload.</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  gateway: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    reload: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      mode: &quot;hybrid&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      debounceMs: 300</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="hot-reload-matrix-files--impact">Hot reload matrix (files + impact)<a href="#hot-reload-matrix-files--impact" class="hash-link" aria-label="Hot reload matrix (files + impact)çš„ç›´æ¥é“¾æ¥" title="Hot reload matrix (files + impact)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h4>
<p>Files watched:</p>
<ul>
<li class=""><code>~/.clawdbot/moltbot.json</code> (or <code>CLAWDBOT_CONFIG_PATH</code>)</li>
</ul>
<p>Hot-applied (no full gateway restart):</p>
<ul>
<li class=""><code>hooks</code> (webhook auth/path/mappings) + <code>hooks.gmail</code> (Gmail watcher restarted)</li>
<li class=""><code>browser</code> (browser control server restart)</li>
<li class=""><code>cron</code> (cron service restart + concurrency update)</li>
<li class=""><code>agents.defaults.heartbeat</code> (heartbeat runner restart)</li>
<li class=""><code>web</code> (WhatsApp web channel restart)</li>
<li class=""><code>telegram</code>, <code>discord</code>, <code>signal</code>, <code>imessage</code> (channel restarts)</li>
<li class=""><code>agent</code>, <code>models</code>, <code>routing</code>, <code>messages</code>, <code>session</code>, <code>whatsapp</code>, <code>logging</code>, <code>skills</code>, <code>ui</code>, <code>talk</code>, <code>identity</code>, <code>wizard</code> (dynamic reads)</li>
</ul>
<p>Requires full Gateway restart:</p>
<ul>
<li class=""><code>gateway</code> (port/bind/auth/control UI/tailscale)</li>
<li class=""><code>bridge</code> (legacy)</li>
<li class=""><code>discovery</code></li>
<li class=""><code>canvasHost</code></li>
<li class=""><code>plugins</code></li>
<li class="">Any unknown/unsupported config path (defaults to restart for safety)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="multi-instance-isolation">Multi-instance isolation<a href="#multi-instance-isolation" class="hash-link" aria-label="Multi-instance isolationçš„ç›´æ¥é“¾æ¥" title="Multi-instance isolationçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>To run multiple gateways on one host (for redundancy or a rescue bot), isolate per-instance state + config and use unique ports:</p>
<ul>
<li class=""><code>CLAWDBOT_CONFIG_PATH</code> (per-instance config)</li>
<li class=""><code>CLAWDBOT_STATE_DIR</code> (sessions/creds)</li>
<li class=""><code>agents.defaults.workspace</code> (memories)</li>
<li class=""><code>gateway.port</code> (unique per instance)</li>
</ul>
<p>Convenience flags (CLI):</p>
<ul>
<li class=""><code>moltbot --dev â€¦</code> â†’ uses <code>~/.clawdbot-dev</code> + shifts ports from base <code>19001</code></li>
<li class=""><code>moltbot --profile &lt;name&gt; â€¦</code> â†’ uses <code>~/.clawdbot-&lt;name&gt;</code> (port via config/env/flags)</li>
</ul>
<p>See <a class="" href="/moltbot-doc/gateway">Gateway runbook</a> for the derived port mapping (gateway/browser/canvas).
See <a class="" href="/moltbot-doc/gateway/multiple-gateways">Multiple gateways</a> for browser/CDP port isolation details.</p>
<p>Example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">CLAWDBOT_CONFIG_PATH=~/.clawdbot/a.json \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">CLAWDBOT_STATE_DIR=~/.clawdbot-a \</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">moltbot gateway --port 19001</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="hooks-gateway-webhooks"><code>hooks</code> (Gateway webhooks)<a href="#hooks-gateway-webhooks" class="hash-link" aria-label="hooks-gateway-webhooksçš„ç›´æ¥é“¾æ¥" title="hooks-gateway-webhooksçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Enable a simple HTTP webhook endpoint on the Gateway HTTP server.</p>
<p>Defaults:</p>
<ul>
<li class="">enabled: <code>false</code></li>
<li class="">path: <code>/hooks</code></li>
<li class="">maxBodyBytes: <code>262144</code> (256 KB)</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  hooks: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    token: &quot;shared-secret&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    path: &quot;/hooks&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    presets: [&quot;gmail&quot;],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    transformsDir: &quot;~/.clawdbot/hooks&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    mappings: [</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        match: { path: &quot;gmail&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        action: &quot;agent&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        wakeMode: &quot;now&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        name: &quot;Gmail&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        sessionKey: &quot;hook:gmail:{{messages[0].id}}&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        messageTemplate:</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">          &quot;From: {{messages[0].from}}\nSubject: {{messages[0].subject}}\n{{messages[0].snippet}}&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        deliver: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        channel: &quot;last&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">        model: &quot;openai/gpt-5.2-mini&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    ],</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Requests must include the hook token:</p>
<ul>
<li class=""><code>Authorization: Bearer &lt;token&gt;</code> <strong>or</strong></li>
<li class=""><code>x-moltbot-token: &lt;token&gt;</code> <strong>or</strong></li>
<li class=""><code>?token=&lt;token&gt;</code></li>
</ul>
<p>Endpoints:</p>
<ul>
<li class=""><code>POST /hooks/wake</code> â†’ <code>{ text, mode?: &quot;now&quot;|&quot;next-heartbeat&quot; }</code></li>
<li class=""><code>POST /hooks/agent</code> â†’ <code>{ message, name?, sessionKey?, wakeMode?, deliver?, channel?, to?, model?, thinking?, timeoutSeconds? }</code></li>
<li class=""><code>POST /hooks/&lt;name&gt;</code> â†’ resolved via <code>hooks.mappings</code></li>
</ul>
<p><code>/hooks/agent</code> always posts a summary into the main session (and can optionally trigger an immediate heartbeat via <code>wakeMode: &quot;now&quot;</code>).</p>
<p>Mapping notes:</p>
<ul>
<li class=""><code>match.path</code> matches the sub-path after <code>/hooks</code> (e.g. <code>/hooks/gmail</code> â†’ <code>gmail</code>).</li>
<li class=""><code>match.source</code> matches a payload field (e.g. <code>{ source: &quot;gmail&quot; }</code>) so you can use a generic <code>/hooks/ingest</code> path.</li>
<li class="">Templates like <code>{{messages[0].subject}}</code> read from the payload.</li>
<li class=""><code>transform</code> can point to a JS/TS module that returns a hook action.</li>
<li class=""><code>deliver: true</code> sends the final reply to a channel; <code>channel</code> defaults to <code>last</code> (falls back to WhatsApp).</li>
<li class="">If there is no prior delivery route, set <code>channel</code> + <code>to</code> explicitly (required for Telegram/Discord/Google Chat/Slack/Signal/iMessage/MS Teams).</li>
<li class=""><code>model</code> overrides the LLM for this hook run (<code>provider/model</code> or alias; must be allowed if <code>agents.defaults.models</code> is set).</li>
</ul>
<p>Gmail helper config (used by <code>moltbot webhooks gmail setup</code> / <code>run</code>):</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  hooks: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    gmail: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      account: &quot;moltbot@gmail.com&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      topic: &quot;projects/&lt;project-id&gt;/topics/gog-gmail-watch&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      subscription: &quot;gog-gmail-watch-push&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      pushToken: &quot;shared-push-token&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      hookUrl: &quot;http://127.0.0.1:18789/hooks/gmail&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      includeBody: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      maxBytes: 20000,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      renewEveryMinutes: 720,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      serve: { bind: &quot;127.0.0.1&quot;, port: 8788, path: &quot;/&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      tailscale: { mode: &quot;funnel&quot;, path: &quot;/gmail-pubsub&quot; },</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Optional: use a cheaper model for Gmail hook processing</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Falls back to agents.defaults.model.fallbacks, then primary, on auth/rate-limit/timeout</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      model: &quot;openrouter/meta-llama/llama-3.3-70b-instruct:free&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Optional: default thinking level for Gmail hooks</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      thinking: &quot;off&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Model override for Gmail hooks:</p>
<ul>
<li class=""><code>hooks.gmail.model</code> specifies a model to use for Gmail hook processing (defaults to session primary).</li>
<li class="">Accepts <code>provider/model</code> refs or aliases from <code>agents.defaults.models</code>.</li>
<li class="">Falls back to <code>agents.defaults.model.fallbacks</code>, then <code>agents.defaults.model.primary</code>, on auth/rate-limit/timeouts.</li>
<li class="">If <code>agents.defaults.models</code> is set, include the hooks model in the allowlist.</li>
<li class="">At startup, warns if the configured model is not in the model catalog or allowlist.</li>
<li class=""><code>hooks.gmail.thinking</code> sets the default thinking level for Gmail hooks and is overridden by per-hook <code>thinking</code>.</li>
</ul>
<p>Gateway auto-start:</p>
<ul>
<li class="">If <code>hooks.enabled=true</code> and <code>hooks.gmail.account</code> is set, the Gateway starts
<code>gog gmail watch serve</code> on boot and auto-renews the watch.</li>
<li class="">Set <code>CLAWDBOT_SKIP_GMAIL_WATCHER=1</code> to disable the auto-start (for manual runs).</li>
<li class="">Avoid running a separate <code>gog gmail watch serve</code> alongside the Gateway; it will
fail with <code>listen tcp 127.0.0.1:8788: bind: address already in use</code>.</li>
</ul>
<p>Note: when <code>tailscale.mode</code> is on, Moltbot defaults <code>serve.path</code> to <code>/</code> so
Tailscale can proxy <code>/gmail-pubsub</code> correctly (it strips the set-path prefix).
If you need the backend to receive the prefixed path, set
<code>hooks.gmail.tailscale.target</code> to a full URL (and align <code>serve.path</code>).</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="canvashost-lantailnet-canvas-file-server--live-reload"><code>canvasHost</code> (LAN/tailnet Canvas file server + live reload)<a href="#canvashost-lantailnet-canvas-file-server--live-reload" class="hash-link" aria-label="canvashost-lantailnet-canvas-file-server--live-reloadçš„ç›´æ¥é“¾æ¥" title="canvashost-lantailnet-canvas-file-server--live-reloadçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>The Gateway serves a directory of HTML/CSS/JS over HTTP so iOS/Android nodes can simply <code>canvas.navigate</code> to it.</p>
<p>Default root: <code>~/clawd/canvas</code><br>
Default port: <code>18793</code> (chosen to avoid the clawd browser CDP port <code>18792</code>)<br>
The server listens on the <strong>gateway bind host</strong> (LAN or Tailnet) so nodes can reach it.</p>
<p>The server:</p>
<ul>
<li class="">serves files under <code>canvasHost.root</code></li>
<li class="">injects a tiny live-reload client into served HTML</li>
<li class="">watches the directory and broadcasts reloads over a WebSocket endpoint at <code>/__moltbot/ws</code></li>
<li class="">auto-creates a starter <code>index.html</code> when the directory is empty (so you see something immediately)</li>
<li class="">also serves A2UI at <code>/__moltbot__/a2ui/</code> and is advertised to nodes as <code>canvasHostUrl</code>
(always used by nodes for Canvas/A2UI)</li>
</ul>
<p>Disable live reload (and file watching) if the directory is large or you hit <code>EMFILE</code>:</p>
<ul>
<li class="">config: <code>canvasHost: { liveReload: false }</code></li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  canvasHost: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    root: &quot;~/clawd/canvas&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    port: 18793,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    liveReload: true</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Changes to <code>canvasHost.*</code> require a gateway restart (config reload will restart).</p>
<p>Disable with:</p>
<ul>
<li class="">config: <code>canvasHost: { enabled: false }</code></li>
<li class="">env: <code>CLAWDBOT_SKIP_CANVAS_HOST=1</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="bridge-legacy-tcp-bridge-removed"><code>bridge</code> (legacy TCP bridge, removed)<a href="#bridge-legacy-tcp-bridge-removed" class="hash-link" aria-label="bridge-legacy-tcp-bridge-removedçš„ç›´æ¥é“¾æ¥" title="bridge-legacy-tcp-bridge-removedçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Current builds no longer include the TCP bridge listener; <code>bridge.*</code> config keys are ignored.
Nodes connect over the Gateway WebSocket. This section is kept for historical reference.</p>
<p>Legacy behavior:</p>
<ul>
<li class="">The Gateway could expose a simple TCP bridge for nodes (iOS/Android), typically on port <code>18790</code>.</li>
</ul>
<p>Defaults:</p>
<ul>
<li class="">enabled: <code>true</code></li>
<li class="">port: <code>18790</code></li>
<li class="">bind: <code>lan</code> (binds to <code>0.0.0.0</code>)</li>
</ul>
<p>Bind modes:</p>
<ul>
<li class=""><code>lan</code>: <code>0.0.0.0</code> (reachable on any interface, including LAN/Wiâ€‘Fi and Tailscale)</li>
<li class=""><code>tailnet</code>: bind only to the machineâ€™s Tailscale IP (recommended for Vienna â‡„ London)</li>
<li class=""><code>loopback</code>: <code>127.0.0.1</code> (local only)</li>
<li class=""><code>auto</code>: prefer tailnet IP if present, else <code>lan</code></li>
</ul>
<p>TLS:</p>
<ul>
<li class=""><code>bridge.tls.enabled</code>: enable TLS for bridge connections (TLS-only when enabled).</li>
<li class=""><code>bridge.tls.autoGenerate</code>: generate a self-signed cert when no cert/key are present (default: true).</li>
<li class=""><code>bridge.tls.certPath</code> / <code>bridge.tls.keyPath</code>: PEM paths for the bridge certificate + private key.</li>
<li class=""><code>bridge.tls.caPath</code>: optional PEM CA bundle (custom roots or future mTLS).</li>
</ul>
<p>When TLS is enabled, the Gateway advertises <code>bridgeTls=1</code> and <code>bridgeTlsSha256</code> in discovery TXT
records so nodes can pin the certificate. Manual connections use trust-on-first-use if no
fingerprint is stored yet.
Auto-generated certs require <code>openssl</code> on PATH; if generation fails, the bridge will not start.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  bridge: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    port: 18790,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    bind: &quot;tailnet&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    tls: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // Uses ~/.clawdbot/bridge/tls/bridge-{cert,key}.pem when omitted.</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // certPath: &quot;~/.clawdbot/bridge/tls/bridge-cert.pem&quot;,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">      // keyPath: &quot;~/.clawdbot/bridge/tls/bridge-key.pem&quot;</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="discoverymdns-bonjour--mdns-broadcast-mode"><code>discovery.mdns</code> (Bonjour / mDNS broadcast mode)<a href="#discoverymdns-bonjour--mdns-broadcast-mode" class="hash-link" aria-label="discoverymdns-bonjour--mdns-broadcast-modeçš„ç›´æ¥é“¾æ¥" title="discoverymdns-bonjour--mdns-broadcast-modeçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>Controls LAN mDNS discovery broadcasts (<code>_moltbot-gw._tcp</code>).</p>
<ul>
<li class=""><code>minimal</code> (default): omit <code>cliPath</code> + <code>sshPort</code> from TXT records</li>
<li class=""><code>full</code>: include <code>cliPath</code> + <code>sshPort</code> in TXT records</li>
<li class=""><code>off</code>: disable mDNS broadcasts entirely</li>
</ul>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  discovery: { mdns: { mode: &quot;minimal&quot; } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="discoverywidearea-wide-area-bonjour--unicast-dnssd"><code>discovery.wideArea</code> (Wide-Area Bonjour / unicast DNSâ€‘SD)<a href="#discoverywidearea-wide-area-bonjour--unicast-dnssd" class="hash-link" aria-label="discoverywidearea-wide-area-bonjour--unicast-dnssdçš„ç›´æ¥é“¾æ¥" title="discoverywidearea-wide-area-bonjour--unicast-dnssdçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h3>
<p>When enabled, the Gateway writes a unicast DNS-SD zone for <code>_moltbot-bridge._tcp</code> under <code>~/.clawdbot/dns/</code> using the standard discovery domain <code>moltbot.internal.</code></p>
<p>To make iOS/Android discover across networks (Vienna â‡„ London), pair this with:</p>
<ul>
<li class="">a DNS server on the gateway host serving <code>moltbot.internal.</code> (CoreDNS is recommended)</li>
<li class="">Tailscale <strong>split DNS</strong> so clients resolve <code>moltbot.internal</code> via that server</li>
</ul>
<p>One-time setup helper (gateway host):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">moltbot dns setup --apply</span><br></span></code></pre></div></div>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  discovery: { wideArea: { enabled: true } }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="template-variables-1">Template variables<a href="#template-variables-1" class="hash-link" aria-label="Template variablesçš„ç›´æ¥é“¾æ¥" title="Template variablesçš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>Template placeholders are expanded in <code>tools.media.*.models[].args</code> and <code>tools.media.models[].args</code> (and any future templated argument fields).</p>

























































































<table><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>{{Body}}</code></td><td>Full inbound message body</td></tr><tr><td><code>{{RawBody}}</code></td><td>Raw inbound message body (no history/sender wrappers; best for command parsing)</td></tr><tr><td><code>{{BodyStripped}}</code></td><td>Body with group mentions stripped (best default for agents)</td></tr><tr><td><code>{{From}}</code></td><td>Sender identifier (E.164 for WhatsApp; may differ per channel)</td></tr><tr><td><code>{{To}}</code></td><td>Destination identifier</td></tr><tr><td><code>{{MessageSid}}</code></td><td>Channel message id (when available)</td></tr><tr><td><code>{{SessionId}}</code></td><td>Current session UUID</td></tr><tr><td><code>{{IsNewSession}}</code></td><td><code>&quot;true&quot;</code> when a new session was created</td></tr><tr><td><code>{{MediaUrl}}</code></td><td>Inbound media pseudo-URL (if present)</td></tr><tr><td><code>{{MediaPath}}</code></td><td>Local media path (if downloaded)</td></tr><tr><td><code>{{MediaType}}</code></td><td>Media type (image/audio/document/â€¦)</td></tr><tr><td><code>{{Transcript}}</code></td><td>Audio transcript (when enabled)</td></tr><tr><td><code>{{Prompt}}</code></td><td>Resolved media prompt for CLI entries</td></tr><tr><td><code>{{MaxChars}}</code></td><td>Resolved max output chars for CLI entries</td></tr><tr><td><code>{{ChatType}}</code></td><td><code>&quot;direct&quot;</code> or <code>&quot;group&quot;</code></td></tr><tr><td><code>{{GroupSubject}}</code></td><td>Group subject (best effort)</td></tr><tr><td><code>{{GroupMembers}}</code></td><td>Group members preview (best effort)</td></tr><tr><td><code>{{SenderName}}</code></td><td>Sender display name (best effort)</td></tr><tr><td><code>{{SenderE164}}</code></td><td>Sender phone number (best effort)</td></tr><tr><td><code>{{Provider}}</code></td><td>Provider hint (whatsapp</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="cron-gateway-scheduler">Cron (Gateway scheduler)<a href="#cron-gateway-scheduler" class="hash-link" aria-label="Cron (Gateway scheduler)çš„ç›´æ¥é“¾æ¥" title="Cron (Gateway scheduler)çš„ç›´æ¥é“¾æ¥" translate="no">â€‹</a></h2>
<p>Cron is a Gateway-owned scheduler for wakeups and scheduled jobs. See <a class="" href="/moltbot-doc/automation/cron-jobs">Cron jobs</a> for the feature overview and CLI examples.</p>
<div class="language-json5 codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#D6DEEB;--prism-background-color:#001122"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json5 codeBlock_bY9V thin-scrollbar" style="color:#D6DEEB;background-color:#001122"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#D6DEEB"><span class="token plain">{</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  cron: {</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    enabled: true,</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">    maxConcurrentRuns: 2</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#D6DEEB"><span class="token plain">}</span><br></span></code></pre></div></div>
<hr>
<p><em>Next: <a class="" href="/moltbot-doc/concepts/agent">Agent Runtime</a></em> ğŸ¦</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="æ–‡ä»¶é€‰é¡¹å¡"><a class="pagination-nav__link pagination-nav__link--prev" href="/moltbot-doc/docs/concepts/model-failover"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">æ¨¡å‹æ•…éšœè½¬ç§»</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/moltbot-doc/docs/gateway/configuration-examples"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">é…ç½®ç¤ºä¾‹</div></a></nav></div></div><div class="col col--3"><div class="tocWrapper_xKoj"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#strict-config-validation" class="table-of-contents__link toc-highlight">Strict config validation</a></li><li><a href="#schema--ui-hints" class="table-of-contents__link toc-highlight">Schema + UI hints</a></li><li><a href="#apply--restart-rpc" class="table-of-contents__link toc-highlight">Apply + restart (RPC)</a></li><li><a href="#partial-updates-rpc" class="table-of-contents__link toc-highlight">Partial updates (RPC)</a></li><li><a href="#minimal-config-recommended-starting-point" class="table-of-contents__link toc-highlight">Minimal config (recommended starting point)</a></li><li><a href="#self-chat-mode-recommended-for-group-control" class="table-of-contents__link toc-highlight">Self-chat mode (recommended for group control)</a></li><li><a href="#config-includes-include" class="table-of-contents__link toc-highlight">Config Includes (<code>$include</code>)</a><ul><li><a href="#basic-usage" class="table-of-contents__link toc-highlight">Basic usage</a></li><li><a href="#merge-behavior" class="table-of-contents__link toc-highlight">Merge behavior</a></li><li><a href="#nested-includes" class="table-of-contents__link toc-highlight">Nested includes</a></li><li><a href="#path-resolution" class="table-of-contents__link toc-highlight">Path resolution</a></li><li><a href="#error-handling" class="table-of-contents__link toc-highlight">Error handling</a></li><li><a href="#example-multi-client-legal-setup" class="table-of-contents__link toc-highlight">Example: Multi-client legal setup</a></li></ul></li><li><a href="#common-options" class="table-of-contents__link toc-highlight">Common options</a><ul><li><a href="#env-vars--env" class="table-of-contents__link toc-highlight">Env vars + <code>.env</code></a></li><li><a href="#envshellenv-optional" class="table-of-contents__link toc-highlight"><code>env.shellEnv</code> (optional)</a></li><li><a href="#env-var-substitution-in-config" class="table-of-contents__link toc-highlight">Env var substitution in config</a></li><li><a href="#auth-storage-oauth--api-keys" class="table-of-contents__link toc-highlight">Auth storage (OAuth + API keys)</a></li><li><a href="#auth" class="table-of-contents__link toc-highlight"><code>auth</code></a></li><li><a href="#agentslistidentity" class="table-of-contents__link toc-highlight"><code>agents.list[].identity</code></a></li><li><a href="#wizard" class="table-of-contents__link toc-highlight"><code>wizard</code></a></li><li><a href="#logging" class="table-of-contents__link toc-highlight"><code>logging</code></a></li><li><a href="#channelswhatsappdmpolicy" class="table-of-contents__link toc-highlight"><code>channels.whatsapp.dmPolicy</code></a></li><li><a href="#channelswhatsappallowfrom" class="table-of-contents__link toc-highlight"><code>channels.whatsapp.allowFrom</code></a></li><li><a href="#channelswhatsappsendreadreceipts" class="table-of-contents__link toc-highlight"><code>channels.whatsapp.sendReadReceipts</code></a></li><li><a href="#channelswhatsappaccounts-multi-account" class="table-of-contents__link toc-highlight"><code>channels.whatsapp.accounts</code> (multi-account)</a></li><li><a href="#channelstelegramaccounts--channelsdiscordaccounts--channelsgooglechataccounts--channelsslackaccounts--channelsmattermostaccounts--channelssignalaccounts--channelsimessageaccounts" class="table-of-contents__link toc-highlight"><code>channels.telegram.accounts</code> / <code>channels.discord.accounts</code> / <code>channels.googlechat.accounts</code> / <code>channels.slack.accounts</code> / <code>channels.mattermost.accounts</code> / <code>channels.signal.accounts</code> / <code>channels.imessage.accounts</code></a></li><li><a href="#group-chat-mention-gating-agentslistgroupchat--messagesgroupchat" class="table-of-contents__link toc-highlight">Group chat mention gating (<code>agents.list[].groupChat</code> + <code>messages.groupChat</code>)</a></li><li><a href="#group-policy-per-channel" class="table-of-contents__link toc-highlight">Group policy (per channel)</a></li><li><a href="#multi-agent-routing-agentslist--bindings" class="table-of-contents__link toc-highlight">Multi-agent routing (<code>agents.list</code> + <code>bindings</code>)</a></li><li><a href="#toolsagenttoagent-optional" class="table-of-contents__link toc-highlight"><code>tools.agentToAgent</code> (optional)</a></li><li><a href="#messagesqueue" class="table-of-contents__link toc-highlight"><code>messages.queue</code></a></li><li><a href="#messagesinbound" class="table-of-contents__link toc-highlight"><code>messages.inbound</code></a></li><li><a href="#commands-chat-command-handling" class="table-of-contents__link toc-highlight"><code>commands</code> (chat command handling)</a></li><li><a href="#web-whatsapp-web-channel-runtime" class="table-of-contents__link toc-highlight"><code>web</code> (WhatsApp web channel runtime)</a></li><li><a href="#channelstelegram-bot-transport" class="table-of-contents__link toc-highlight"><code>channels.telegram</code> (bot transport)</a></li><li><a href="#channelsdiscord-bot-transport" class="table-of-contents__link toc-highlight"><code>channels.discord</code> (bot transport)</a></li><li><a href="#channelsgooglechat-chat-api-webhook" class="table-of-contents__link toc-highlight"><code>channels.googlechat</code> (Chat API webhook)</a></li><li><a href="#channelsslack-socket-mode" class="table-of-contents__link toc-highlight"><code>channels.slack</code> (socket mode)</a></li><li><a href="#channelsmattermost-bot-token" class="table-of-contents__link toc-highlight"><code>channels.mattermost</code> (bot token)</a></li><li><a href="#channelssignal-signal-cli" class="table-of-contents__link toc-highlight"><code>channels.signal</code> (signal-cli)</a></li><li><a href="#channelsimessage-imsg-cli" class="table-of-contents__link toc-highlight"><code>channels.imessage</code> (imsg CLI)</a></li><li><a href="#agentsdefaultsworkspace" class="table-of-contents__link toc-highlight"><code>agents.defaults.workspace</code></a></li><li><a href="#agentsdefaultsreporoot" class="table-of-contents__link toc-highlight"><code>agents.defaults.repoRoot</code></a></li><li><a href="#agentsdefaultsskipbootstrap" class="table-of-contents__link toc-highlight"><code>agents.defaults.skipBootstrap</code></a></li><li><a href="#agentsdefaultsbootstrapmaxchars" class="table-of-contents__link toc-highlight"><code>agents.defaults.bootstrapMaxChars</code></a></li><li><a href="#agentsdefaultsusertimezone" class="table-of-contents__link toc-highlight"><code>agents.defaults.userTimezone</code></a></li><li><a href="#agentsdefaultstimeformat" class="table-of-contents__link toc-highlight"><code>agents.defaults.timeFormat</code></a></li><li><a href="#messages" class="table-of-contents__link toc-highlight"><code>messages</code></a></li><li><a href="#talk" class="table-of-contents__link toc-highlight"><code>talk</code></a></li><li><a href="#agentsdefaults" class="table-of-contents__link toc-highlight"><code>agents.defaults</code></a></li><li><a href="#agentsdefaultssandbox" class="table-of-contents__link toc-highlight"><code>agents.defaults.sandbox</code></a></li><li><a href="#models-custom-providers--base-urls" class="table-of-contents__link toc-highlight"><code>models</code> (custom providers + base URLs)</a></li><li><a href="#opencode-zen-multi-model-proxy" class="table-of-contents__link toc-highlight">OpenCode Zen (multi-model proxy)</a></li><li><a href="#zai-glm-47--provider-alias-support" class="table-of-contents__link toc-highlight">Z.AI (GLM-4.7) â€” provider alias support</a></li><li><a href="#moonshot-ai-kimi" class="table-of-contents__link toc-highlight">Moonshot AI (Kimi)</a></li><li><a href="#kimi-code" class="table-of-contents__link toc-highlight">Kimi Code</a></li><li><a href="#synthetic-anthropic-compatible" class="table-of-contents__link toc-highlight">Synthetic (Anthropic-compatible)</a></li><li><a href="#local-models-lm-studio--recommended-setup" class="table-of-contents__link toc-highlight">Local models (LM Studio) â€” recommended setup</a></li><li><a href="#minimax-m21" class="table-of-contents__link toc-highlight">MiniMax M2.1</a></li><li><a href="#cerebras-glm-46--47" class="table-of-contents__link toc-highlight">Cerebras (GLM 4.6 / 4.7)</a></li><li><a href="#session" class="table-of-contents__link toc-highlight"><code>session</code></a></li><li><a href="#skills-skills-config" class="table-of-contents__link toc-highlight"><code>skills</code> (skills config)</a></li><li><a href="#plugins-extensions" class="table-of-contents__link toc-highlight"><code>plugins</code> (extensions)</a></li><li><a href="#browser-clawd-managed-browser" class="table-of-contents__link toc-highlight"><code>browser</code> (clawd-managed browser)</a></li><li><a href="#ui-appearance" class="table-of-contents__link toc-highlight"><code>ui</code> (Appearance)</a></li><li><a href="#gateway-gateway-server-mode--bind" class="table-of-contents__link toc-highlight"><code>gateway</code> (Gateway server mode + bind)</a></li><li><a href="#gatewayreload-config-hot-reload" class="table-of-contents__link toc-highlight"><code>gateway.reload</code> (Config hot reload)</a></li><li><a href="#multi-instance-isolation" class="table-of-contents__link toc-highlight">Multi-instance isolation</a></li><li><a href="#hooks-gateway-webhooks" class="table-of-contents__link toc-highlight"><code>hooks</code> (Gateway webhooks)</a></li><li><a href="#canvashost-lantailnet-canvas-file-server--live-reload" class="table-of-contents__link toc-highlight"><code>canvasHost</code> (LAN/tailnet Canvas file server + live reload)</a></li><li><a href="#bridge-legacy-tcp-bridge-removed" class="table-of-contents__link toc-highlight"><code>bridge</code> (legacy TCP bridge, removed)</a></li><li><a href="#discoverymdns-bonjour--mdns-broadcast-mode" class="table-of-contents__link toc-highlight"><code>discovery.mdns</code> (Bonjour / mDNS broadcast mode)</a></li><li><a href="#discoverywidearea-wide-area-bonjour--unicast-dnssd" class="table-of-contents__link toc-highlight"><code>discovery.wideArea</code> (Wide-Area Bonjour / unicast DNSâ€‘SD)</a></li></ul></li><li><a href="#template-variables-1" class="table-of-contents__link toc-highlight">Template variables</a></li><li><a href="#cron-gateway-scheduler" class="table-of-contents__link toc-highlight">Cron (Gateway scheduler)</a></li></ul></div><div class="tocFooter_Fu2z"><div class="themeGroup_RzWV" role="group" aria-label="Theme"><button class="themeBtn_tGr6" aria-label="Light theme" title="Light"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"></path></svg></button><button class="themeBtn_tGr6 themeBtnActive_A6tm" aria-label="Dark theme" title="Dark"><svg viewBox="0 0 24 24" width="15" height="15" fill="currentColor" aria-hidden="true"><path d="M11.38 2.019a7.5 7.5 0 1 0 10.6 10.6C21.83 17.963 17.315 22 12.002 22 6.477 22 2 17.523 2 12c0-5.314 4.038-9.827 9.38-10.28z"></path></svg></button></div></div></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2026 Moltbot Docs.</div></div></div></footer></div>
</body>
</html>