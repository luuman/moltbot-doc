"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[310],{37184(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"gateway/heartbeat","title":"Heartbeat (Gateway)","description":"Heartbeat vs Cron? See Cron vs Heartbeat for guidance on when to use each.","source":"@site/content/moltbot/docs/gateway/heartbeat.md","sourceDirName":"gateway","slug":"/gateway/heartbeat","permalink":"/moltbot-doc/docs/gateway/heartbeat","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Heartbeat polling messages and notification rules","read_when":["Adjusting heartbeat cadence or messaging","Deciding between heartbeat and cron for scheduled tasks"]}}');var a=s(74848),r=s(28453);const i={summary:"Heartbeat polling messages and notification rules",read_when:["Adjusting heartbeat cadence or messaging","Deciding between heartbeat and cron for scheduled tasks"]},l="Heartbeat (Gateway)",o={},d=[{value:"Quick start (beginner)",id:"quick-start-beginner",level:2},{value:"Defaults",id:"defaults",level:2},{value:"What the heartbeat prompt is for",id:"what-the-heartbeat-prompt-is-for",level:2},{value:"Response contract",id:"response-contract",level:2},{value:"Config",id:"config",level:2},{value:"Scope and precedence",id:"scope-and-precedence",level:3},{value:"Per-agent heartbeats",id:"per-agent-heartbeats",level:3},{value:"Field notes",id:"field-notes",level:3},{value:"Delivery behavior",id:"delivery-behavior",level:2},{value:"Visibility controls",id:"visibility-controls",level:2},{value:"What each flag does",id:"what-each-flag-does",level:3},{value:"Per-channel vs per-account examples",id:"per-channel-vs-per-account-examples",level:3},{value:"Common patterns",id:"common-patterns",level:3},{value:"HEARTBEAT.md (optional)",id:"heartbeatmd-optional",level:2},{value:"Can the agent update HEARTBEAT.md?",id:"can-the-agent-update-heartbeatmd",level:3},{value:"Manual wake (on-demand)",id:"manual-wake-on-demand",level:2},{value:"Reasoning delivery (optional)",id:"reasoning-delivery-optional",level:2},{value:"Cost awareness",id:"cost-awareness",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"heartbeat-gateway",children:"Heartbeat (Gateway)"})}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Heartbeat vs Cron?"})," See ",(0,a.jsx)(n.a,{href:"/automation/cron-vs-heartbeat",children:"Cron vs Heartbeat"})," for guidance on when to use each."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Heartbeat runs ",(0,a.jsx)(n.strong,{children:"periodic agent turns"})," in the main session so the model can\nsurface anything that needs attention without spamming you."]}),"\n",(0,a.jsx)(n.h2,{id:"quick-start-beginner",children:"Quick start (beginner)"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Leave heartbeats enabled (default is ",(0,a.jsx)(n.code,{children:"30m"}),", or ",(0,a.jsx)(n.code,{children:"1h"})," for Anthropic OAuth/setup-token) or set your own cadence."]}),"\n",(0,a.jsxs)(n.li,{children:["Create a tiny ",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," checklist in the agent workspace (optional but recommended)."]}),"\n",(0,a.jsxs)(n.li,{children:["Decide where heartbeat messages should go (",(0,a.jsx)(n.code,{children:'target: "last"'})," is the default)."]}),"\n",(0,a.jsx)(n.li,{children:"Optional: enable heartbeat reasoning delivery for transparency."}),"\n",(0,a.jsx)(n.li,{children:"Optional: restrict heartbeats to active hours (local time)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Example config:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json5",children:'{\n  agents: {\n    defaults: {\n      heartbeat: {\n        every: "30m",\n        target: "last",\n        // activeHours: { start: "08:00", end: "24:00" },\n        // includeReasoning: true, // optional: send separate `Reasoning:` message too\n      }\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"defaults",children:"Defaults"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Interval: ",(0,a.jsx)(n.code,{children:"30m"})," (or ",(0,a.jsx)(n.code,{children:"1h"})," when Anthropic OAuth/setup-token is the detected auth mode). Set ",(0,a.jsx)(n.code,{children:"agents.defaults.heartbeat.every"})," or per-agent ",(0,a.jsx)(n.code,{children:"agents.list[].heartbeat.every"}),"; use ",(0,a.jsx)(n.code,{children:"0m"})," to disable."]}),"\n",(0,a.jsxs)(n.li,{children:["Prompt body (configurable via ",(0,a.jsx)(n.code,{children:"agents.defaults.heartbeat.prompt"}),"):\n",(0,a.jsx)(n.code,{children:"Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior chats. If nothing needs attention, reply HEARTBEAT_OK."})]}),"\n",(0,a.jsxs)(n.li,{children:["The heartbeat prompt is sent ",(0,a.jsx)(n.strong,{children:"verbatim"})," as the user message. The system\nprompt includes a \u201cHeartbeat\u201d section and the run is flagged internally."]}),"\n",(0,a.jsxs)(n.li,{children:["Active hours (",(0,a.jsx)(n.code,{children:"heartbeat.activeHours"}),") are checked in the configured timezone.\nOutside the window, heartbeats are skipped until the next tick inside the window."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"what-the-heartbeat-prompt-is-for",children:"What the heartbeat prompt is for"}),"\n",(0,a.jsx)(n.p,{children:"The default prompt is intentionally broad:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Background tasks"}),": \u201cConsider outstanding tasks\u201d nudges the agent to review\nfollow-ups (inbox, calendar, reminders, queued work) and surface anything urgent."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Human check-in"}),": \u201cCheckup sometimes on your human during day time\u201d nudges an\noccasional lightweight \u201canything you need?\u201d message, but avoids night-time spam\nby using your configured local timezone (see ",(0,a.jsx)(n.a,{href:"/concepts/timezone",children:"/concepts/timezone"}),")."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["If you want a heartbeat to do something very specific (e.g. \u201ccheck Gmail PubSub\nstats\u201d or \u201cverify gateway health\u201d), set ",(0,a.jsx)(n.code,{children:"agents.defaults.heartbeat.prompt"})," (or\n",(0,a.jsx)(n.code,{children:"agents.list[].heartbeat.prompt"}),") to a custom body (sent verbatim)."]}),"\n",(0,a.jsx)(n.h2,{id:"response-contract",children:"Response contract"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["If nothing needs attention, reply with ",(0,a.jsx)(n.strong,{children:(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["During heartbeat runs, Moltbot treats ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})," as an ack when it appears\nat the ",(0,a.jsx)(n.strong,{children:"start or end"})," of the reply. The token is stripped and the reply is\ndropped if the remaining content is ",(0,a.jsxs)(n.strong,{children:["\u2264 ",(0,a.jsx)(n.code,{children:"ackMaxChars"})]})," (default: 300)."]}),"\n",(0,a.jsxs)(n.li,{children:["If ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})," appears in the ",(0,a.jsx)(n.strong,{children:"middle"})," of a reply, it is not treated\nspecially."]}),"\n",(0,a.jsxs)(n.li,{children:["For alerts, ",(0,a.jsx)(n.strong,{children:"do not"})," include ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"}),"; return only the alert text."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Outside heartbeats, stray ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})," at the start/end of a message is stripped\nand logged; a message that is only ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})," is dropped."]}),"\n",(0,a.jsx)(n.h2,{id:"config",children:"Config"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json5",children:'{\n  agents: {\n    defaults: {\n      heartbeat: {\n        every: "30m",           // default: 30m (0m disables)\n        model: "anthropic/claude-opus-4-5",\n        includeReasoning: false, // default: false (deliver separate Reasoning: message when available)\n        target: "last",         // last | none | <channel id> (core or plugin, e.g. "bluebubbles")\n        to: "+15551234567",     // optional channel-specific override\n        prompt: "Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior chats. If nothing needs attention, reply HEARTBEAT_OK.",\n        ackMaxChars: 300         // max chars allowed after HEARTBEAT_OK\n      }\n    }\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"scope-and-precedence",children:"Scope and precedence"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"agents.defaults.heartbeat"})," sets global heartbeat behavior."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"agents.list[].heartbeat"})," merges on top; if any agent has a ",(0,a.jsx)(n.code,{children:"heartbeat"})," block, ",(0,a.jsx)(n.strong,{children:"only those agents"})," run heartbeats."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"channels.defaults.heartbeat"})," sets visibility defaults for all channels."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"channels.<channel>.heartbeat"})," overrides channel defaults."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"channels.<channel>.accounts.<id>.heartbeat"})," (multi-account channels) overrides per-channel settings."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"per-agent-heartbeats",children:"Per-agent heartbeats"}),"\n",(0,a.jsxs)(n.p,{children:["If any ",(0,a.jsx)(n.code,{children:"agents.list[]"})," entry includes a ",(0,a.jsx)(n.code,{children:"heartbeat"})," block, ",(0,a.jsx)(n.strong,{children:"only those agents"}),"\nrun heartbeats. The per-agent block merges on top of ",(0,a.jsx)(n.code,{children:"agents.defaults.heartbeat"}),"\n(so you can set shared defaults once and override per agent)."]}),"\n",(0,a.jsx)(n.p,{children:"Example: two agents, only the second agent runs heartbeats."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json5",children:'{\n  agents: {\n    defaults: {\n      heartbeat: {\n        every: "30m",\n        target: "last"\n      }\n    },\n    list: [\n      { id: "main", default: true },\n      {\n        id: "ops",\n        heartbeat: {\n          every: "1h",\n          target: "whatsapp",\n          to: "+15551234567",\n          prompt: "Read HEARTBEAT.md if it exists (workspace context). Follow it strictly. Do not infer or repeat old tasks from prior chats. If nothing needs attention, reply HEARTBEAT_OK."\n        }\n      }\n    ]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.h3,{id:"field-notes",children:"Field notes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"every"}),": heartbeat interval (duration string; default unit = minutes)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"model"}),": optional model override for heartbeat runs (",(0,a.jsx)(n.code,{children:"provider/model"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"includeReasoning"}),": when enabled, also deliver the separate ",(0,a.jsx)(n.code,{children:"Reasoning:"})," message when available (same shape as ",(0,a.jsx)(n.code,{children:"/reasoning on"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"session"}),": optional session key for heartbeat runs.\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"main"})," (default): agent main session."]}),"\n",(0,a.jsxs)(n.li,{children:["Explicit session key (copy from ",(0,a.jsx)(n.code,{children:"moltbot sessions --json"})," or the ",(0,a.jsx)(n.a,{href:"/cli/sessions",children:"sessions CLI"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:["Session key formats: see ",(0,a.jsx)(n.a,{href:"/concepts/session",children:"Sessions"})," and ",(0,a.jsx)(n.a,{href:"/concepts/groups",children:"Groups"}),"."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"target"}),":\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"last"})," (default): deliver to the last used external channel."]}),"\n",(0,a.jsxs)(n.li,{children:["explicit channel: ",(0,a.jsx)(n.code,{children:"whatsapp"})," / ",(0,a.jsx)(n.code,{children:"telegram"})," / ",(0,a.jsx)(n.code,{children:"discord"})," / ",(0,a.jsx)(n.code,{children:"googlechat"})," / ",(0,a.jsx)(n.code,{children:"slack"})," / ",(0,a.jsx)(n.code,{children:"msteams"})," / ",(0,a.jsx)(n.code,{children:"signal"})," / ",(0,a.jsx)(n.code,{children:"imessage"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"none"}),": run the heartbeat but ",(0,a.jsx)(n.strong,{children:"do not deliver"})," externally."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"to"}),": optional recipient override (channel-specific id, e.g. E.164 for WhatsApp or a Telegram chat id)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"prompt"}),": overrides the default prompt body (not merged)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"ackMaxChars"}),": max chars allowed after ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})," before delivery."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"delivery-behavior",children:"Delivery behavior"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Heartbeats run in the agent\u2019s main session by default (",(0,a.jsx)(n.code,{children:"agent:<id>:<mainKey>"}),"),\nor ",(0,a.jsx)(n.code,{children:"global"})," when ",(0,a.jsx)(n.code,{children:'session.scope = "global"'}),". Set ",(0,a.jsx)(n.code,{children:"session"})," to override to a\nspecific channel session (Discord/WhatsApp/etc.)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"session"})," only affects the run context; delivery is controlled by ",(0,a.jsx)(n.code,{children:"target"})," and ",(0,a.jsx)(n.code,{children:"to"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["To deliver to a specific channel/recipient, set ",(0,a.jsx)(n.code,{children:"target"})," + ",(0,a.jsx)(n.code,{children:"to"}),". With\n",(0,a.jsx)(n.code,{children:'target: "last"'}),", delivery uses the last external channel for that session."]}),"\n",(0,a.jsx)(n.li,{children:"If the main queue is busy, the heartbeat is skipped and retried later."}),"\n",(0,a.jsxs)(n.li,{children:["If ",(0,a.jsx)(n.code,{children:"target"})," resolves to no external destination, the run still happens but no\noutbound message is sent."]}),"\n",(0,a.jsxs)(n.li,{children:["Heartbeat-only replies do ",(0,a.jsx)(n.strong,{children:"not"})," keep the session alive; the last ",(0,a.jsx)(n.code,{children:"updatedAt"}),"\nis restored so idle expiry behaves normally."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"visibility-controls",children:"Visibility controls"}),"\n",(0,a.jsxs)(n.p,{children:["By default, ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})," acknowledgments are suppressed while alert content is\ndelivered. You can adjust this per channel or per account:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"channels:\n  defaults:\n    heartbeat:\n      showOk: false      # Hide HEARTBEAT_OK (default)\n      showAlerts: true   # Show alert messages (default)\n      useIndicator: true # Emit indicator events (default)\n  telegram:\n    heartbeat:\n      showOk: true       # Show OK acknowledgments on Telegram\n  whatsapp:\n    accounts:\n      work:\n        heartbeat:\n          showAlerts: false # Suppress alert delivery for this account\n"})}),"\n",(0,a.jsx)(n.p,{children:"Precedence: per-account \u2192 per-channel \u2192 channel defaults \u2192 built-in defaults."}),"\n",(0,a.jsx)(n.h3,{id:"what-each-flag-does",children:"What each flag does"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"showOk"}),": sends a ",(0,a.jsx)(n.code,{children:"HEARTBEAT_OK"})," acknowledgment when the model returns an OK-only reply."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"showAlerts"}),": sends the alert content when the model returns a non-OK reply."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"useIndicator"}),": emits indicator events for UI status surfaces."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["If ",(0,a.jsx)(n.strong,{children:"all three"})," are false, Moltbot skips the heartbeat run entirely (no model call)."]}),"\n",(0,a.jsx)(n.h3,{id:"per-channel-vs-per-account-examples",children:"Per-channel vs per-account examples"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"channels:\n  defaults:\n    heartbeat:\n      showOk: false\n      showAlerts: true\n      useIndicator: true\n  slack:\n    heartbeat:\n      showOk: true # all Slack accounts\n    accounts:\n      ops:\n        heartbeat:\n          showAlerts: false # suppress alerts for the ops account only\n  telegram:\n    heartbeat:\n      showOk: true\n"})}),"\n",(0,a.jsx)(n.h3,{id:"common-patterns",children:"Common patterns"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Goal"}),(0,a.jsx)(n.th,{children:"Config"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Default behavior (silent OKs, alerts on)"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.em,{children:"(no config needed)"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Fully silent (no messages, no indicator)"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"channels.defaults.heartbeat: { showOk: false, showAlerts: false, useIndicator: false }"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Indicator-only (no messages)"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"channels.defaults.heartbeat: { showOk: false, showAlerts: false, useIndicator: true }"})})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"OKs in one channel only"}),(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"channels.telegram.heartbeat: { showOk: true }"})})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"heartbeatmd-optional",children:"HEARTBEAT.md (optional)"}),"\n",(0,a.jsxs)(n.p,{children:["If a ",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," file exists in the workspace, the default prompt tells the\nagent to read it. Think of it as your \u201cheartbeat checklist\u201d: small, stable, and\nsafe to include every 30 minutes."]}),"\n",(0,a.jsxs)(n.p,{children:["If ",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," exists but is effectively empty (only blank lines and markdown\nheaders like ",(0,a.jsx)(n.code,{children:"# Heading"}),"), Moltbot skips the heartbeat run to save API calls.\nIf the file is missing, the heartbeat still runs and the model decides what to do."]}),"\n",(0,a.jsx)(n.p,{children:"Keep it tiny (short checklist or reminders) to avoid prompt bloat."}),"\n",(0,a.jsxs)(n.p,{children:["Example ",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-md",children:"# Heartbeat checklist\n\n- Quick scan: anything urgent in inboxes?\n- If it\u2019s daytime, do a lightweight check-in if nothing else is pending.\n- If a task is blocked, write down *what is missing* and ask Peter next time.\n"})}),"\n",(0,a.jsx)(n.h3,{id:"can-the-agent-update-heartbeatmd",children:"Can the agent update HEARTBEAT.md?"}),"\n",(0,a.jsx)(n.p,{children:"Yes \u2014 if you ask it to."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," is just a normal file in the agent workspace, so you can tell the\nagent (in a normal chat) something like:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u201cUpdate ",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," to add a daily calendar check.\u201d"]}),"\n",(0,a.jsxs)(n.li,{children:["\u201cRewrite ",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," so it\u2019s shorter and focused on inbox follow-ups.\u201d"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"If you want this to happen proactively, you can also include an explicit line in\nyour heartbeat prompt like: \u201cIf the checklist becomes stale, update HEARTBEAT.md\nwith a better one.\u201d"}),"\n",(0,a.jsxs)(n.p,{children:["Safety note: don\u2019t put secrets (API keys, phone numbers, private tokens) into\n",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," \u2014 it becomes part of the prompt context."]}),"\n",(0,a.jsx)(n.h2,{id:"manual-wake-on-demand",children:"Manual wake (on-demand)"}),"\n",(0,a.jsx)(n.p,{children:"You can enqueue a system event and trigger an immediate heartbeat with:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'moltbot system event --text "Check for urgent follow-ups" --mode now\n'})}),"\n",(0,a.jsxs)(n.p,{children:["If multiple agents have ",(0,a.jsx)(n.code,{children:"heartbeat"})," configured, a manual wake runs each of those\nagent heartbeats immediately."]}),"\n",(0,a.jsxs)(n.p,{children:["Use ",(0,a.jsx)(n.code,{children:"--mode next-heartbeat"})," to wait for the next scheduled tick."]}),"\n",(0,a.jsx)(n.h2,{id:"reasoning-delivery-optional",children:"Reasoning delivery (optional)"}),"\n",(0,a.jsx)(n.p,{children:"By default, heartbeats deliver only the final \u201canswer\u201d payload."}),"\n",(0,a.jsx)(n.p,{children:"If you want transparency, enable:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"agents.defaults.heartbeat.includeReasoning: true"})}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["When enabled, heartbeats will also deliver a separate message prefixed\n",(0,a.jsx)(n.code,{children:"Reasoning:"})," (same shape as ",(0,a.jsx)(n.code,{children:"/reasoning on"}),"). This can be useful when the agent\nis managing multiple sessions/codexes and you want to see why it decided to ping\nyou \u2014 but it can also leak more internal detail than you want. Prefer keeping it\noff in group chats."]}),"\n",(0,a.jsx)(n.h2,{id:"cost-awareness",children:"Cost awareness"}),"\n",(0,a.jsxs)(n.p,{children:["Heartbeats run full agent turns. Shorter intervals burn more tokens. Keep\n",(0,a.jsx)(n.code,{children:"HEARTBEAT.md"})," small and consider a cheaper ",(0,a.jsx)(n.code,{children:"model"})," or ",(0,a.jsx)(n.code,{children:'target: "none"'})," if you\nonly want internal state updates."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453(e,n,s){s.d(n,{R:()=>i,x:()=>l});var t=s(96540);const a={},r=t.createContext(a);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);