"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[3263],{64402(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"gateway/health","title":"Health Checks (CLI)","description":"Short guide to verify channel connectivity without guessing.","source":"@site/content/moltbot/docs/gateway/health.md","sourceDirName":"gateway","slug":"/gateway/health","permalink":"/moltbot-doc/docs/gateway/health","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Health check steps for channel connectivity","read_when":["Diagnosing WhatsApp channel health"]}}');var o=t(74848),a=t(28453);const l={summary:"Health check steps for channel connectivity",read_when:["Diagnosing WhatsApp channel health"]},i="Health Checks (CLI)",c={},h=[{value:"Quick checks",id:"quick-checks",level:2},{value:"Deep diagnostics",id:"deep-diagnostics",level:2},{value:"When something fails",id:"when-something-fails",level:2},{value:"Dedicated &quot;health&quot; command",id:"dedicated-health-command",level:2}];function r(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"health-checks-cli",children:"Health Checks (CLI)"})}),"\n",(0,o.jsx)(n.p,{children:"Short guide to verify channel connectivity without guessing."}),"\n",(0,o.jsx)(n.h2,{id:"quick-checks",children:"Quick checks"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"moltbot status"})," \u2014 local summary: gateway reachability/mode, update hint, linked channel auth age, sessions + recent activity."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"moltbot status --all"})," \u2014 full local diagnosis (read-only, color, safe to paste for debugging)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"moltbot status --deep"})," \u2014 also probes the running Gateway (per-channel probes when supported)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"moltbot health --json"})," \u2014 asks the running Gateway for a full health snapshot (WS-only; no direct Baileys socket)."]}),"\n",(0,o.jsxs)(n.li,{children:["Send ",(0,o.jsx)(n.code,{children:"/status"})," as a standalone message in WhatsApp/WebChat to get a status reply without invoking the agent."]}),"\n",(0,o.jsxs)(n.li,{children:["Logs: tail ",(0,o.jsx)(n.code,{children:"/tmp/moltbot/moltbot-*.log"})," and filter for ",(0,o.jsx)(n.code,{children:"web-heartbeat"}),", ",(0,o.jsx)(n.code,{children:"web-reconnect"}),", ",(0,o.jsx)(n.code,{children:"web-auto-reply"}),", ",(0,o.jsx)(n.code,{children:"web-inbound"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"deep-diagnostics",children:"Deep diagnostics"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Creds on disk: ",(0,o.jsx)(n.code,{children:"ls -l ~/.clawdbot/credentials/whatsapp/<accountId>/creds.json"})," (mtime should be recent)."]}),"\n",(0,o.jsxs)(n.li,{children:["Session store: ",(0,o.jsx)(n.code,{children:"ls -l ~/.clawdbot/agents/<agentId>/sessions/sessions.json"})," (path can be overridden in config). Count and recent recipients are surfaced via ",(0,o.jsx)(n.code,{children:"status"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Relink flow: ",(0,o.jsx)(n.code,{children:"moltbot channels logout && moltbot channels login --verbose"})," when status codes 409\u2013515 or ",(0,o.jsx)(n.code,{children:"loggedOut"})," appear in logs. (Note: the QR login flow auto-restarts once for status 515 after pairing.)"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"when-something-fails",children:"When something fails"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"logged out"})," or status 409\u2013515 \u2192 relink with ",(0,o.jsx)(n.code,{children:"moltbot channels logout"})," then ",(0,o.jsx)(n.code,{children:"moltbot channels login"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Gateway unreachable \u2192 start it: ",(0,o.jsx)(n.code,{children:"moltbot gateway --port 18789"})," (use ",(0,o.jsx)(n.code,{children:"--force"})," if the port is busy)."]}),"\n",(0,o.jsxs)(n.li,{children:["No inbound messages \u2192 confirm linked phone is online and the sender is allowed (",(0,o.jsx)(n.code,{children:"channels.whatsapp.allowFrom"}),"); for group chats, ensure allowlist + mention rules match (",(0,o.jsx)(n.code,{children:"channels.whatsapp.groups"}),", ",(0,o.jsx)(n.code,{children:"agents.list[].groupChat.mentionPatterns"}),")."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"dedicated-health-command",children:'Dedicated "health" command'}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"moltbot health --json"})," asks the running Gateway for its health snapshot (no direct channel sockets from the CLI). It reports linked creds/auth age when available, per-channel probe summaries, session-store summary, and a probe duration. It exits non-zero if the Gateway is unreachable or the probe fails/timeouts. Use ",(0,o.jsx)(n.code,{children:"--timeout <ms>"})," to override the 10s default."]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(r,{...e})}):r(e)}},28453(e,n,t){t.d(n,{R:()=>l,x:()=>i});var s=t(96540);const o={},a=s.createContext(o);function l(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);