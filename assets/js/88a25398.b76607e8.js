"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[9953],{62697(e,n,o){o.r(n),o.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"gateway/tools-invoke-http-api","title":"Tools Invoke (HTTP)","description":"Moltbot\u2019s Gateway exposes a simple HTTP endpoint for invoking a single tool directly. It is always enabled, but gated by Gateway auth and tool policy.","source":"@site/content/moltbot/docs/gateway/tools-invoke-http-api.md","sourceDirName":"gateway","slug":"/gateway/tools-invoke-http-api","permalink":"/moltbot-doc/docs/gateway/tools-invoke-http-api","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Invoke a single tool directly via the Gateway HTTP endpoint","read_when":["Calling tools without running a full agent turn","Building automations that need tool policy enforcement"]}}');var i=o(74848),l=o(28453);const t={summary:"Invoke a single tool directly via the Gateway HTTP endpoint",read_when:["Calling tools without running a full agent turn","Building automations that need tool policy enforcement"]},r="Tools Invoke (HTTP)",a={},d=[{value:"Authentication",id:"authentication",level:2},{value:"Request body",id:"request-body",level:2},{value:"Policy + routing behavior",id:"policy--routing-behavior",level:2},{value:"Responses",id:"responses",level:2},{value:"Example",id:"example",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"tools-invoke-http",children:"Tools Invoke (HTTP)"})}),"\n",(0,i.jsx)(n.p,{children:"Moltbot\u2019s Gateway exposes a simple HTTP endpoint for invoking a single tool directly. It is always enabled, but gated by Gateway auth and tool policy."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"POST /tools/invoke"})}),"\n",(0,i.jsxs)(n.li,{children:["Same port as the Gateway (WS + HTTP multiplex): ",(0,i.jsx)(n.code,{children:"http://<gateway-host>:<port>/tools/invoke"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Default max payload size is 2 MB."}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsx)(n.p,{children:"Uses the Gateway auth configuration. Send a bearer token:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Authorization: Bearer <token>"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["When ",(0,i.jsx)(n.code,{children:'gateway.auth.mode="token"'}),", use ",(0,i.jsx)(n.code,{children:"gateway.auth.token"})," (or ",(0,i.jsx)(n.code,{children:"CLAWDBOT_GATEWAY_TOKEN"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["When ",(0,i.jsx)(n.code,{children:'gateway.auth.mode="password"'}),", use ",(0,i.jsx)(n.code,{children:"gateway.auth.password"})," (or ",(0,i.jsx)(n.code,{children:"CLAWDBOT_GATEWAY_PASSWORD"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"request-body",children:"Request body"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "tool": "sessions_list",\n  "action": "json",\n  "args": {},\n  "sessionKey": "main",\n  "dryRun": false\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Fields:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tool"})," (string, required): tool name to invoke."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"action"})," (string, optional): mapped into args if the tool schema supports ",(0,i.jsx)(n.code,{children:"action"})," and the args payload omitted it."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"args"})," (object, optional): tool-specific arguments."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sessionKey"})," (string, optional): target session key. If omitted or ",(0,i.jsx)(n.code,{children:'"main"'}),", the Gateway uses the configured main session key (honors ",(0,i.jsx)(n.code,{children:"session.mainKey"})," and default agent, or ",(0,i.jsx)(n.code,{children:"global"})," in global scope)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dryRun"})," (boolean, optional): reserved for future use; currently ignored."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"policy--routing-behavior",children:"Policy + routing behavior"}),"\n",(0,i.jsx)(n.p,{children:"Tool availability is filtered through the same policy chain used by Gateway agents:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tools.profile"})," / ",(0,i.jsx)(n.code,{children:"tools.byProvider.profile"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tools.allow"})," / ",(0,i.jsx)(n.code,{children:"tools.byProvider.allow"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"agents.<id>.tools.allow"})," / ",(0,i.jsx)(n.code,{children:"agents.<id>.tools.byProvider.allow"})]}),"\n",(0,i.jsx)(n.li,{children:"group policies (if the session key maps to a group or channel)"}),"\n",(0,i.jsx)(n.li,{children:"subagent policy (when invoking with a subagent session key)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["If a tool is not allowed by policy, the endpoint returns ",(0,i.jsx)(n.strong,{children:"404"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"To help group policies resolve context, you can optionally set:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"x-moltbot-message-channel: <channel>"})," (example: ",(0,i.jsx)(n.code,{children:"slack"}),", ",(0,i.jsx)(n.code,{children:"telegram"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"x-moltbot-account-id: <accountId>"})," (when multiple accounts exist)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"responses",children:"Responses"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"200"})," \u2192 ",(0,i.jsx)(n.code,{children:"{ ok: true, result }"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"400"})," \u2192 ",(0,i.jsx)(n.code,{children:"{ ok: false, error: { type, message } }"})," (invalid request or tool error)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"401"})," \u2192 unauthorized"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"404"})," \u2192 tool not available (not found or not allowlisted)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"405"})," \u2192 method not allowed"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -sS http://127.0.0.1:18789/tools/invoke \\\n  -H \'Authorization: Bearer YOUR_TOKEN\' \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n    "tool": "sessions_list",\n    "action": "json",\n    "args": {}\n  }\'\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453(e,n,o){o.d(n,{R:()=>t,x:()=>r});var s=o(96540);const i={},l=s.createContext(i);function t(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);