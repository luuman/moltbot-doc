"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[1134],{11212(e,n,t){t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"gateway/remote","title":"Remote access (SSH, tunnels, and tailnets)","description":"This repo supports \u201cremote over SSH\u201d by keeping a single Gateway (the master) running on a dedicated host (desktop/server) and connecting clients to it.","source":"@site/content/moltbot/docs/gateway/remote.md","sourceDirName":"gateway","slug":"/gateway/remote","permalink":"/moltbot-doc/docs/gateway/remote","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Remote access using SSH tunnels (Gateway WS) and tailnets","read_when":["Running or troubleshooting remote gateway setups"]},"sidebar":"tutorialSidebar","previous":{"title":"\u914d\u7f6e\u793a\u4f8b","permalink":"/moltbot-doc/docs/gateway/configuration-examples"},"next":{"title":"\u8fdc\u7a0b\u7f51\u5173\u8bf4\u660e","permalink":"/moltbot-doc/docs/gateway/remote-gateway-readme"}}');var o=t(74848),a=t(28453);const r={summary:"Remote access using SSH tunnels (Gateway WS) and tailnets",read_when:["Running or troubleshooting remote gateway setups"]},l="Remote access (SSH, tunnels, and tailnets)",i={},c=[{value:"The core idea",id:"the-core-idea",level:2},{value:"Common VPN/tailnet setups (where the agent lives)",id:"common-vpntailnet-setups-where-the-agent-lives",level:2},{value:"1) Always-on Gateway in your tailnet (VPS or home server)",id:"1-always-on-gateway-in-your-tailnet-vps-or-home-server",level:3},{value:"2) Home desktop runs the Gateway, laptop is remote control",id:"2-home-desktop-runs-the-gateway-laptop-is-remote-control",level:3},{value:"3) Laptop runs the Gateway, remote access from other machines",id:"3-laptop-runs-the-gateway-remote-access-from-other-machines",level:3},{value:"Command flow (what runs where)",id:"command-flow-what-runs-where",level:2},{value:"SSH tunnel (CLI + tools)",id:"ssh-tunnel-cli--tools",level:2},{value:"CLI remote defaults",id:"cli-remote-defaults",level:2},{value:"Chat UI over SSH",id:"chat-ui-over-ssh",level:2},{value:"macOS app \u201cRemote over SSH\u201d",id:"macos-app-remote-over-ssh",level:2},{value:"Security rules (remote/VPN)",id:"security-rules-remotevpn",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"remote-access-ssh-tunnels-and-tailnets",children:"Remote access (SSH, tunnels, and tailnets)"})}),"\n",(0,o.jsx)(n.p,{children:"This repo supports \u201cremote over SSH\u201d by keeping a single Gateway (the master) running on a dedicated host (desktop/server) and connecting clients to it."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["For ",(0,o.jsx)(n.strong,{children:"operators (you / the macOS app)"}),": SSH tunneling is the universal fallback."]}),"\n",(0,o.jsxs)(n.li,{children:["For ",(0,o.jsx)(n.strong,{children:"nodes (iOS/Android and future devices)"}),": connect to the Gateway ",(0,o.jsx)(n.strong,{children:"WebSocket"})," (LAN/tailnet or SSH tunnel as needed)."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"the-core-idea",children:"The core idea"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The Gateway WebSocket binds to ",(0,o.jsx)(n.strong,{children:"loopback"})," on your configured port (defaults to 18789)."]}),"\n",(0,o.jsx)(n.li,{children:"For remote use, you forward that loopback port over SSH (or use a tailnet/VPN and tunnel less)."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"common-vpntailnet-setups-where-the-agent-lives",children:"Common VPN/tailnet setups (where the agent lives)"}),"\n",(0,o.jsxs)(n.p,{children:["Think of the ",(0,o.jsx)(n.strong,{children:"Gateway host"})," as \u201cwhere the agent lives.\u201d It owns sessions, auth profiles, channels, and state.\nYour laptop/desktop (and nodes) connect to that host."]}),"\n",(0,o.jsx)(n.h3,{id:"1-always-on-gateway-in-your-tailnet-vps-or-home-server",children:"1) Always-on Gateway in your tailnet (VPS or home server)"}),"\n",(0,o.jsxs)(n.p,{children:["Run the Gateway on a persistent host and reach it via ",(0,o.jsx)(n.strong,{children:"Tailscale"})," or SSH."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Best UX:"})," keep ",(0,o.jsx)(n.code,{children:'gateway.bind: "loopback"'})," and use ",(0,o.jsx)(n.strong,{children:"Tailscale Serve"})," for the Control UI."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Fallback:"})," keep loopback + SSH tunnel from any machine that needs access."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Examples:"})," ",(0,o.jsx)(n.a,{href:"/platforms/exe-dev",children:"exe.dev"})," (easy VM) or ",(0,o.jsx)(n.a,{href:"/platforms/hetzner",children:"Hetzner"})," (production VPS)."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"This is ideal when your laptop sleeps often but you want the agent always-on."}),"\n",(0,o.jsx)(n.h3,{id:"2-home-desktop-runs-the-gateway-laptop-is-remote-control",children:"2) Home desktop runs the Gateway, laptop is remote control"}),"\n",(0,o.jsxs)(n.p,{children:["The laptop does ",(0,o.jsx)(n.strong,{children:"not"})," run the agent. It connects remotely:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Use the macOS app\u2019s ",(0,o.jsx)(n.strong,{children:"Remote over SSH"})," mode (Settings \u2192 General \u2192 \u201cMoltbot runs\u201d)."]}),"\n",(0,o.jsx)(n.li,{children:"The app opens and manages the tunnel, so WebChat + health checks \u201cjust work.\u201d"}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Runbook: ",(0,o.jsx)(n.a,{href:"/platforms/mac/remote",children:"macOS remote access"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"3-laptop-runs-the-gateway-remote-access-from-other-machines",children:"3) Laptop runs the Gateway, remote access from other machines"}),"\n",(0,o.jsx)(n.p,{children:"Keep the Gateway local but expose it safely:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"SSH tunnel to the laptop from other machines, or"}),"\n",(0,o.jsx)(n.li,{children:"Tailscale Serve the Control UI and keep the Gateway loopback-only."}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Guide: ",(0,o.jsx)(n.a,{href:"/gateway/tailscale",children:"Tailscale"})," and ",(0,o.jsx)(n.a,{href:"/web",children:"Web overview"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"command-flow-what-runs-where",children:"Command flow (what runs where)"}),"\n",(0,o.jsx)(n.p,{children:"One gateway service owns state + channels. Nodes are peripherals."}),"\n",(0,o.jsx)(n.p,{children:"Flow example (Telegram \u2192 node):"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Telegram message arrives at the ",(0,o.jsx)(n.strong,{children:"Gateway"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Gateway runs the ",(0,o.jsx)(n.strong,{children:"agent"})," and decides whether to call a node tool."]}),"\n",(0,o.jsxs)(n.li,{children:["Gateway calls the ",(0,o.jsx)(n.strong,{children:"node"})," over the Gateway WebSocket (",(0,o.jsx)(n.code,{children:"node.*"})," RPC)."]}),"\n",(0,o.jsx)(n.li,{children:"Node returns the result; Gateway replies back out to Telegram."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Notes:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Nodes do not run the gateway service."})," Only one gateway should run per host unless you intentionally run isolated profiles (see ",(0,o.jsx)(n.a,{href:"/gateway/multiple-gateways",children:"Multiple gateways"}),")."]}),"\n",(0,o.jsx)(n.li,{children:"macOS app \u201cnode mode\u201d is just a node client over the Gateway WebSocket."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"ssh-tunnel-cli--tools",children:"SSH tunnel (CLI + tools)"}),"\n",(0,o.jsx)(n.p,{children:"Create a local tunnel to the remote Gateway WS:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"ssh -N -L 18789:127.0.0.1:18789 user@host\n"})}),"\n",(0,o.jsx)(n.p,{children:"With the tunnel up:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"moltbot health"})," and ",(0,o.jsx)(n.code,{children:"moltbot status --deep"})," now reach the remote gateway via ",(0,o.jsx)(n.code,{children:"ws://127.0.0.1:18789"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"moltbot gateway {status,health,send,agent,call}"})," can also target the forwarded URL via ",(0,o.jsx)(n.code,{children:"--url"})," when needed."]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Note: replace ",(0,o.jsx)(n.code,{children:"18789"})," with your configured ",(0,o.jsx)(n.code,{children:"gateway.port"})," (or ",(0,o.jsx)(n.code,{children:"--port"}),"/",(0,o.jsx)(n.code,{children:"CLAWDBOT_GATEWAY_PORT"}),")."]}),"\n",(0,o.jsx)(n.h2,{id:"cli-remote-defaults",children:"CLI remote defaults"}),"\n",(0,o.jsx)(n.p,{children:"You can persist a remote target so CLI commands use it by default:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json5",children:'{\n  gateway: {\n    mode: "remote",\n    remote: {\n      url: "ws://127.0.0.1:18789",\n      token: "your-token"\n    }\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["When the gateway is loopback-only, keep the URL at ",(0,o.jsx)(n.code,{children:"ws://127.0.0.1:18789"})," and open the SSH tunnel first."]}),"\n",(0,o.jsx)(n.h2,{id:"chat-ui-over-ssh",children:"Chat UI over SSH"}),"\n",(0,o.jsx)(n.p,{children:"WebChat no longer uses a separate HTTP port. The SwiftUI chat UI connects directly to the Gateway WebSocket."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Forward ",(0,o.jsx)(n.code,{children:"18789"})," over SSH (see above), then connect clients to ",(0,o.jsx)(n.code,{children:"ws://127.0.0.1:18789"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"On macOS, prefer the app\u2019s \u201cRemote over SSH\u201d mode, which manages the tunnel automatically."}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"macos-app-remote-over-ssh",children:"macOS app \u201cRemote over SSH\u201d"}),"\n",(0,o.jsx)(n.p,{children:"The macOS menu bar app can drive the same setup end-to-end (remote status checks, WebChat, and Voice Wake forwarding)."}),"\n",(0,o.jsxs)(n.p,{children:["Runbook: ",(0,o.jsx)(n.a,{href:"/platforms/mac/remote",children:"macOS remote access"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"security-rules-remotevpn",children:"Security rules (remote/VPN)"}),"\n",(0,o.jsxs)(n.p,{children:["Short version: ",(0,o.jsx)(n.strong,{children:"keep the Gateway loopback-only"})," unless you\u2019re sure you need a bind."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Loopback + SSH/Tailscale Serve"})," is the safest default (no public exposure)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Non-loopback binds"})," (",(0,o.jsx)(n.code,{children:"lan"}),"/",(0,o.jsx)(n.code,{children:"tailnet"}),"/",(0,o.jsx)(n.code,{children:"custom"}),", or ",(0,o.jsx)(n.code,{children:"auto"})," when loopback is unavailable) must use auth tokens/passwords."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"gateway.remote.token"})," is ",(0,o.jsx)(n.strong,{children:"only"})," for remote CLI calls \u2014 it does ",(0,o.jsx)(n.strong,{children:"not"})," enable local auth."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"gateway.remote.tlsFingerprint"})," pins the remote TLS cert when using ",(0,o.jsx)(n.code,{children:"wss://"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Tailscale Serve"})," can authenticate via identity headers when ",(0,o.jsx)(n.code,{children:"gateway.auth.allowTailscale: true"}),".\nSet it to ",(0,o.jsx)(n.code,{children:"false"})," if you want tokens/passwords instead."]}),"\n",(0,o.jsx)(n.li,{children:"Treat browser control like operator access: tailnet-only + deliberate node pairing."}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Deep dive: ",(0,o.jsx)(n.a,{href:"/gateway/security",children:"Security"}),"."]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},28453(e,n,t){t.d(n,{R:()=>r,x:()=>l});var s=t(96540);const o={},a=s.createContext(o);function r(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);