"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[2923],{70236(e,n,s){s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"channels/discord","title":"Discord (Bot API)","description":"Status: ready for DM and guild text channels via the official Discord bot gateway.","source":"@site/content/moltbot/docs/channels/discord.md","sourceDirName":"channels","slug":"/channels/discord","permalink":"/moltbot-doc/docs/channels/discord","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Discord bot support status, capabilities, and configuration","read_when":["Working on Discord channel features"]}}');var i=s(74848),d=s(28453);const r={summary:"Discord bot support status, capabilities, and configuration",read_when:["Working on Discord channel features"]},c="Discord (Bot API)",o={},t=[{value:"Quick setup (beginner)",id:"quick-setup-beginner",level:2},{value:"Goals",id:"goals",level:2},{value:"How it works",id:"how-it-works",level:2},{value:"Config writes",id:"config-writes",level:2},{value:"How to create your own bot",id:"how-to-create-your-own-bot",level:2},{value:"1) Create the Discord app + bot user",id:"1-create-the-discord-app--bot-user",level:3},{value:"2) Enable the gateway intents Moltbot needs",id:"2-enable-the-gateway-intents-moltbot-needs",level:3},{value:"3) Generate an invite URL (OAuth2 URL Generator)",id:"3-generate-an-invite-url-oauth2-url-generator",level:3},{value:"4) Get the ids (guild/user/channel)",id:"4-get-the-ids-guilduserchannel",level:3},{value:"5) Configure Moltbot",id:"5-configure-moltbot",level:3},{value:"Token",id:"token",level:4},{value:"Allowlist + channel routing",id:"allowlist--channel-routing",level:4},{value:"6) Verify it works",id:"6-verify-it-works",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Capabilities &amp; limits",id:"capabilities--limits",level:2},{value:"Retry policy",id:"retry-policy",level:2},{value:"Config",id:"config",level:2},{value:"Tool action defaults",id:"tool-action-defaults",level:3},{value:"Reply tags",id:"reply-tags",level:2},{value:"Tool actions",id:"tool-actions",level:2},{value:"Safety &amp; ops",id:"safety--ops",level:2}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"discord-bot-api",children:"Discord (Bot API)"})}),"\n",(0,i.jsx)(n.p,{children:"Status: ready for DM and guild text channels via the official Discord bot gateway."}),"\n",(0,i.jsx)(n.h2,{id:"quick-setup-beginner",children:"Quick setup (beginner)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a Discord bot and copy the bot token."}),"\n",(0,i.jsxs)(n.li,{children:["In the Discord app settings, enable ",(0,i.jsx)(n.strong,{children:"Message Content Intent"})," (and ",(0,i.jsx)(n.strong,{children:"Server Members Intent"})," if you plan to use allowlists or name lookups)."]}),"\n",(0,i.jsxs)(n.li,{children:["Set the token for Moltbot:\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Env: ",(0,i.jsx)(n.code,{children:"DISCORD_BOT_TOKEN=..."})]}),"\n",(0,i.jsxs)(n.li,{children:["Or config: ",(0,i.jsx)(n.code,{children:'channels.discord.token: "..."'}),"."]}),"\n",(0,i.jsx)(n.li,{children:"If both are set, config takes precedence (env fallback is default-account only)."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Invite the bot to your server with message permissions (create a private server if you just want DMs)."}),"\n",(0,i.jsx)(n.li,{children:"Start the gateway."}),"\n",(0,i.jsx)(n.li,{children:"DM access is pairing by default; approve the pairing code on first contact."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Minimal config:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    discord: {\n      enabled: true,\n      token: "YOUR_BOT_TOKEN"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"goals",children:"Goals"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Talk to Moltbot via Discord DMs or guild channels."}),"\n",(0,i.jsxs)(n.li,{children:["Direct chats collapse into the agent's main session (default ",(0,i.jsx)(n.code,{children:"agent:main:main"}),"); guild channels stay isolated as ",(0,i.jsx)(n.code,{children:"agent:<agentId>:discord:channel:<channelId>"})," (display names use ",(0,i.jsx)(n.code,{children:"discord:<guildSlug>#<channelSlug>"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Group DMs are ignored by default; enable via ",(0,i.jsx)(n.code,{children:"channels.discord.dm.groupEnabled"})," and optionally restrict by ",(0,i.jsx)(n.code,{children:"channels.discord.dm.groupChannels"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Keep routing deterministic: replies always go back to the channel they arrived on."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a Discord application \u2192 Bot, enable the intents you need (DMs + guild messages + message content), and grab the bot token."}),"\n",(0,i.jsx)(n.li,{children:"Invite the bot to your server with the permissions required to read/send messages where you want to use it."}),"\n",(0,i.jsxs)(n.li,{children:["Configure Moltbot with ",(0,i.jsx)(n.code,{children:"channels.discord.token"})," (or ",(0,i.jsx)(n.code,{children:"DISCORD_BOT_TOKEN"})," as a fallback)."]}),"\n",(0,i.jsxs)(n.li,{children:["Run the gateway; it auto-starts the Discord channel when a token is available (config first, env fallback) and ",(0,i.jsx)(n.code,{children:"channels.discord.enabled"})," is not ",(0,i.jsx)(n.code,{children:"false"}),".\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["If you prefer env vars, set ",(0,i.jsx)(n.code,{children:"DISCORD_BOT_TOKEN"})," (a config block is optional)."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Direct chats: use ",(0,i.jsx)(n.code,{children:"user:<id>"})," (or a ",(0,i.jsx)(n.code,{children:"<@id>"})," mention) when delivering; all turns land in the shared ",(0,i.jsx)(n.code,{children:"main"})," session. Bare numeric IDs are ambiguous and rejected."]}),"\n",(0,i.jsxs)(n.li,{children:["Guild channels: use ",(0,i.jsx)(n.code,{children:"channel:<channelId>"})," for delivery. Mentions are required by default and can be set per guild or per channel."]}),"\n",(0,i.jsxs)(n.li,{children:["Direct chats: secure by default via ",(0,i.jsx)(n.code,{children:"channels.discord.dm.policy"})," (default: ",(0,i.jsx)(n.code,{children:'"pairing"'}),"). Unknown senders get a pairing code (expires after 1 hour); approve via ",(0,i.jsx)(n.code,{children:"moltbot pairing approve discord <code>"}),".\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["To keep old \u201copen to anyone\u201d behavior: set ",(0,i.jsx)(n.code,{children:'channels.discord.dm.policy="open"'})," and ",(0,i.jsx)(n.code,{children:'channels.discord.dm.allowFrom=["*"]'}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["To hard-allowlist: set ",(0,i.jsx)(n.code,{children:'channels.discord.dm.policy="allowlist"'})," and list senders in ",(0,i.jsx)(n.code,{children:"channels.discord.dm.allowFrom"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["To ignore all DMs: set ",(0,i.jsx)(n.code,{children:"channels.discord.dm.enabled=false"})," or ",(0,i.jsx)(n.code,{children:'channels.discord.dm.policy="disabled"'}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Group DMs are ignored by default; enable via ",(0,i.jsx)(n.code,{children:"channels.discord.dm.groupEnabled"})," and optionally restrict by ",(0,i.jsx)(n.code,{children:"channels.discord.dm.groupChannels"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Optional guild rules: set ",(0,i.jsx)(n.code,{children:"channels.discord.guilds"})," keyed by guild id (preferred) or slug, with per-channel rules."]}),"\n",(0,i.jsxs)(n.li,{children:["Optional native commands: ",(0,i.jsx)(n.code,{children:"commands.native"})," defaults to ",(0,i.jsx)(n.code,{children:'"auto"'})," (on for Discord/Telegram, off for Slack). Override with ",(0,i.jsx)(n.code,{children:'channels.discord.commands.native: true|false|"auto"'}),"; ",(0,i.jsx)(n.code,{children:"false"})," clears previously registered commands. Text commands are controlled by ",(0,i.jsx)(n.code,{children:"commands.text"})," and must be sent as standalone ",(0,i.jsx)(n.code,{children:"/..."})," messages. Use ",(0,i.jsx)(n.code,{children:"commands.useAccessGroups: false"})," to bypass access-group checks for commands.\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Full command list + config: ",(0,i.jsx)(n.a,{href:"/tools/slash-commands",children:"Slash commands"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Optional guild context history: set ",(0,i.jsx)(n.code,{children:"channels.discord.historyLimit"})," (default 20, falls back to ",(0,i.jsx)(n.code,{children:"messages.groupChat.historyLimit"}),") to include the last N guild messages as context when replying to a mention. Set ",(0,i.jsx)(n.code,{children:"0"})," to disable."]}),"\n",(0,i.jsxs)(n.li,{children:["Reactions: the agent can trigger reactions via the ",(0,i.jsx)(n.code,{children:"discord"})," tool (gated by ",(0,i.jsx)(n.code,{children:"channels.discord.actions.*"}),").\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Reaction removal semantics: see ",(0,i.jsx)(n.a,{href:"/tools/reactions",children:"/tools/reactions"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"discord"})," tool is only exposed when the current channel is Discord."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Native commands use isolated session keys (",(0,i.jsx)(n.code,{children:"agent:<agentId>:discord:slash:<userId>"}),") rather than the shared ",(0,i.jsx)(n.code,{children:"main"})," session."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Note: Name \u2192 id resolution uses guild member search and requires Server Members Intent; if the bot can\u2019t search members, use ids or ",(0,i.jsx)(n.code,{children:"<@id>"})," mentions.\nNote: Slugs are lowercase with spaces replaced by ",(0,i.jsx)(n.code,{children:"-"}),". Channel names are slugged without the leading ",(0,i.jsx)(n.code,{children:"#"}),".\nNote: Guild context ",(0,i.jsx)(n.code,{children:"[from:]"})," lines include ",(0,i.jsx)(n.code,{children:"author.tag"})," + ",(0,i.jsx)(n.code,{children:"id"})," to make ping-ready replies easy."]}),"\n",(0,i.jsx)(n.h2,{id:"config-writes",children:"Config writes"}),"\n",(0,i.jsxs)(n.p,{children:["By default, Discord is allowed to write config updates triggered by ",(0,i.jsx)(n.code,{children:"/config set|unset"})," (requires ",(0,i.jsx)(n.code,{children:"commands.config: true"}),")."]}),"\n",(0,i.jsx)(n.p,{children:"Disable with:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:"{\n  channels: { discord: { configWrites: false } }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"how-to-create-your-own-bot",children:"How to create your own bot"}),"\n",(0,i.jsxs)(n.p,{children:["This is the \u201cDiscord Developer Portal\u201d setup for running Moltbot in a server (guild) channel like ",(0,i.jsx)(n.code,{children:"#help"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"1-create-the-discord-app--bot-user",children:"1) Create the Discord app + bot user"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Discord Developer Portal \u2192 ",(0,i.jsx)(n.strong,{children:"Applications"})," \u2192 ",(0,i.jsx)(n.strong,{children:"New Application"})]}),"\n",(0,i.jsxs)(n.li,{children:["In your app:\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bot"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Add Bot"})]}),"\n",(0,i.jsxs)(n.li,{children:["Copy the ",(0,i.jsx)(n.strong,{children:"Bot Token"})," (this is what you put in ",(0,i.jsx)(n.code,{children:"DISCORD_BOT_TOKEN"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-enable-the-gateway-intents-moltbot-needs",children:"2) Enable the gateway intents Moltbot needs"}),"\n",(0,i.jsx)(n.p,{children:"Discord blocks \u201cprivileged intents\u201d unless you explicitly enable them."}),"\n",(0,i.jsxs)(n.p,{children:["In ",(0,i.jsx)(n.strong,{children:"Bot"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Privileged Gateway Intents"}),", enable:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Message Content Intent"})," (required to read message text in most guilds; without it you\u2019ll see \u201cUsed disallowed intents\u201d or the bot will connect but not react to messages)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Server Members Intent"})," (recommended; required for some member/user lookups and allowlist matching in guilds)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You usually do ",(0,i.jsx)(n.strong,{children:"not"})," need ",(0,i.jsx)(n.strong,{children:"Presence Intent"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"3-generate-an-invite-url-oauth2-url-generator",children:"3) Generate an invite URL (OAuth2 URL Generator)"}),"\n",(0,i.jsxs)(n.p,{children:["In your app: ",(0,i.jsx)(n.strong,{children:"OAuth2"})," \u2192 ",(0,i.jsx)(n.strong,{children:"URL Generator"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Scopes"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.code,{children:"bot"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u2705 ",(0,i.jsx)(n.code,{children:"applications.commands"})," (required for native commands)"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Bot Permissions"})," (minimal baseline)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 View Channels"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Send Messages"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Read Message History"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Embed Links"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Attach Files"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Add Reactions (optional but recommended)"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Use External Emojis / Stickers (optional; only if you want them)"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Avoid ",(0,i.jsx)(n.strong,{children:"Administrator"})," unless you\u2019re debugging and fully trust the bot."]}),"\n",(0,i.jsx)(n.p,{children:"Copy the generated URL, open it, pick your server, and install the bot."}),"\n",(0,i.jsx)(n.h3,{id:"4-get-the-ids-guilduserchannel",children:"4) Get the ids (guild/user/channel)"}),"\n",(0,i.jsx)(n.p,{children:"Discord uses numeric ids everywhere; Moltbot config prefers ids."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Discord (desktop/web) \u2192 ",(0,i.jsx)(n.strong,{children:"User Settings"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Advanced"})," \u2192 enable ",(0,i.jsx)(n.strong,{children:"Developer Mode"})]}),"\n",(0,i.jsxs)(n.li,{children:["Right-click:\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Server name \u2192 ",(0,i.jsx)(n.strong,{children:"Copy Server ID"})," (guild id)"]}),"\n",(0,i.jsxs)(n.li,{children:["Channel (e.g. ",(0,i.jsx)(n.code,{children:"#help"}),") \u2192 ",(0,i.jsx)(n.strong,{children:"Copy Channel ID"})]}),"\n",(0,i.jsxs)(n.li,{children:["Your user \u2192 ",(0,i.jsx)(n.strong,{children:"Copy User ID"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"5-configure-moltbot",children:"5) Configure Moltbot"}),"\n",(0,i.jsx)(n.h4,{id:"token",children:"Token"}),"\n",(0,i.jsx)(n.p,{children:"Set the bot token via env var (recommended on servers):"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"DISCORD_BOT_TOKEN=..."})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Or via config:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    discord: {\n      enabled: true,\n      token: "YOUR_BOT_TOKEN"\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Multi-account support: use ",(0,i.jsx)(n.code,{children:"channels.discord.accounts"})," with per-account tokens and optional ",(0,i.jsx)(n.code,{children:"name"}),". See ",(0,i.jsx)(n.a,{href:"/gateway/configuration#telegramaccounts--discordaccounts--slackaccounts--signalaccounts--imessageaccounts",children:(0,i.jsx)(n.code,{children:"gateway/configuration"})})," for the shared pattern."]}),"\n",(0,i.jsx)(n.h4,{id:"allowlist--channel-routing",children:"Allowlist + channel routing"}),"\n",(0,i.jsx)(n.p,{children:"Example \u201csingle server, only allow me, only allow #help\u201d:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    discord: {\n      enabled: true,\n      dm: { enabled: false },\n      guilds: {\n        "YOUR_GUILD_ID": {\n          users: ["YOUR_USER_ID"],\n          requireMention: true,\n          channels: {\n            help: { allow: true, requireMention: true }\n          }\n        }\n      },\n      retry: {\n        attempts: 3,\n        minDelayMs: 500,\n        maxDelayMs: 30000,\n        jitter: 0.1\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"requireMention: true"})," means the bot only replies when mentioned (recommended for shared channels)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"agents.list[].groupChat.mentionPatterns"})," (or ",(0,i.jsx)(n.code,{children:"messages.groupChat.mentionPatterns"}),") also count as mentions for guild messages."]}),"\n",(0,i.jsxs)(n.li,{children:["Multi-agent override: set per-agent patterns on ",(0,i.jsx)(n.code,{children:"agents.list[].groupChat.mentionPatterns"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["If ",(0,i.jsx)(n.code,{children:"channels"})," is present, any channel not listed is denied by default."]}),"\n",(0,i.jsxs)(n.li,{children:["Use a ",(0,i.jsx)(n.code,{children:'"*"'})," channel entry to apply defaults across all channels; explicit channel entries override the wildcard."]}),"\n",(0,i.jsxs)(n.li,{children:["Threads inherit parent channel config (allowlist, ",(0,i.jsx)(n.code,{children:"requireMention"}),", skills, prompts, etc.) unless you add the thread channel id explicitly."]}),"\n",(0,i.jsxs)(n.li,{children:["Bot-authored messages are ignored by default; set ",(0,i.jsx)(n.code,{children:"channels.discord.allowBots=true"})," to allow them (own messages remain filtered)."]}),"\n",(0,i.jsxs)(n.li,{children:["Warning: If you allow replies to other bots (",(0,i.jsx)(n.code,{children:"channels.discord.allowBots=true"}),"), prevent bot-to-bot reply loops with ",(0,i.jsx)(n.code,{children:"requireMention"}),", ",(0,i.jsx)(n.code,{children:"channels.discord.guilds.*.channels.<id>.users"})," allowlists, and/or clear guardrails in ",(0,i.jsx)(n.code,{children:"AGENTS.md"})," and ",(0,i.jsx)(n.code,{children:"SOUL.md"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"6-verify-it-works",children:"6) Verify it works"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Start the gateway."}),"\n",(0,i.jsxs)(n.li,{children:["In your server channel, send: ",(0,i.jsx)(n.code,{children:"@Krill hello"})," (or whatever your bot name is)."]}),"\n",(0,i.jsxs)(n.li,{children:["If nothing happens: check ",(0,i.jsx)(n.strong,{children:"Troubleshooting"})," below."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["First: run ",(0,i.jsx)(n.code,{children:"moltbot doctor"})," and ",(0,i.jsx)(n.code,{children:"moltbot channels status --probe"})," (actionable warnings + quick audits)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u201cUsed disallowed intents\u201d"}),": enable ",(0,i.jsx)(n.strong,{children:"Message Content Intent"})," (and likely ",(0,i.jsx)(n.strong,{children:"Server Members Intent"}),") in the Developer Portal, then restart the gateway."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bot connects but never replies in a guild channel"}),":\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Missing ",(0,i.jsx)(n.strong,{children:"Message Content Intent"}),", or"]}),"\n",(0,i.jsx)(n.li,{children:"The bot lacks channel permissions (View/Send/Read History), or"}),"\n",(0,i.jsx)(n.li,{children:"Your config requires mentions and you didn\u2019t mention it, or"}),"\n",(0,i.jsx)(n.li,{children:"Your guild/channel allowlist denies the channel/user."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.strong,{children:[(0,i.jsx)(n.code,{children:"requireMention: false"})," but still no replies"]}),":"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channels.discord.groupPolicy"})," defaults to ",(0,i.jsx)(n.strong,{children:"allowlist"}),"; set it to ",(0,i.jsx)(n.code,{children:'"open"'})," or add a guild entry under ",(0,i.jsx)(n.code,{children:"channels.discord.guilds"})," (optionally list channels under ",(0,i.jsx)(n.code,{children:"channels.discord.guilds.<id>.channels"})," to restrict).\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["If you only set ",(0,i.jsx)(n.code,{children:"DISCORD_BOT_TOKEN"})," and never create a ",(0,i.jsx)(n.code,{children:"channels.discord"})," section, the runtime\ndefaults ",(0,i.jsx)(n.code,{children:"groupPolicy"})," to ",(0,i.jsx)(n.code,{children:"open"}),". Add ",(0,i.jsx)(n.code,{children:"channels.discord.groupPolicy"}),",\n",(0,i.jsx)(n.code,{children:"channels.defaults.groupPolicy"}),", or a guild/channel allowlist to lock it down."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"requireMention"})," must live under ",(0,i.jsx)(n.code,{children:"channels.discord.guilds"})," (or a specific channel). ",(0,i.jsx)(n.code,{children:"channels.discord.requireMention"})," at the top level is ignored."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Permission audits"})," (",(0,i.jsx)(n.code,{children:"channels status --probe"}),") only check numeric channel IDs. If you use slugs/names as ",(0,i.jsx)(n.code,{children:"channels.discord.guilds.*.channels"})," keys, the audit can\u2019t verify permissions."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DMs don\u2019t work"}),": ",(0,i.jsx)(n.code,{children:"channels.discord.dm.enabled=false"}),", ",(0,i.jsx)(n.code,{children:'channels.discord.dm.policy="disabled"'}),", or you haven\u2019t been approved yet (",(0,i.jsx)(n.code,{children:'channels.discord.dm.policy="pairing"'}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"capabilities--limits",children:"Capabilities & limits"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"DMs and guild text channels (threads are treated as separate channels; voice not supported)."}),"\n",(0,i.jsxs)(n.li,{children:["Typing indicators sent best-effort; message chunking uses ",(0,i.jsx)(n.code,{children:"channels.discord.textChunkLimit"})," (default 2000) and splits tall replies by line count (",(0,i.jsx)(n.code,{children:"channels.discord.maxLinesPerMessage"}),", default 17)."]}),"\n",(0,i.jsxs)(n.li,{children:["Optional newline chunking: set ",(0,i.jsx)(n.code,{children:'channels.discord.chunkMode="newline"'})," to split on blank lines (paragraph boundaries) before length chunking."]}),"\n",(0,i.jsxs)(n.li,{children:["File uploads supported up to the configured ",(0,i.jsx)(n.code,{children:"channels.discord.mediaMaxMb"})," (default 8 MB)."]}),"\n",(0,i.jsx)(n.li,{children:"Mention-gated guild replies by default to avoid noisy bots."}),"\n",(0,i.jsx)(n.li,{children:"Reply context is injected when a message references another message (quoted content + ids)."}),"\n",(0,i.jsxs)(n.li,{children:["Native reply threading is ",(0,i.jsx)(n.strong,{children:"off by default"}),"; enable with ",(0,i.jsx)(n.code,{children:"channels.discord.replyToMode"})," and reply tags."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"retry-policy",children:"Retry policy"}),"\n",(0,i.jsxs)(n.p,{children:["Outbound Discord API calls retry on rate limits (429) using Discord ",(0,i.jsx)(n.code,{children:"retry_after"})," when available, with exponential backoff and jitter. Configure via ",(0,i.jsx)(n.code,{children:"channels.discord.retry"}),". See ",(0,i.jsx)(n.a,{href:"/concepts/retry",children:"Retry policy"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"config",children:"Config"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    discord: {\n      enabled: true,\n      token: "abc.123",\n      groupPolicy: "allowlist",\n      guilds: {\n        "*": {\n          channels: {\n            general: { allow: true }\n          }\n        }\n      },\n      mediaMaxMb: 8,\n      actions: {\n        reactions: true,\n        stickers: true,\n        emojiUploads: true,\n        stickerUploads: true,\n        polls: true,\n        permissions: true,\n        messages: true,\n        threads: true,\n        pins: true,\n        search: true,\n        memberInfo: true,\n        roleInfo: true,\n        roles: false,\n        channelInfo: true,\n        channels: true,\n        voiceStatus: true,\n        events: true,\n        moderation: false\n      },\n      replyToMode: "off",\n      dm: {\n        enabled: true,\n        policy: "pairing", // pairing | allowlist | open | disabled\n        allowFrom: ["123456789012345678", "steipete"],\n        groupEnabled: false,\n        groupChannels: ["clawd-dm"]\n      },\n      guilds: {\n        "*": { requireMention: true },\n        "123456789012345678": {\n          slug: "friends-of-clawd",\n          requireMention: false,\n          reactionNotifications: "own",\n          users: ["987654321098765432", "steipete"],\n          channels: {\n            general: { allow: true },\n            help: {\n              allow: true,\n              requireMention: true,\n              users: ["987654321098765432"],\n              skills: ["search", "docs"],\n              systemPrompt: "Keep answers short."\n            }\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Ack reactions are controlled globally via ",(0,i.jsx)(n.code,{children:"messages.ackReaction"})," +\n",(0,i.jsx)(n.code,{children:"messages.ackReactionScope"}),". Use ",(0,i.jsx)(n.code,{children:"messages.removeAckAfterReply"})," to clear the\nack reaction after the bot replies."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dm.enabled"}),": set ",(0,i.jsx)(n.code,{children:"false"})," to ignore all DMs (default ",(0,i.jsx)(n.code,{children:"true"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dm.policy"}),": DM access control (",(0,i.jsx)(n.code,{children:"pairing"})," recommended). ",(0,i.jsx)(n.code,{children:'"open"'})," requires ",(0,i.jsx)(n.code,{children:'dm.allowFrom=["*"]'}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dm.allowFrom"}),": DM allowlist (user ids or names). Used by ",(0,i.jsx)(n.code,{children:'dm.policy="allowlist"'})," and for ",(0,i.jsx)(n.code,{children:'dm.policy="open"'})," validation. The wizard accepts usernames and resolves them to ids when the bot can search members."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dm.groupEnabled"}),": enable group DMs (default ",(0,i.jsx)(n.code,{children:"false"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dm.groupChannels"}),": optional allowlist for group DM channel ids or slugs."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"groupPolicy"}),": controls guild channel handling (",(0,i.jsx)(n.code,{children:"open|disabled|allowlist"}),"); ",(0,i.jsx)(n.code,{children:"allowlist"})," requires channel allowlists."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds"}),": per-guild rules keyed by guild id (preferred) or slug."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'guilds."*"'}),": default per-guild settings applied when no explicit entry exists."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.slug"}),": optional friendly slug used for display names."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.users"}),": optional per-guild user allowlist (ids or names)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.tools"}),": optional per-guild tool policy overrides (",(0,i.jsx)(n.code,{children:"allow"}),"/",(0,i.jsx)(n.code,{children:"deny"}),"/",(0,i.jsx)(n.code,{children:"alsoAllow"}),") used when the channel override is missing."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.toolsBySender"}),": optional per-sender tool policy overrides at the guild level (applies when the channel override is missing; ",(0,i.jsx)(n.code,{children:'"*"'})," wildcard supported)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.allow"}),": allow/deny the channel when ",(0,i.jsx)(n.code,{children:'groupPolicy="allowlist"'}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.requireMention"}),": mention gating for the channel."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.tools"}),": optional per-channel tool policy overrides (",(0,i.jsx)(n.code,{children:"allow"}),"/",(0,i.jsx)(n.code,{children:"deny"}),"/",(0,i.jsx)(n.code,{children:"alsoAllow"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.toolsBySender"}),": optional per-sender tool policy overrides within the channel (",(0,i.jsx)(n.code,{children:'"*"'})," wildcard supported)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.users"}),": optional per-channel user allowlist."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.skills"}),": skill filter (omit = all skills, empty = none)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.systemPrompt"}),": extra system prompt for the channel (combined with channel topic)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels.<channel>.enabled"}),": set ",(0,i.jsx)(n.code,{children:"false"})," to disable the channel."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.channels"}),": channel rules (keys are channel slugs or ids)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.requireMention"}),": per-guild mention requirement (overridable per channel)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"guilds.<id>.reactionNotifications"}),": reaction system event mode (",(0,i.jsx)(n.code,{children:"off"}),", ",(0,i.jsx)(n.code,{children:"own"}),", ",(0,i.jsx)(n.code,{children:"all"}),", ",(0,i.jsx)(n.code,{children:"allowlist"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"textChunkLimit"}),": outbound text chunk size (chars). Default: 2000."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"chunkMode"}),": ",(0,i.jsx)(n.code,{children:"length"})," (default) splits only when exceeding ",(0,i.jsx)(n.code,{children:"textChunkLimit"}),"; ",(0,i.jsx)(n.code,{children:"newline"})," splits on blank lines (paragraph boundaries) before length chunking."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"maxLinesPerMessage"}),": soft max line count per message. Default: 17."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"mediaMaxMb"}),": clamp inbound media saved to disk."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"historyLimit"}),": number of recent guild messages to include as context when replying to a mention (default 20; falls back to ",(0,i.jsx)(n.code,{children:"messages.groupChat.historyLimit"}),"; ",(0,i.jsx)(n.code,{children:"0"})," disables)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dmHistoryLimit"}),": DM history limit in user turns. Per-user overrides: ",(0,i.jsx)(n.code,{children:'dms["<user_id>"].historyLimit'}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"retry"}),": retry policy for outbound Discord API calls (attempts, minDelayMs, maxDelayMs, jitter)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"actions"}),": per-action tool gates; omit to allow all (set ",(0,i.jsx)(n.code,{children:"false"})," to disable).\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"reactions"})," (covers react + read reactions)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"stickers"}),", ",(0,i.jsx)(n.code,{children:"emojiUploads"}),", ",(0,i.jsx)(n.code,{children:"stickerUploads"}),", ",(0,i.jsx)(n.code,{children:"polls"}),", ",(0,i.jsx)(n.code,{children:"permissions"}),", ",(0,i.jsx)(n.code,{children:"messages"}),", ",(0,i.jsx)(n.code,{children:"threads"}),", ",(0,i.jsx)(n.code,{children:"pins"}),", ",(0,i.jsx)(n.code,{children:"search"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"memberInfo"}),", ",(0,i.jsx)(n.code,{children:"roleInfo"}),", ",(0,i.jsx)(n.code,{children:"channelInfo"}),", ",(0,i.jsx)(n.code,{children:"voiceStatus"}),", ",(0,i.jsx)(n.code,{children:"events"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channels"})," (create/edit/delete channels + categories + permissions)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"roles"})," (role add/remove, default ",(0,i.jsx)(n.code,{children:"false"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"moderation"})," (timeout/kick/ban, default ",(0,i.jsx)(n.code,{children:"false"}),")"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Reaction notifications use ",(0,i.jsx)(n.code,{children:"guilds.<id>.reactionNotifications"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"off"}),": no reaction events."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"own"}),": reactions on the bot's own messages (default)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"all"}),": all reactions on all messages."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowlist"}),": reactions from ",(0,i.jsx)(n.code,{children:"guilds.<id>.users"})," on all messages (empty list disables)."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"tool-action-defaults",children:"Tool action defaults"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Action group"}),(0,i.jsx)(n.th,{children:"Default"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"reactions"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"React + list reactions + emojiList"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"stickers"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Send stickers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"emojiUploads"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Upload emojis"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"stickerUploads"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Upload stickers"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"polls"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Create polls"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"permissions"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Channel permission snapshot"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"messages"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Read/send/edit/delete"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"threads"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Create/list/reply"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"pins"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Pin/unpin/list"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"search"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Message search (preview feature)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"memberInfo"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Member info"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"roleInfo"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Role list"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"channelInfo"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Channel info + list"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"channels"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Channel/category management"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"voiceStatus"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"Voice state lookup"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"events"}),(0,i.jsx)(n.td,{children:"enabled"}),(0,i.jsx)(n.td,{children:"List/create scheduled events"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"roles"}),(0,i.jsx)(n.td,{children:"disabled"}),(0,i.jsx)(n.td,{children:"Role add/remove"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"moderation"}),(0,i.jsx)(n.td,{children:"disabled"}),(0,i.jsx)(n.td,{children:"Timeout/kick/ban"})]})]})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"replyToMode"}),": ",(0,i.jsx)(n.code,{children:"off"})," (default), ",(0,i.jsx)(n.code,{children:"first"}),", or ",(0,i.jsx)(n.code,{children:"all"}),". Applies only when the model includes a reply tag."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"reply-tags",children:"Reply tags"}),"\n",(0,i.jsx)(n.p,{children:"To request a threaded reply, the model can include one tag in its output:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"[[reply_to_current]]"})," \u2014 reply to the triggering Discord message."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"[[reply_to:<id>]]"})," \u2014 reply to a specific message id from context/history.\nCurrent message ids are appended to prompts as ",(0,i.jsx)(n.code,{children:"[message_id: \u2026]"}),"; history entries already include ids."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Behavior is controlled by ",(0,i.jsx)(n.code,{children:"channels.discord.replyToMode"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"off"}),": ignore tags."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"first"}),": only the first outbound chunk/attachment is a reply."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"all"}),": every outbound chunk/attachment is a reply."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Allowlist matching notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"allowFrom"}),"/",(0,i.jsx)(n.code,{children:"users"}),"/",(0,i.jsx)(n.code,{children:"groupChannels"})," accept ids, names, tags, or mentions like ",(0,i.jsx)(n.code,{children:"<@id>"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Prefixes like ",(0,i.jsx)(n.code,{children:"discord:"}),"/",(0,i.jsx)(n.code,{children:"user:"})," (users) and ",(0,i.jsx)(n.code,{children:"channel:"})," (group DMs) are supported."]}),"\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.code,{children:"*"})," to allow any sender/channel."]}),"\n",(0,i.jsxs)(n.li,{children:["When ",(0,i.jsx)(n.code,{children:"guilds.<id>.channels"})," is present, channels not listed are denied by default."]}),"\n",(0,i.jsxs)(n.li,{children:["When ",(0,i.jsx)(n.code,{children:"guilds.<id>.channels"})," is omitted, all channels in the allowlisted guild are allowed."]}),"\n",(0,i.jsxs)(n.li,{children:["To allow ",(0,i.jsx)(n.strong,{children:"no channels"}),", set ",(0,i.jsx)(n.code,{children:'channels.discord.groupPolicy: "disabled"'})," (or keep an empty allowlist)."]}),"\n",(0,i.jsxs)(n.li,{children:["The configure wizard accepts ",(0,i.jsx)(n.code,{children:"Guild/Channel"})," names (public + private) and resolves them to IDs when possible."]}),"\n",(0,i.jsx)(n.li,{children:"On startup, Moltbot resolves channel/user names in allowlists to IDs (when the bot can search members)\nand logs the mapping; unresolved entries are kept as typed."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Native command notes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The registered commands mirror Moltbot\u2019s chat commands."}),"\n",(0,i.jsxs)(n.li,{children:["Native commands honor the same allowlists as DMs/guild messages (",(0,i.jsx)(n.code,{children:"channels.discord.dm.allowFrom"}),", ",(0,i.jsx)(n.code,{children:"channels.discord.guilds"}),", per-channel rules)."]}),"\n",(0,i.jsx)(n.li,{children:"Slash commands may still be visible in Discord UI to users who aren\u2019t allowlisted; Moltbot enforces allowlists on execution and replies \u201cnot authorized\u201d."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"tool-actions",children:"Tool actions"}),"\n",(0,i.jsxs)(n.p,{children:["The agent can call ",(0,i.jsx)(n.code,{children:"discord"})," with actions like:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"react"})," / ",(0,i.jsx)(n.code,{children:"reactions"})," (add or list reactions)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sticker"}),", ",(0,i.jsx)(n.code,{children:"poll"}),", ",(0,i.jsx)(n.code,{children:"permissions"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"readMessages"}),", ",(0,i.jsx)(n.code,{children:"sendMessage"}),", ",(0,i.jsx)(n.code,{children:"editMessage"}),", ",(0,i.jsx)(n.code,{children:"deleteMessage"})]}),"\n",(0,i.jsxs)(n.li,{children:["Read/search/pin tool payloads include normalized ",(0,i.jsx)(n.code,{children:"timestampMs"})," (UTC epoch ms) and ",(0,i.jsx)(n.code,{children:"timestampUtc"})," alongside raw Discord ",(0,i.jsx)(n.code,{children:"timestamp"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"threadCreate"}),", ",(0,i.jsx)(n.code,{children:"threadList"}),", ",(0,i.jsx)(n.code,{children:"threadReply"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"pinMessage"}),", ",(0,i.jsx)(n.code,{children:"unpinMessage"}),", ",(0,i.jsx)(n.code,{children:"listPins"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"searchMessages"}),", ",(0,i.jsx)(n.code,{children:"memberInfo"}),", ",(0,i.jsx)(n.code,{children:"roleInfo"}),", ",(0,i.jsx)(n.code,{children:"roleAdd"}),", ",(0,i.jsx)(n.code,{children:"roleRemove"}),", ",(0,i.jsx)(n.code,{children:"emojiList"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channelInfo"}),", ",(0,i.jsx)(n.code,{children:"channelList"}),", ",(0,i.jsx)(n.code,{children:"voiceStatus"}),", ",(0,i.jsx)(n.code,{children:"eventList"}),", ",(0,i.jsx)(n.code,{children:"eventCreate"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"timeout"}),", ",(0,i.jsx)(n.code,{children:"kick"}),", ",(0,i.jsx)(n.code,{children:"ban"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Discord message ids are surfaced in the injected context (",(0,i.jsx)(n.code,{children:"[discord message id: \u2026]"})," and history lines) so the agent can target them.\nEmoji can be unicode (e.g., ",(0,i.jsx)(n.code,{children:"\u2705"}),") or custom emoji syntax like ",(0,i.jsx)(n.code,{children:"<:party_blob:1234567890>"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"safety--ops",children:"Safety & ops"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Treat the bot token like a password; prefer the ",(0,i.jsx)(n.code,{children:"DISCORD_BOT_TOKEN"})," env var on supervised hosts or lock down the config file permissions."]}),"\n",(0,i.jsx)(n.li,{children:"Only grant the bot permissions it needs (typically Read/Send Messages)."}),"\n",(0,i.jsxs)(n.li,{children:["If the bot is stuck or rate limited, restart the gateway (",(0,i.jsx)(n.code,{children:"moltbot gateway --force"}),") after confirming no other processes own the Discord session."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453(e,n,s){s.d(n,{R:()=>r,x:()=>c});var l=s(96540);const i={},d=l.createContext(i);function r(e){const n=l.useContext(d);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),l.createElement(d.Provider,{value:n},e.children)}}}]);