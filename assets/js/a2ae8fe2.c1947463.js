"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[7803],{33815(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"nodes/talk","title":"Talk Mode","description":"Talk mode is a continuous voice conversation loop:","source":"@site/content/moltbot/docs/nodes/talk.md","sourceDirName":"nodes","slug":"/nodes/talk","permalink":"/moltbot-doc/docs/nodes/talk","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Talk mode: continuous speech conversations with ElevenLabs TTS","read_when":["Implementing Talk mode on macOS/iOS/Android","Changing voice/TTS/interrupt behavior"]}}');var l=i(74848),c=i(28453);const o={summary:"Talk mode: continuous speech conversations with ElevenLabs TTS",read_when:["Implementing Talk mode on macOS/iOS/Android","Changing voice/TTS/interrupt behavior"]},r="Talk Mode",d={},t=[{value:"Behavior (macOS)",id:"behavior-macos",level:2},{value:"Voice directives in replies",id:"voice-directives-in-replies",level:2},{value:"Config (<code>~/.clawdbot/moltbot.json</code>)",id:"config-clawdbotmoltbotjson",level:2},{value:"macOS UI",id:"macos-ui",level:2},{value:"Notes",id:"notes",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"talk-mode",children:"Talk Mode"})}),"\n",(0,l.jsx)(n.p,{children:"Talk mode is a continuous voice conversation loop:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Listen for speech"}),"\n",(0,l.jsx)(n.li,{children:"Send transcript to the model (main session, chat.send)"}),"\n",(0,l.jsx)(n.li,{children:"Wait for the response"}),"\n",(0,l.jsx)(n.li,{children:"Speak it via ElevenLabs (streaming playback)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"behavior-macos",children:"Behavior (macOS)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Always-on overlay"})," while Talk mode is enabled."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Listening \u2192 Thinking \u2192 Speaking"})," phase transitions."]}),"\n",(0,l.jsxs)(n.li,{children:["On a ",(0,l.jsx)(n.strong,{children:"short pause"})," (silence window), the current transcript is sent."]}),"\n",(0,l.jsxs)(n.li,{children:["Replies are ",(0,l.jsx)(n.strong,{children:"written to WebChat"})," (same as typing)."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Interrupt on speech"})," (default on): if the user starts talking while the assistant is speaking, we stop playback and note the interruption timestamp for the next prompt."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"voice-directives-in-replies",children:"Voice directives in replies"}),"\n",(0,l.jsxs)(n.p,{children:["The assistant may prefix its reply with a ",(0,l.jsx)(n.strong,{children:"single JSON line"})," to control voice:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{"voice":"<voice-id>","once":true}\n'})}),"\n",(0,l.jsx)(n.p,{children:"Rules:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"First non-empty line only."}),"\n",(0,l.jsx)(n.li,{children:"Unknown keys are ignored."}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"once: true"})," applies to the current reply only."]}),"\n",(0,l.jsxs)(n.li,{children:["Without ",(0,l.jsx)(n.code,{children:"once"}),", the voice becomes the new default for Talk mode."]}),"\n",(0,l.jsx)(n.li,{children:"The JSON line is stripped before TTS playback."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Supported keys:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"voice"})," / ",(0,l.jsx)(n.code,{children:"voice_id"})," / ",(0,l.jsx)(n.code,{children:"voiceId"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"model"})," / ",(0,l.jsx)(n.code,{children:"model_id"})," / ",(0,l.jsx)(n.code,{children:"modelId"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"speed"}),", ",(0,l.jsx)(n.code,{children:"rate"})," (WPM), ",(0,l.jsx)(n.code,{children:"stability"}),", ",(0,l.jsx)(n.code,{children:"similarity"}),", ",(0,l.jsx)(n.code,{children:"style"}),", ",(0,l.jsx)(n.code,{children:"speakerBoost"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"seed"}),", ",(0,l.jsx)(n.code,{children:"normalize"}),", ",(0,l.jsx)(n.code,{children:"lang"}),", ",(0,l.jsx)(n.code,{children:"output_format"}),", ",(0,l.jsx)(n.code,{children:"latency_tier"})]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"once"})}),"\n"]}),"\n",(0,l.jsxs)(n.h2,{id:"config-clawdbotmoltbotjson",children:["Config (",(0,l.jsx)(n.code,{children:"~/.clawdbot/moltbot.json"}),")"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json5",children:'{\n  "talk": {\n    "voiceId": "elevenlabs_voice_id",\n    "modelId": "eleven_v3",\n    "outputFormat": "mp3_44100_128",\n    "apiKey": "elevenlabs_api_key",\n    "interruptOnSpeech": true\n  }\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"Defaults:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"interruptOnSpeech"}),": true"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"voiceId"}),": falls back to ",(0,l.jsx)(n.code,{children:"ELEVENLABS_VOICE_ID"})," / ",(0,l.jsx)(n.code,{children:"SAG_VOICE_ID"})," (or first ElevenLabs voice when API key is available)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"modelId"}),": defaults to ",(0,l.jsx)(n.code,{children:"eleven_v3"})," when unset"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"apiKey"}),": falls back to ",(0,l.jsx)(n.code,{children:"ELEVENLABS_API_KEY"})," (or gateway shell profile if available)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"outputFormat"}),": defaults to ",(0,l.jsx)(n.code,{children:"pcm_44100"})," on macOS/iOS and ",(0,l.jsx)(n.code,{children:"pcm_24000"})," on Android (set ",(0,l.jsx)(n.code,{children:"mp3_*"})," to force MP3 streaming)"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"macos-ui",children:"macOS UI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Menu bar toggle: ",(0,l.jsx)(n.strong,{children:"Talk"})]}),"\n",(0,l.jsxs)(n.li,{children:["Config tab: ",(0,l.jsx)(n.strong,{children:"Talk Mode"})," group (voice id + interrupt toggle)"]}),"\n",(0,l.jsxs)(n.li,{children:["Overlay:\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Listening"}),": cloud pulses with mic level"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Thinking"}),": sinking animation"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Speaking"}),": radiating rings"]}),"\n",(0,l.jsx)(n.li,{children:"Click cloud: stop speaking"}),"\n",(0,l.jsx)(n.li,{children:"Click X: exit Talk mode"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Requires Speech + Microphone permissions."}),"\n",(0,l.jsxs)(n.li,{children:["Uses ",(0,l.jsx)(n.code,{children:"chat.send"})," against session key ",(0,l.jsx)(n.code,{children:"main"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["TTS uses ElevenLabs streaming API with ",(0,l.jsx)(n.code,{children:"ELEVENLABS_API_KEY"})," and incremental playback on macOS/iOS/Android for lower latency."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"stability"})," for ",(0,l.jsx)(n.code,{children:"eleven_v3"})," is validated to ",(0,l.jsx)(n.code,{children:"0.0"}),", ",(0,l.jsx)(n.code,{children:"0.5"}),", or ",(0,l.jsx)(n.code,{children:"1.0"}),"; other models accept ",(0,l.jsx)(n.code,{children:"0..1"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"latency_tier"})," is validated to ",(0,l.jsx)(n.code,{children:"0..4"})," when set."]}),"\n",(0,l.jsxs)(n.li,{children:["Android supports ",(0,l.jsx)(n.code,{children:"pcm_16000"}),", ",(0,l.jsx)(n.code,{children:"pcm_22050"}),", ",(0,l.jsx)(n.code,{children:"pcm_24000"}),", and ",(0,l.jsx)(n.code,{children:"pcm_44100"})," output formats for low-latency AudioTrack streaming."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},28453(e,n,i){i.d(n,{R:()=>o,x:()=>r});var s=i(96540);const l={},c=s.createContext(l);function o(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);