"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[1678],{10875(e,n,l){l.r(n),l.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"plugins/voice-call","title":"Voice Call (plugin)","description":"Voice calls for Moltbot via a plugin. Supports outbound notifications and","source":"@site/content/moltbot/docs/plugins/voice-call.md","sourceDirName":"plugins","slug":"/plugins/voice-call","permalink":"/moltbot-doc/docs/plugins/voice-call","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Voice Call plugin: outbound + inbound calls via Twilio/Telnyx/Plivo (plugin install + config + CLI)","read_when":["You want to place an outbound voice call from Moltbot","You are configuring or developing the voice-call plugin"]}}');var o=l(74848),s=l(28453);const c={summary:"Voice Call plugin: outbound + inbound calls via Twilio/Telnyx/Plivo (plugin install + config + CLI)",read_when:["You want to place an outbound voice call from Moltbot","You are configuring or developing the voice-call plugin"]},r="Voice Call (plugin)",a={},d=[{value:"Where it runs (local vs remote)",id:"where-it-runs-local-vs-remote",level:2},{value:"Install",id:"install",level:2},{value:"Option A: install from npm (recommended)",id:"option-a-install-from-npm-recommended",level:3},{value:"Option B: install from a local folder (dev, no copying)",id:"option-b-install-from-a-local-folder-dev-no-copying",level:3},{value:"Config",id:"config",level:2},{value:"TTS for calls",id:"tts-for-calls",level:2},{value:"More examples",id:"more-examples",level:3},{value:"Inbound calls",id:"inbound-calls",level:2},{value:"CLI",id:"cli",level:2},{value:"Agent tool",id:"agent-tool",level:2},{value:"Gateway RPC",id:"gateway-rpc",level:2}];function t(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"voice-call-plugin",children:"Voice Call (plugin)"})}),"\n",(0,o.jsx)(n.p,{children:"Voice calls for Moltbot via a plugin. Supports outbound notifications and\nmulti-turn conversations with inbound policies."}),"\n",(0,o.jsx)(n.p,{children:"Current providers:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"twilio"})," (Programmable Voice + Media Streams)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"telnyx"})," (Call Control v2)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"plivo"})," (Voice API + XML transfer + GetInput speech)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"mock"})," (dev/no network)"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Quick mental model:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Install plugin"}),"\n",(0,o.jsx)(n.li,{children:"Restart Gateway"}),"\n",(0,o.jsxs)(n.li,{children:["Configure under ",(0,o.jsx)(n.code,{children:"plugins.entries.voice-call.config"})]}),"\n",(0,o.jsxs)(n.li,{children:["Use ",(0,o.jsx)(n.code,{children:"moltbot voicecall ..."})," or the ",(0,o.jsx)(n.code,{children:"voice_call"})," tool"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"where-it-runs-local-vs-remote",children:"Where it runs (local vs remote)"}),"\n",(0,o.jsxs)(n.p,{children:["The Voice Call plugin runs ",(0,o.jsx)(n.strong,{children:"inside the Gateway process"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["If you use a remote Gateway, install/configure the plugin on the ",(0,o.jsx)(n.strong,{children:"machine running the Gateway"}),", then restart the Gateway to load it."]}),"\n",(0,o.jsx)(n.h2,{id:"install",children:"Install"}),"\n",(0,o.jsx)(n.h3,{id:"option-a-install-from-npm-recommended",children:"Option A: install from npm (recommended)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"moltbot plugins install @moltbot/voice-call\n"})}),"\n",(0,o.jsx)(n.p,{children:"Restart the Gateway afterwards."}),"\n",(0,o.jsx)(n.h3,{id:"option-b-install-from-a-local-folder-dev-no-copying",children:"Option B: install from a local folder (dev, no copying)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"moltbot plugins install ./extensions/voice-call\ncd ./extensions/voice-call && pnpm install\n"})}),"\n",(0,o.jsx)(n.p,{children:"Restart the Gateway afterwards."}),"\n",(0,o.jsx)(n.h2,{id:"config",children:"Config"}),"\n",(0,o.jsxs)(n.p,{children:["Set config under ",(0,o.jsx)(n.code,{children:"plugins.entries.voice-call.config"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json5",children:'{\n  plugins: {\n    entries: {\n      "voice-call": {\n        enabled: true,\n        config: {\n          provider: "twilio", // or "telnyx" | "plivo" | "mock"\n          fromNumber: "+15550001234",\n          toNumber: "+15550005678",\n\n          twilio: {\n            accountSid: "ACxxxxxxxx",\n            authToken: "..."\n          },\n\n          plivo: {\n            authId: "MAxxxxxxxxxxxxxxxxxxxx",\n            authToken: "..."\n          },\n\n          // Webhook server\n          serve: {\n            port: 3334,\n            path: "/voice/webhook"\n          },\n\n          // Public exposure (pick one)\n          // publicUrl: "https://example.ngrok.app/voice/webhook",\n          // tunnel: { provider: "ngrok" },\n          // tailscale: { mode: "funnel", path: "/voice/webhook" }\n\n          outbound: {\n            defaultMode: "notify" // notify | conversation\n          },\n\n          streaming: {\n            enabled: true,\n            streamPath: "/voice/stream"\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Notes:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Twilio/Telnyx require a ",(0,o.jsx)(n.strong,{children:"publicly reachable"})," webhook URL."]}),"\n",(0,o.jsxs)(n.li,{children:["Plivo requires a ",(0,o.jsx)(n.strong,{children:"publicly reachable"})," webhook URL."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"mock"})," is a local dev provider (no network calls)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"skipSignatureVerification"})," is for local testing only."]}),"\n",(0,o.jsxs)(n.li,{children:["If you use ngrok free tier, set ",(0,o.jsx)(n.code,{children:"publicUrl"})," to the exact ngrok URL; signature verification is always enforced."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"tunnel.allowNgrokFreeTierLoopbackBypass: true"})," allows Twilio webhooks with invalid signatures ",(0,o.jsx)(n.strong,{children:"only"})," when ",(0,o.jsx)(n.code,{children:'tunnel.provider="ngrok"'})," and ",(0,o.jsx)(n.code,{children:"serve.bind"})," is loopback (ngrok local agent). Use for local dev only."]}),"\n",(0,o.jsxs)(n.li,{children:["Ngrok free tier URLs can change or add interstitial behavior; if ",(0,o.jsx)(n.code,{children:"publicUrl"})," drifts, Twilio signatures will fail. For production, prefer a stable domain or Tailscale funnel."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"tts-for-calls",children:"TTS for calls"}),"\n",(0,o.jsxs)(n.p,{children:["Voice Call uses the core ",(0,o.jsx)(n.code,{children:"messages.tts"})," configuration (OpenAI or ElevenLabs) for\nstreaming speech on calls. You can override it under the plugin config with the\n",(0,o.jsx)(n.strong,{children:"same shape"})," \u2014 it deep\u2011merges with ",(0,o.jsx)(n.code,{children:"messages.tts"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json5",children:'{\n  tts: {\n    provider: "elevenlabs",\n    elevenlabs: {\n      voiceId: "pMsXgVXv3BLzUgSXRplE",\n      modelId: "eleven_multilingual_v2"\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Notes:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Edge TTS is ignored for voice calls"})," (telephony audio needs PCM; Edge output is unreliable)."]}),"\n",(0,o.jsx)(n.li,{children:"Core TTS is used when Twilio media streaming is enabled; otherwise calls fall back to provider native voices."}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"more-examples",children:"More examples"}),"\n",(0,o.jsx)(n.p,{children:"Use core TTS only (no override):"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json5",children:'{\n  messages: {\n    tts: {\n      provider: "openai",\n      openai: { voice: "alloy" }\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Override to ElevenLabs just for calls (keep core default elsewhere):"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json5",children:'{\n  plugins: {\n    entries: {\n      "voice-call": {\n        config: {\n          tts: {\n            provider: "elevenlabs",\n            elevenlabs: {\n              apiKey: "elevenlabs_key",\n              voiceId: "pMsXgVXv3BLzUgSXRplE",\n              modelId: "eleven_multilingual_v2"\n            }\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Override only the OpenAI model for calls (deep\u2011merge example):"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json5",children:'{\n  plugins: {\n    entries: {\n      "voice-call": {\n        config: {\n          tts: {\n            openai: {\n              model: "gpt-4o-mini-tts",\n              voice: "marin"\n            }\n          }\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"inbound-calls",children:"Inbound calls"}),"\n",(0,o.jsxs)(n.p,{children:["Inbound policy defaults to ",(0,o.jsx)(n.code,{children:"disabled"}),". To enable inbound calls, set:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json5",children:'{\n  inboundPolicy: "allowlist",\n  allowFrom: ["+15550001234"],\n  inboundGreeting: "Hello! How can I help?"\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Auto-responses use the agent system. Tune with:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"responseModel"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"responseSystemPrompt"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"responseTimeoutMs"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"cli",children:"CLI"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'moltbot voicecall call --to "+15555550123" --message "Hello from Moltbot"\nmoltbot voicecall continue --call-id <id> --message "Any questions?"\nmoltbot voicecall speak --call-id <id> --message "One moment"\nmoltbot voicecall end --call-id <id>\nmoltbot voicecall status --call-id <id>\nmoltbot voicecall tail\nmoltbot voicecall expose --mode funnel\n'})}),"\n",(0,o.jsx)(n.h2,{id:"agent-tool",children:"Agent tool"}),"\n",(0,o.jsxs)(n.p,{children:["Tool name: ",(0,o.jsx)(n.code,{children:"voice_call"})]}),"\n",(0,o.jsx)(n.p,{children:"Actions:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"initiate_call"})," (message, to?, mode?)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"continue_call"})," (callId, message)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"speak_to_user"})," (callId, message)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"end_call"})," (callId)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"get_status"})," (callId)"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["This repo ships a matching skill doc at ",(0,o.jsx)(n.code,{children:"skills/voice-call/SKILL.md"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"gateway-rpc",children:"Gateway RPC"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"voicecall.initiate"})," (",(0,o.jsx)(n.code,{children:"to?"}),", ",(0,o.jsx)(n.code,{children:"message"}),", ",(0,o.jsx)(n.code,{children:"mode?"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"voicecall.continue"})," (",(0,o.jsx)(n.code,{children:"callId"}),", ",(0,o.jsx)(n.code,{children:"message"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"voicecall.speak"})," (",(0,o.jsx)(n.code,{children:"callId"}),", ",(0,o.jsx)(n.code,{children:"message"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"voicecall.end"})," (",(0,o.jsx)(n.code,{children:"callId"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"voicecall.status"})," (",(0,o.jsx)(n.code,{children:"callId"}),")"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},28453(e,n,l){l.d(n,{R:()=>c,x:()=>r});var i=l(96540);const o={},s=i.createContext(o);function c(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);