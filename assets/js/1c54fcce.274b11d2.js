"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[1801],{58871(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"reference/rpc","title":"RPC adapters","description":"Moltbot integrates external CLIs via JSON-RPC. Two patterns are used today.","source":"@site/content/moltbot/docs/reference/rpc.md","sourceDirName":"reference","slug":"/reference/rpc","permalink":"/moltbot-doc/docs/reference/rpc","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"RPC adapters for external CLIs (signal-cli, imsg) and gateway patterns","read_when":["Adding or changing external CLI integrations","Debugging RPC adapters (signal-cli, imsg)"]}}');var r=s(74848),t=s(28453);const a={summary:"RPC adapters for external CLIs (signal-cli, imsg) and gateway patterns",read_when:["Adding or changing external CLI integrations","Debugging RPC adapters (signal-cli, imsg)"]},c="RPC adapters",l={},d=[{value:"Pattern A: HTTP daemon (signal-cli)",id:"pattern-a-http-daemon-signal-cli",level:2},{value:"Pattern B: stdio child process (imsg)",id:"pattern-b-stdio-child-process-imsg",level:2},{value:"Adapter guidelines",id:"adapter-guidelines",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"rpc-adapters",children:"RPC adapters"})}),"\n",(0,r.jsx)(n.p,{children:"Moltbot integrates external CLIs via JSON-RPC. Two patterns are used today."}),"\n",(0,r.jsx)(n.h2,{id:"pattern-a-http-daemon-signal-cli",children:"Pattern A: HTTP daemon (signal-cli)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"signal-cli"})," runs as a daemon with JSON-RPC over HTTP."]}),"\n",(0,r.jsxs)(n.li,{children:["Event stream is SSE (",(0,r.jsx)(n.code,{children:"/api/v1/events"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["Health probe: ",(0,r.jsx)(n.code,{children:"/api/v1/check"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Moltbot owns lifecycle when ",(0,r.jsx)(n.code,{children:"channels.signal.autoStart=true"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/channels/signal",children:"Signal"})," for setup and endpoints."]}),"\n",(0,r.jsx)(n.h2,{id:"pattern-b-stdio-child-process-imsg",children:"Pattern B: stdio child process (imsg)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Moltbot spawns ",(0,r.jsx)(n.code,{children:"imsg rpc"})," as a child process."]}),"\n",(0,r.jsx)(n.li,{children:"JSON-RPC is line-delimited over stdin/stdout (one JSON object per line)."}),"\n",(0,r.jsx)(n.li,{children:"No TCP port, no daemon required."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Core methods used:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"watch.subscribe"})," \u2192 notifications (",(0,r.jsx)(n.code,{children:'method: "message"'}),")"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"watch.unsubscribe"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"send"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"chats.list"})," (probe/diagnostics)"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["See ",(0,r.jsx)(n.a,{href:"/channels/imessage",children:"iMessage"})," for setup and addressing (",(0,r.jsx)(n.code,{children:"chat_id"})," preferred)."]}),"\n",(0,r.jsx)(n.h2,{id:"adapter-guidelines",children:"Adapter guidelines"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Gateway owns the process (start/stop tied to provider lifecycle)."}),"\n",(0,r.jsx)(n.li,{children:"Keep RPC clients resilient: timeouts, restart on exit."}),"\n",(0,r.jsxs)(n.li,{children:["Prefer stable IDs (e.g., ",(0,r.jsx)(n.code,{children:"chat_id"}),") over display strings."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},28453(e,n,s){s.d(n,{R:()=>a,x:()=>c});var i=s(96540);const r={},t=i.createContext(r);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);