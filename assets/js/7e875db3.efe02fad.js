"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[398],{70267(e,n,s){s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"channels/line","title":"LINE (plugin)","description":"LINE connects to Moltbot via the LINE Messaging API. The plugin runs as a webhook","source":"@site/content/moltbot/docs/channels/line.md","sourceDirName":"channels","slug":"/channels/line","permalink":"/moltbot-doc/docs/channels/line","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"LINE Messaging API plugin setup, config, and usage","read_when":["You want to connect Moltbot to LINE","You need LINE webhook + credential setup","You want LINE-specific message options"]}}');var i=s(74848),o=s(28453);const a={summary:"LINE Messaging API plugin setup, config, and usage",read_when:["You want to connect Moltbot to LINE","You need LINE webhook + credential setup","You want LINE-specific message options"]},c="LINE (plugin)",r={},t=[{value:"Plugin required",id:"plugin-required",level:2},{value:"Setup",id:"setup",level:2},{value:"Configure",id:"configure",level:2},{value:"Access control",id:"access-control",level:2},{value:"Message behavior",id:"message-behavior",level:2},{value:"Channel data (rich messages)",id:"channel-data-rich-messages",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"line-plugin",children:"LINE (plugin)"})}),"\n",(0,i.jsx)(n.p,{children:"LINE connects to Moltbot via the LINE Messaging API. The plugin runs as a webhook\nreceiver on the gateway and uses your channel access token + channel secret for\nauthentication."}),"\n",(0,i.jsx)(n.p,{children:"Status: supported via plugin. Direct messages, group chats, media, locations, Flex\nmessages, template messages, and quick replies are supported. Reactions and threads\nare not supported."}),"\n",(0,i.jsx)(n.h2,{id:"plugin-required",children:"Plugin required"}),"\n",(0,i.jsx)(n.p,{children:"Install the LINE plugin:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"moltbot plugins install @moltbot/line\n"})}),"\n",(0,i.jsx)(n.p,{children:"Local checkout (when running from a git repo):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"moltbot plugins install ./extensions/line\n"})}),"\n",(0,i.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Create a LINE Developers account and open the Console:\n",(0,i.jsx)(n.a,{href:"https://developers.line.biz/console/",children:"https://developers.line.biz/console/"})]}),"\n",(0,i.jsxs)(n.li,{children:["Create (or pick) a Provider and add a ",(0,i.jsx)(n.strong,{children:"Messaging API"})," channel."]}),"\n",(0,i.jsxs)(n.li,{children:["Copy the ",(0,i.jsx)(n.strong,{children:"Channel access token"})," and ",(0,i.jsx)(n.strong,{children:"Channel secret"})," from the channel settings."]}),"\n",(0,i.jsxs)(n.li,{children:["Enable ",(0,i.jsx)(n.strong,{children:"Use webhook"})," in the Messaging API settings."]}),"\n",(0,i.jsx)(n.li,{children:"Set the webhook URL to your gateway endpoint (HTTPS required):"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"https://gateway-host/line/webhook\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The gateway responds to LINE\u2019s webhook verification (GET) and inbound events (POST).\nIf you need a custom path, set ",(0,i.jsx)(n.code,{children:"channels.line.webhookPath"})," or\n",(0,i.jsx)(n.code,{children:"channels.line.accounts.<id>.webhookPath"})," and update the URL accordingly."]}),"\n",(0,i.jsx)(n.h2,{id:"configure",children:"Configure"}),"\n",(0,i.jsx)(n.p,{children:"Minimal config:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    line: {\n      enabled: true,\n      channelAccessToken: "LINE_CHANNEL_ACCESS_TOKEN",\n      channelSecret: "LINE_CHANNEL_SECRET",\n      dmPolicy: "pairing"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Env vars (default account only):"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"LINE_CHANNEL_ACCESS_TOKEN"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"LINE_CHANNEL_SECRET"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Token/secret files:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    line: {\n      tokenFile: "/path/to/line-token.txt",\n      secretFile: "/path/to/line-secret.txt"\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Multiple accounts:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    line: {\n      accounts: {\n        marketing: {\n          channelAccessToken: "...",\n          channelSecret: "...",\n          webhookPath: "/line/marketing"\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"access-control",children:"Access control"}),"\n",(0,i.jsx)(n.p,{children:"Direct messages default to pairing. Unknown senders get a pairing code and their\nmessages are ignored until approved."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"moltbot pairing list line\nmoltbot pairing approve line <CODE>\n"})}),"\n",(0,i.jsx)(n.p,{children:"Allowlists and policies:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channels.line.dmPolicy"}),": ",(0,i.jsx)(n.code,{children:"pairing | allowlist | open | disabled"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channels.line.allowFrom"}),": allowlisted LINE user IDs for DMs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channels.line.groupPolicy"}),": ",(0,i.jsx)(n.code,{children:"allowlist | open | disabled"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"channels.line.groupAllowFrom"}),": allowlisted LINE user IDs for groups"]}),"\n",(0,i.jsxs)(n.li,{children:["Per-group overrides: ",(0,i.jsx)(n.code,{children:"channels.line.groups.<groupId>.allowFrom"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"LINE IDs are case-sensitive. Valid IDs look like:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["User: ",(0,i.jsx)(n.code,{children:"U"})," + 32 hex chars"]}),"\n",(0,i.jsxs)(n.li,{children:["Group: ",(0,i.jsx)(n.code,{children:"C"})," + 32 hex chars"]}),"\n",(0,i.jsxs)(n.li,{children:["Room: ",(0,i.jsx)(n.code,{children:"R"})," + 32 hex chars"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"message-behavior",children:"Message behavior"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Text is chunked at 5000 characters."}),"\n",(0,i.jsx)(n.li,{children:"Markdown formatting is stripped; code blocks and tables are converted into Flex\ncards when possible."}),"\n",(0,i.jsx)(n.li,{children:"Streaming responses are buffered; LINE receives full chunks with a loading\nanimation while the agent works."}),"\n",(0,i.jsxs)(n.li,{children:["Media downloads are capped by ",(0,i.jsx)(n.code,{children:"channels.line.mediaMaxMb"})," (default 10)."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"channel-data-rich-messages",children:"Channel data (rich messages)"}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"channelData.line"})," to send quick replies, locations, Flex cards, or template\nmessages."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json5",children:'{\n  text: "Here you go",\n  channelData: {\n    line: {\n      quickReplies: ["Status", "Help"],\n      location: {\n        title: "Office",\n        address: "123 Main St",\n        latitude: 35.681236,\n        longitude: 139.767125\n      },\n      flexMessage: {\n        altText: "Status card",\n        contents: { /* Flex payload */ }\n      },\n      templateMessage: {\n        type: "confirm",\n        text: "Proceed?",\n        confirmLabel: "Yes",\n        confirmData: "yes",\n        cancelLabel: "No",\n        cancelData: "no"\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The LINE plugin also ships a ",(0,i.jsx)(n.code,{children:"/card"})," command for Flex message presets:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'/card info "Welcome" "Thanks for joining!"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Webhook verification fails:"})," ensure the webhook URL is HTTPS and the\n",(0,i.jsx)(n.code,{children:"channelSecret"})," matches the LINE console."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"No inbound events:"})," confirm the webhook path matches ",(0,i.jsx)(n.code,{children:"channels.line.webhookPath"}),"\nand that the gateway is reachable from LINE."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Media download errors:"})," raise ",(0,i.jsx)(n.code,{children:"channels.line.mediaMaxMb"})," if media exceeds the\ndefault limit."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453(e,n,s){s.d(n,{R:()=>a,x:()=>c});var l=s(96540);const i={},o=l.createContext(i);function a(e){const n=l.useContext(o);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),l.createElement(o.Provider,{value:n},e.children)}}}]);