"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[2689],{50379(e,n,t){t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"channels/mattermost","title":"Mattermost (plugin)","description":"Status: supported via plugin (bot token + WebSocket events). Channels, groups, and DMs are supported.","source":"@site/content/moltbot/docs/channels/mattermost.md","sourceDirName":"channels","slug":"/channels/mattermost","permalink":"/moltbot-doc/docs/channels/mattermost","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Mattermost bot setup and Moltbot config","read_when":["Setting up Mattermost","Debugging Mattermost routing"]}}');var l=t(74848),o=t(28453);const r={summary:"Mattermost bot setup and Moltbot config",read_when:["Setting up Mattermost","Debugging Mattermost routing"]},a="Mattermost (plugin)",i={},c=[{value:"Plugin required",id:"plugin-required",level:2},{value:"Quick setup",id:"quick-setup",level:2},{value:"Environment variables (default account)",id:"environment-variables-default-account",level:2},{value:"Chat modes",id:"chat-modes",level:2},{value:"Access control (DMs)",id:"access-control-dms",level:2},{value:"Channels (groups)",id:"channels-groups",level:2},{value:"Targets for outbound delivery",id:"targets-for-outbound-delivery",level:2},{value:"Multi-account",id:"multi-account",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"mattermost-plugin",children:"Mattermost (plugin)"})}),"\n",(0,l.jsxs)(n.p,{children:["Status: supported via plugin (bot token + WebSocket events). Channels, groups, and DMs are supported.\nMattermost is a self-hostable team messaging platform; see the official site at\n",(0,l.jsx)(n.a,{href:"https://mattermost.com",children:"mattermost.com"})," for product details and downloads."]}),"\n",(0,l.jsx)(n.h2,{id:"plugin-required",children:"Plugin required"}),"\n",(0,l.jsx)(n.p,{children:"Mattermost ships as a plugin and is not bundled with the core install."}),"\n",(0,l.jsx)(n.p,{children:"Install via CLI (npm registry):"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"moltbot plugins install @moltbot/mattermost\n"})}),"\n",(0,l.jsx)(n.p,{children:"Local checkout (when running from a git repo):"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"moltbot plugins install ./extensions/mattermost\n"})}),"\n",(0,l.jsx)(n.p,{children:"If you choose Mattermost during configure/onboarding and a git checkout is detected,\nMoltbot will offer the local install path automatically."}),"\n",(0,l.jsxs)(n.p,{children:["Details: ",(0,l.jsx)(n.a,{href:"/plugin",children:"Plugins"})]}),"\n",(0,l.jsx)(n.h2,{id:"quick-setup",children:"Quick setup"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Install the Mattermost plugin."}),"\n",(0,l.jsxs)(n.li,{children:["Create a Mattermost bot account and copy the ",(0,l.jsx)(n.strong,{children:"bot token"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["Copy the Mattermost ",(0,l.jsx)(n.strong,{children:"base URL"})," (e.g., ",(0,l.jsx)(n.code,{children:"https://chat.example.com"}),")."]}),"\n",(0,l.jsx)(n.li,{children:"Configure Moltbot and start the gateway."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Minimal config:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    mattermost: {\n      enabled: true,\n      botToken: "mm-token",\n      baseUrl: "https://chat.example.com",\n      dmPolicy: "pairing"\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"environment-variables-default-account",children:"Environment variables (default account)"}),"\n",(0,l.jsx)(n.p,{children:"Set these on the gateway host if you prefer env vars:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"MATTERMOST_BOT_TOKEN=..."})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"MATTERMOST_URL=https://chat.example.com"})}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["Env vars apply only to the ",(0,l.jsx)(n.strong,{children:"default"})," account (",(0,l.jsx)(n.code,{children:"default"}),"). Other accounts must use config values."]}),"\n",(0,l.jsx)(n.h2,{id:"chat-modes",children:"Chat modes"}),"\n",(0,l.jsxs)(n.p,{children:["Mattermost responds to DMs automatically. Channel behavior is controlled by ",(0,l.jsx)(n.code,{children:"chatmode"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"oncall"})," (default): respond only when @mentioned in channels."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onmessage"}),": respond to every channel message."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onchar"}),": respond when a message starts with a trigger prefix."]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Config example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    mattermost: {\n      chatmode: "onchar",\n      oncharPrefixes: [">", "!"]\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"Notes:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"onchar"})," still responds to explicit @mentions."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"channels.mattermost.requireMention"})," is honored for legacy configs but ",(0,l.jsx)(n.code,{children:"chatmode"})," is preferred."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"access-control-dms",children:"Access control (DMs)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Default: ",(0,l.jsx)(n.code,{children:'channels.mattermost.dmPolicy = "pairing"'})," (unknown senders get a pairing code)."]}),"\n",(0,l.jsxs)(n.li,{children:["Approve via:\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"moltbot pairing list mattermost"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"moltbot pairing approve mattermost <CODE>"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Public DMs: ",(0,l.jsx)(n.code,{children:'channels.mattermost.dmPolicy="open"'})," plus ",(0,l.jsx)(n.code,{children:'channels.mattermost.allowFrom=["*"]'}),"."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"channels-groups",children:"Channels (groups)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Default: ",(0,l.jsx)(n.code,{children:'channels.mattermost.groupPolicy = "allowlist"'})," (mention-gated)."]}),"\n",(0,l.jsxs)(n.li,{children:["Allowlist senders with ",(0,l.jsx)(n.code,{children:"channels.mattermost.groupAllowFrom"})," (user IDs or ",(0,l.jsx)(n.code,{children:"@username"}),")."]}),"\n",(0,l.jsxs)(n.li,{children:["Open channels: ",(0,l.jsx)(n.code,{children:'channels.mattermost.groupPolicy="open"'})," (mention-gated)."]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"targets-for-outbound-delivery",children:"Targets for outbound delivery"}),"\n",(0,l.jsxs)(n.p,{children:["Use these target formats with ",(0,l.jsx)(n.code,{children:"moltbot message send"})," or cron/webhooks:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"channel:<id>"})," for a channel"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"user:<id>"})," for a DM"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"@username"})," for a DM (resolved via the Mattermost API)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Bare IDs are treated as channels."}),"\n",(0,l.jsx)(n.h2,{id:"multi-account",children:"Multi-account"}),"\n",(0,l.jsxs)(n.p,{children:["Mattermost supports multiple accounts under ",(0,l.jsx)(n.code,{children:"channels.mattermost.accounts"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json5",children:'{\n  channels: {\n    mattermost: {\n      accounts: {\n        default: { name: "Primary", botToken: "mm-token", baseUrl: "https://chat.example.com" },\n        alerts: { name: "Alerts", botToken: "mm-token-2", baseUrl: "https://alerts.example.com" }\n      }\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["No replies in channels: ensure the bot is in the channel and mention it (oncall), use a trigger prefix (onchar), or set ",(0,l.jsx)(n.code,{children:'chatmode: "onmessage"'}),"."]}),"\n",(0,l.jsx)(n.li,{children:"Auth errors: check the bot token, base URL, and whether the account is enabled."}),"\n",(0,l.jsxs)(n.li,{children:["Multi-account issues: env vars only apply to the ",(0,l.jsx)(n.code,{children:"default"})," account."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453(e,n,t){t.d(n,{R:()=>r,x:()=>a});var s=t(96540);const l={},o=s.createContext(l);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);