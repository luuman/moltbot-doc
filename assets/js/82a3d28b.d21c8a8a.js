"use strict";(globalThis.webpackChunkdocs_workspace=globalThis.webpackChunkdocs_workspace||[]).push([[3429],{90198(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"concepts/models","title":"Models CLI","description":"See /concepts/model-failover for auth profile","source":"@site/content/moltbot/docs/concepts/models.md","sourceDirName":"concepts","slug":"/concepts/models","permalink":"/moltbot-doc/docs/concepts/models","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"summary":"Models CLI: list, set, aliases, fallbacks, scan, status","read_when":["Adding or modifying models CLI (models list/set/scan/aliases/fallbacks)","Changing model fallback behavior or selection UX","Updating model scan probes (tools/images)"]}}');var o=n(74848),d=n(28453);const i={summary:"Models CLI: list, set, aliases, fallbacks, scan, status",read_when:["Adding or modifying models CLI (models list/set/scan/aliases/fallbacks)","Changing model fallback behavior or selection UX","Updating model scan probes (tools/images)"]},r="Models CLI",c={},t=[{value:"How model selection works",id:"how-model-selection-works",level:2},{value:"Quick model picks (anecdotal)",id:"quick-model-picks-anecdotal",level:2},{value:"Setup wizard (recommended)",id:"setup-wizard-recommended",level:2},{value:"Config keys (overview)",id:"config-keys-overview",level:2},{value:"\u201cModel is not allowed\u201d (and why replies stop)",id:"model-is-not-allowed-and-why-replies-stop",level:2},{value:"Switching models in chat (<code>/model</code>)",id:"switching-models-in-chat-model",level:2},{value:"CLI commands",id:"cli-commands",level:2},{value:"<code>models list</code>",id:"models-list",level:3},{value:"<code>models status</code>",id:"models-status",level:3},{value:"Scanning (OpenRouter free models)",id:"scanning-openrouter-free-models",level:2},{value:"Models registry (<code>models.json</code>)",id:"models-registry-modelsjson",level:2}];function a(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"models-cli",children:"Models CLI"})}),"\n",(0,o.jsxs)(s.p,{children:["See ",(0,o.jsx)(s.a,{href:"/concepts/model-failover",children:"/concepts/model-failover"})," for auth profile\nrotation, cooldowns, and how that interacts with fallbacks.\nQuick provider overview + examples: ",(0,o.jsx)(s.a,{href:"/concepts/model-providers",children:"/concepts/model-providers"}),"."]}),"\n",(0,o.jsx)(s.h2,{id:"how-model-selection-works",children:"How model selection works"}),"\n",(0,o.jsx)(s.p,{children:"Moltbot selects models in this order:"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Primary"})," model (",(0,o.jsx)(s.code,{children:"agents.defaults.model.primary"})," or ",(0,o.jsx)(s.code,{children:"agents.defaults.model"}),")."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Fallbacks"})," in ",(0,o.jsx)(s.code,{children:"agents.defaults.model.fallbacks"})," (in order)."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Provider auth failover"})," happens inside a provider before moving to the\nnext model."]}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:"Related:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"agents.defaults.models"})," is the allowlist/catalog of models Moltbot can use (plus aliases)."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"agents.defaults.imageModel"})," is used ",(0,o.jsx)(s.strong,{children:"only when"})," the primary model can\u2019t accept images."]}),"\n",(0,o.jsxs)(s.li,{children:["Per-agent defaults can override ",(0,o.jsx)(s.code,{children:"agents.defaults.model"})," via ",(0,o.jsx)(s.code,{children:"agents.list[].model"})," plus bindings (see ",(0,o.jsx)(s.a,{href:"/concepts/multi-agent",children:"/concepts/multi-agent"}),")."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"quick-model-picks-anecdotal",children:"Quick model picks (anecdotal)"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"GLM"}),": a bit better for coding/tool calling."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"MiniMax"}),": better for writing and vibes."]}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"setup-wizard-recommended",children:"Setup wizard (recommended)"}),"\n",(0,o.jsx)(s.p,{children:"If you don\u2019t want to hand-edit config, run the onboarding wizard:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-bash",children:"moltbot onboard\n"})}),"\n",(0,o.jsxs)(s.p,{children:["It can set up model + auth for common providers, including ",(0,o.jsx)(s.strong,{children:"OpenAI Code (Codex)\nsubscription"})," (OAuth) and ",(0,o.jsx)(s.strong,{children:"Anthropic"})," (API key recommended; ",(0,o.jsx)(s.code,{children:"claude setup-token"})," also supported)."]}),"\n",(0,o.jsx)(s.h2,{id:"config-keys-overview",children:"Config keys (overview)"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"agents.defaults.model.primary"})," and ",(0,o.jsx)(s.code,{children:"agents.defaults.model.fallbacks"})]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"agents.defaults.imageModel.primary"})," and ",(0,o.jsx)(s.code,{children:"agents.defaults.imageModel.fallbacks"})]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"agents.defaults.models"})," (allowlist + aliases + provider params)"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"models.providers"})," (custom providers written into ",(0,o.jsx)(s.code,{children:"models.json"}),")"]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["Model refs are normalized to lowercase. Provider aliases like ",(0,o.jsx)(s.code,{children:"z.ai/*"})," normalize\nto ",(0,o.jsx)(s.code,{children:"zai/*"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["Provider configuration examples (including OpenCode Zen) live in\n",(0,o.jsx)(s.a,{href:"/gateway/configuration#opencode-zen-multi-model-proxy",children:"/gateway/configuration"}),"."]}),"\n",(0,o.jsx)(s.h2,{id:"model-is-not-allowed-and-why-replies-stop",children:"\u201cModel is not allowed\u201d (and why replies stop)"}),"\n",(0,o.jsxs)(s.p,{children:["If ",(0,o.jsx)(s.code,{children:"agents.defaults.models"})," is set, it becomes the ",(0,o.jsx)(s.strong,{children:"allowlist"})," for ",(0,o.jsx)(s.code,{children:"/model"})," and for\nsession overrides. When a user selects a model that isn\u2019t in that allowlist,\nMoltbot returns:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{children:'Model "provider/model" is not allowed. Use /model to list available models.\n'})}),"\n",(0,o.jsxs)(s.p,{children:["This happens ",(0,o.jsx)(s.strong,{children:"before"})," a normal reply is generated, so the message can feel\nlike it \u201cdidn\u2019t respond.\u201d The fix is to either:"]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Add the model to ",(0,o.jsx)(s.code,{children:"agents.defaults.models"}),", or"]}),"\n",(0,o.jsxs)(s.li,{children:["Clear the allowlist (remove ",(0,o.jsx)(s.code,{children:"agents.defaults.models"}),"), or"]}),"\n",(0,o.jsxs)(s.li,{children:["Pick a model from ",(0,o.jsx)(s.code,{children:"/model list"}),"."]}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:"Example allowlist config:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-json5",children:'{\n  agent: {\n    model: { primary: "anthropic/claude-sonnet-4-5" },\n    models: {\n      "anthropic/claude-sonnet-4-5": { alias: "Sonnet" },\n      "anthropic/claude-opus-4-5": { alias: "Opus" }\n    }\n  }\n}\n'})}),"\n",(0,o.jsxs)(s.h2,{id:"switching-models-in-chat-model",children:["Switching models in chat (",(0,o.jsx)(s.code,{children:"/model"}),")"]}),"\n",(0,o.jsx)(s.p,{children:"You can switch models for the current session without restarting:"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{children:"/model\n/model list\n/model 3\n/model openai/gpt-5.2\n/model status\n"})}),"\n",(0,o.jsx)(s.p,{children:"Notes:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"/model"})," (and ",(0,o.jsx)(s.code,{children:"/model list"}),") is a compact, numbered picker (model family + available providers)."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"/model <#>"})," selects from that picker."]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"/model status"})," is the detailed view (auth candidates and, when configured, provider endpoint ",(0,o.jsx)(s.code,{children:"baseUrl"})," + ",(0,o.jsx)(s.code,{children:"api"})," mode)."]}),"\n",(0,o.jsxs)(s.li,{children:["Model refs are parsed by splitting on the ",(0,o.jsx)(s.strong,{children:"first"})," ",(0,o.jsx)(s.code,{children:"/"}),". Use ",(0,o.jsx)(s.code,{children:"provider/model"})," when typing ",(0,o.jsx)(s.code,{children:"/model <ref>"}),"."]}),"\n",(0,o.jsxs)(s.li,{children:["If the model ID itself contains ",(0,o.jsx)(s.code,{children:"/"})," (OpenRouter-style), you must include the provider prefix (example: ",(0,o.jsx)(s.code,{children:"/model openrouter/moonshotai/kimi-k2"}),")."]}),"\n",(0,o.jsxs)(s.li,{children:["If you omit the provider, Moltbot treats the input as an alias or a model for the ",(0,o.jsx)(s.strong,{children:"default provider"})," (only works when there is no ",(0,o.jsx)(s.code,{children:"/"})," in the model ID)."]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["Full command behavior/config: ",(0,o.jsx)(s.a,{href:"/tools/slash-commands",children:"Slash commands"}),"."]}),"\n",(0,o.jsx)(s.h2,{id:"cli-commands",children:"CLI commands"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-bash",children:"moltbot models list\nmoltbot models status\nmoltbot models set <provider/model>\nmoltbot models set-image <provider/model>\n\nmoltbot models aliases list\nmoltbot models aliases add <alias> <provider/model>\nmoltbot models aliases remove <alias>\n\nmoltbot models fallbacks list\nmoltbot models fallbacks add <provider/model>\nmoltbot models fallbacks remove <provider/model>\nmoltbot models fallbacks clear\n\nmoltbot models image-fallbacks list\nmoltbot models image-fallbacks add <provider/model>\nmoltbot models image-fallbacks remove <provider/model>\nmoltbot models image-fallbacks clear\n"})}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.code,{children:"moltbot models"})," (no subcommand) is a shortcut for ",(0,o.jsx)(s.code,{children:"models status"}),"."]}),"\n",(0,o.jsx)(s.h3,{id:"models-list",children:(0,o.jsx)(s.code,{children:"models list"})}),"\n",(0,o.jsx)(s.p,{children:"Shows configured models by default. Useful flags:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--all"}),": full catalog"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--local"}),": local providers only"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--provider <name>"}),": filter by provider"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--plain"}),": one model per line"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--json"}),": machine\u2011readable output"]}),"\n"]}),"\n",(0,o.jsx)(s.h3,{id:"models-status",children:(0,o.jsx)(s.code,{children:"models status"})}),"\n",(0,o.jsxs)(s.p,{children:["Shows the resolved primary model, fallbacks, image model, and an auth overview\nof configured providers. It also surfaces OAuth expiry status for profiles found\nin the auth store (warns within 24h by default). ",(0,o.jsx)(s.code,{children:"--plain"})," prints only the\nresolved primary model.\nOAuth status is always shown (and included in ",(0,o.jsx)(s.code,{children:"--json"})," output). If a configured\nprovider has no credentials, ",(0,o.jsx)(s.code,{children:"models status"})," prints a ",(0,o.jsx)(s.strong,{children:"Missing auth"})," section.\nJSON includes ",(0,o.jsx)(s.code,{children:"auth.oauth"})," (warn window + profiles) and ",(0,o.jsx)(s.code,{children:"auth.providers"}),"\n(effective auth per provider).\nUse ",(0,o.jsx)(s.code,{children:"--check"})," for automation (exit ",(0,o.jsx)(s.code,{children:"1"})," when missing/expired, ",(0,o.jsx)(s.code,{children:"2"})," when expiring)."]}),"\n",(0,o.jsx)(s.p,{children:"Preferred Anthropic auth is the Claude Code CLI setup-token (run anywhere; paste on the gateway host if needed):"}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-bash",children:"claude setup-token\nmoltbot models status\n"})}),"\n",(0,o.jsx)(s.h2,{id:"scanning-openrouter-free-models",children:"Scanning (OpenRouter free models)"}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.code,{children:"moltbot models scan"})," inspects OpenRouter\u2019s ",(0,o.jsx)(s.strong,{children:"free model catalog"})," and can\noptionally probe models for tool and image support."]}),"\n",(0,o.jsx)(s.p,{children:"Key flags:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--no-probe"}),": skip live probes (metadata only)"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--min-params <b>"}),": minimum parameter size (billions)"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--max-age-days <days>"}),": skip older models"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--provider <name>"}),": provider prefix filter"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--max-candidates <n>"}),": fallback list size"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--set-default"}),": set ",(0,o.jsx)(s.code,{children:"agents.defaults.model.primary"})," to the first selection"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.code,{children:"--set-image"}),": set ",(0,o.jsx)(s.code,{children:"agents.defaults.imageModel.primary"})," to the first image selection"]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["Probing requires an OpenRouter API key (from auth profiles or\n",(0,o.jsx)(s.code,{children:"OPENROUTER_API_KEY"}),"). Without a key, use ",(0,o.jsx)(s.code,{children:"--no-probe"})," to list candidates only."]}),"\n",(0,o.jsx)(s.p,{children:"Scan results are ranked by:"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsx)(s.li,{children:"Image support"}),"\n",(0,o.jsx)(s.li,{children:"Tool latency"}),"\n",(0,o.jsx)(s.li,{children:"Context size"}),"\n",(0,o.jsx)(s.li,{children:"Parameter count"}),"\n"]}),"\n",(0,o.jsx)(s.p,{children:"Input"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["OpenRouter ",(0,o.jsx)(s.code,{children:"/models"})," list (filter ",(0,o.jsx)(s.code,{children:":free"}),")"]}),"\n",(0,o.jsxs)(s.li,{children:["Requires OpenRouter API key from auth profiles or ",(0,o.jsx)(s.code,{children:"OPENROUTER_API_KEY"})," (see ",(0,o.jsx)(s.a,{href:"/environment",children:"/environment"}),")"]}),"\n",(0,o.jsxs)(s.li,{children:["Optional filters: ",(0,o.jsx)(s.code,{children:"--max-age-days"}),", ",(0,o.jsx)(s.code,{children:"--min-params"}),", ",(0,o.jsx)(s.code,{children:"--provider"}),", ",(0,o.jsx)(s.code,{children:"--max-candidates"})]}),"\n",(0,o.jsxs)(s.li,{children:["Probe controls: ",(0,o.jsx)(s.code,{children:"--timeout"}),", ",(0,o.jsx)(s.code,{children:"--concurrency"})]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["When run in a TTY, you can select fallbacks interactively. In non\u2011interactive\nmode, pass ",(0,o.jsx)(s.code,{children:"--yes"})," to accept defaults."]}),"\n",(0,o.jsxs)(s.h2,{id:"models-registry-modelsjson",children:["Models registry (",(0,o.jsx)(s.code,{children:"models.json"}),")"]}),"\n",(0,o.jsxs)(s.p,{children:["Custom providers in ",(0,o.jsx)(s.code,{children:"models.providers"})," are written into ",(0,o.jsx)(s.code,{children:"models.json"})," under the\nagent directory (default ",(0,o.jsx)(s.code,{children:"~/.clawdbot/agents/<agentId>/models.json"}),"). This file\nis merged by default unless ",(0,o.jsx)(s.code,{children:"models.mode"})," is set to ",(0,o.jsx)(s.code,{children:"replace"}),"."]})]})}function h(e={}){const{wrapper:s}={...(0,d.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},28453(e,s,n){n.d(s,{R:()=>i,x:()=>r});var l=n(96540);const o={},d=l.createContext(o);function i(e){const s=l.useContext(d);return l.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),l.createElement(d.Provider,{value:s},e.children)}}}]);